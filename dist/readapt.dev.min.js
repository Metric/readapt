/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, { enumerable: true, get: getter });
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = function(exports) {
/******/ 		if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 			Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 		}
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// create a fake namespace object
/******/ 	// mode & 1: value is a module id, require it
/******/ 	// mode & 2: merge all properties of value into the ns
/******/ 	// mode & 4: return value when already ns object
/******/ 	// mode & 8|1: behave like require
/******/ 	__webpack_require__.t = function(value, mode) {
/******/ 		if(mode & 1) value = __webpack_require__(value);
/******/ 		if(mode & 8) return value;
/******/ 		if((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;
/******/ 		var ns = Object.create(null);
/******/ 		__webpack_require__.r(ns);
/******/ 		Object.defineProperty(ns, 'default', { enumerable: true, value: value });
/******/ 		if(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));
/******/ 		return ns;
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = "./src/client.js");
/******/ })
/************************************************************************/
/******/ ({

/***/ "./src/client.js":
/*!***********************!*\
  !*** ./src/client.js ***!
  \***********************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _h__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./h */ "./src/h.ts");
/* harmony import */ var _component__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./component */ "./src/component.ts");
/* harmony import */ var _readapt_dom_index__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./readapt-dom/index */ "./src/readapt-dom/index.ts");
/* harmony import */ var _render__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./render */ "./src/render.ts");





_readapt_dom_index__WEBPACK_IMPORTED_MODULE_2__["DOM"].document = document;
window.h = _h__WEBPACK_IMPORTED_MODULE_0__["h"];
window.Component = _component__WEBPACK_IMPORTED_MODULE_1__["default"];
window.Readapt = {
    render: _render__WEBPACK_IMPORTED_MODULE_3__["render"],
    hydrate: _render__WEBPACK_IMPORTED_MODULE_3__["hydrate"]
};
window.React = {
    createElement: _h__WEBPACK_IMPORTED_MODULE_0__["h"],
    render: _render__WEBPACK_IMPORTED_MODULE_3__["render"],
    hydrate: _render__WEBPACK_IMPORTED_MODULE_3__["hydrate"]
};


/***/ }),

/***/ "./src/component.ts":
/*!**************************!*\
  !*** ./src/component.ts ***!
  \**************************/
/*! exports provided: DEFER_PROMISE, DEFER_TIMEOUT, DEFER_ANIMATION, default, renderComponent, prepareRender, unmountComponent, buildComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DEFER_PROMISE", function() { return DEFER_PROMISE; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DEFER_TIMEOUT", function() { return DEFER_TIMEOUT; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DEFER_ANIMATION", function() { return DEFER_ANIMATION; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return Component; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "renderComponent", function() { return renderComponent; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "prepareRender", function() { return prepareRender; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "unmountComponent", function() { return unmountComponent; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "buildComponent", function() { return buildComponent; });
/* harmony import */ var _constants__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./constants */ "./src/constants.ts");
/* harmony import */ var _readapt_vdom_diff__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./readapt-vdom/diff */ "./src/readapt-vdom/diff.ts");
/* harmony import */ var _render__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./render */ "./src/render.ts");

var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};



const DEFER_PROMISE = Promise.resolve().then.bind(Promise.resolve());
const DEFER_TIMEOUT = setTimeout;
const DEFER_ANIMATION = typeof requestAnimationFrame !== 'undefined' ? requestAnimationFrame : DEFER_PROMISE;
class Component {
    constructor(props, parent, renderMode) {
        this.disabled = false;
        this.key = props.key;
        this.ref = props.ref;
        this.asyncMethod = DEFER_PROMISE;
        this.renderMode = renderMode || _constants__WEBPACK_IMPORTED_MODULE_0__["SYNC"];
        this.child = null;
        this.base = null;
        this.parent = parent;
        this.parentNode = null;
        this.children = [];
        delete props.ref;
        delete props.key;
        this.observe(props);
    }
    componentChange(key, value, previous) {
        return __awaiter(this, void 0, void 0, function* () {
            if (this.shouldComponentUpdate(key, value, previous)) {
                if (this.renderMode === _constants__WEBPACK_IMPORTED_MODULE_0__["SYNC"])
                    yield renderComponent(this, this.parentNode);
                else if (this.renderMode === _constants__WEBPACK_IMPORTED_MODULE_0__["ASYNC"])
                    Object(_render__WEBPACK_IMPORTED_MODULE_2__["enqueue"])(this);
            }
        });
    }
    forceUpdate() {
        return __awaiter(this, void 0, void 0, function* () {
            yield renderComponent(this, this.parentNode);
        });
    }
    componentDidUpdate(previous) {
        return __awaiter(this, void 0, void 0, function* () {
        });
    }
    render() {
        return __awaiter(this, void 0, void 0, function* () {
        });
    }
    componentWillUnmount() {
        return __awaiter(this, void 0, void 0, function* () {
        });
    }
    componentDidMount() {
        return __awaiter(this, void 0, void 0, function* () {
        });
    }
    shouldComponentUpdate(key, value, previous) {
        return true;
    }
    observe(o) {
        for (let k in o) {
            let v = o[k];
            if (typeof v === 'function') {
                this[k] = v;
                continue;
            }
            Object.defineProperty(this, `\$${k}`, { value: v, writable: true, enumerable: false });
            Object.defineProperty(this, k, {
                enumerable: true,
                get() {
                    return this[`\$${k}`];
                },
                set(nv) {
                    const prev = this[`\$${k}`];
                    this[`\$${k}`] = nv;
                    if (!this.disabled && prev !== nv) {
                        this.componentChange(k, nv, prev);
                    }
                }
            });
        }
    }
}
function renderComponent(component, parentNode) {
    return __awaiter(this, void 0, void 0, function* () {
        let isUpdate = component.base, p, props, rendered, toUnmount, cbase, inst, base, type;
        if (component.disabled)
            return;
        rendered = yield component.render();
        if (!rendered || Array.isArray(rendered)) {
            if (component.child) {
                yield unmountComponent(component.child);
                component.child = null;
            }
            if (component.base) {
                component.base._component = null;
                yield Object(_readapt_vdom_diff__WEBPACK_IMPORTED_MODULE_1__["recollectNodeTree"])(component.base, false);
                component.base = null;
            }
            return;
        }
        component.parentNode = parentNode;
        cbase = base = component.base;
        if (typeof rendered.nodeName === 'function') {
            props = rendered.attributes;
            inst = component.child;
            if (inst && inst.constructor === rendered.nodeName) {
                const update = prepareRender(inst, props, rendered.childNodes);
                if (update._different) {
                    yield renderComponent(inst, inst.parentNode);
                    yield inst.componentDidUpdate(update);
                }
            }
            else {
                toUnmount = inst;
                type = rendered.nodeName;
                if (cbase && !toUnmount) {
                    cbase._component = null;
                    yield Object(_readapt_vdom_diff__WEBPACK_IMPORTED_MODULE_1__["recollectNodeTree"])(cbase, false);
                }
                component.child = inst = new type(props, component);
                inst.children = rendered.childNodes;
                if (inst.ref)
                    inst.ref(inst);
                yield renderComponent(inst, component.parentNode);
            }
            base = inst.base;
        }
        if (typeof rendered.nodeName !== 'function') {
            toUnmount = component.child;
            if (toUnmount)
                cbase = component.child = null;
            base = yield Object(_readapt_vdom_diff__WEBPACK_IMPORTED_MODULE_1__["diff"])(cbase, rendered, component.parentNode, true);
        }
        if (cbase && base !== cbase && inst !== component.child) {
            p = cbase.parentNode;
            if (p && base !== p) {
                p.replaceChild(base, cbase);
                if (!toUnmount) {
                    cbase._component = null;
                    yield Object(_readapt_vdom_diff__WEBPACK_IMPORTED_MODULE_1__["recollectNodeTree"])(cbase, false);
                }
            }
        }
        if (toUnmount)
            yield unmountComponent(toUnmount);
        component.base = base;
        if (base && !component.child) {
            let cmp = component, t = component;
            while ((t = t.parent)) {
                (cmp = t).base = base;
            }
            base._component = cmp;
        }
        if (!isUpdate) {
            yield component.componentDidMount();
        }
    });
}
function prepareRender(inst, props, children) {
    let diff = { _different: false };
    if (inst.ref)
        inst.ref(inst);
    inst.children = children;
    inst.disabled = true;
    for (let n in props) {
        if (inst[n] !== props[n]) {
            diff[n] = inst[n];
            diff._different = true;
        }
        inst[n] = props[n];
    }
    inst.disabled = false;
    return diff;
}
function unmountComponent(component) {
    return __awaiter(this, void 0, void 0, function* () {
        const base = component.base;
        component.disabled = true;
        yield component.componentWillUnmount();
        if (component.child)
            yield unmountComponent(component.child);
        component.base = null;
        component.parent = null;
        component.child = null;
        if (base) {
            base._component = null;
            if (base[_constants__WEBPACK_IMPORTED_MODULE_0__["ATTR_KEY"]] && base[_constants__WEBPACK_IMPORTED_MODULE_0__["ATTR_KEY"]].ref)
                base[_constants__WEBPACK_IMPORTED_MODULE_0__["ATTR_KEY"]].ref(null);
            yield Object(_readapt_vdom_diff__WEBPACK_IMPORTED_MODULE_1__["recollectNodeTree"])(base, false);
        }
        if (component.ref)
            component.ref(null);
    });
}
function buildComponent(dom, node, parentNode) {
    return __awaiter(this, void 0, void 0, function* () {
        let c = dom && dom._component, isDirectOwner = c && c.constructor === node.nodeName, props = node.attributes, type = node.nodeName;
        if (isDirectOwner && c) {
            const update = prepareRender(c, props, node.childNodes);
            if (update._different) {
                yield renderComponent(c, parentNode);
                yield c.componentDidUpdate(update);
            }
            dom = c.base;
        }
        else {
            yield Object(_readapt_vdom_diff__WEBPACK_IMPORTED_MODULE_1__["recollectNodeTree"])(dom, false);
            c = new type(props, null);
            c.children = node.childNodes;
            if (c.ref)
                c.ref(c);
            yield renderComponent(c, parentNode);
            dom = c.base;
        }
        return dom;
    });
}


/***/ }),

/***/ "./src/constants.ts":
/*!**************************!*\
  !*** ./src/constants.ts ***!
  \**************************/
/*! exports provided: ATTR_KEY, ASYNC, SYNC, NONE, FORCE */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ATTR_KEY", function() { return ATTR_KEY; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ASYNC", function() { return ASYNC; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SYNC", function() { return SYNC; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "NONE", function() { return NONE; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FORCE", function() { return FORCE; });

const ATTR_KEY = '__readapt__';
const ASYNC = 3;
const SYNC = 1;
const NONE = 0;
const FORCE = 2;


/***/ }),

/***/ "./src/h.ts":
/*!******************!*\
  !*** ./src/h.ts ***!
  \******************/
/*! exports provided: h */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "h", function() { return h; });
/* harmony import */ var _readapt_vdom_vnode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./readapt-vdom/vnode */ "./src/readapt-vdom/vnode.ts");


function h(nodeName, attributes, ...children) {
    attributes = attributes || {};
    const stack = Array(0);
    let child, p = new _readapt_vdom_vnode__WEBPACK_IMPORTED_MODULE_0__["default"](nodeName, typeof nodeName === 'function' ? 'component' : 'element', '');
    children.forEach(c => stack.unshift(c));
    if (attributes && attributes.children != null) {
        if (!stack.length)
            stack.push(attributes.children);
        delete attributes.children;
    }
    while (stack.length) {
        child = stack.pop();
        if (Array.isArray(child))
            child.forEach(c => stack.unshift(c));
        else {
            if (child instanceof _readapt_vdom_vnode__WEBPACK_IMPORTED_MODULE_0__["default"])
                p.childNodes.push(child);
            else
                p.childNodes.push(new _readapt_vdom_vnode__WEBPACK_IMPORTED_MODULE_0__["default"]('#text', 'text', child));
        }
    }
    p.attributes = attributes;
    p.key = attributes.key ? attributes.key : undefined;
    return p;
}
;


/***/ }),

/***/ "./src/readapt-dom/index.ts":
/*!**********************************!*\
  !*** ./src/readapt-dom/index.ts ***!
  \**********************************/
/*! exports provided: DOM, createNode, removeNode, isSameNodeType, setAccessor */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DOM", function() { return DOM; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "createNode", function() { return createNode; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "removeNode", function() { return removeNode; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "isSameNodeType", function() { return isSameNodeType; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "setAccessor", function() { return setAccessor; });

const DOM = {
    document: null
};
function createNode(nodeName) {
    return DOM.document.createElement(nodeName);
}
function removeNode(node) {
    const parentNode = node.parentNode;
    if (parentNode)
        parentNode.removeChild(node);
}
function isSameNodeType(node, vnode, hydrating) {
    if (!node)
        return false;
    if (vnode.nodeType === 'text')
        return node.splitText;
    if (typeof vnode.nodeName === 'string')
        return !node._component && node.nodeName.toLowerCase() === vnode.nodeName.toLowerCase();
    return hydrating || (node._component && node._component.constructor === vnode.nodeName);
}
function setAccessor(node, name, old, value) {
    if (name === 'className')
        name = 'class';
    if (name === 'key') {
        //do nothing
    }
    else if (name === 'ref') {
        if (old)
            old(null);
        if (value)
            value(node);
    }
    else if (name === 'html') {
        if (old !== value) {
            node.innerHTML = value;
        }
    }
    else if (name === 'class') {
        if (!value || typeof value === 'string') {
            node.className = value || '';
        }
        else if (value && typeof value === 'object') {
            if (typeof old === 'object') {
                for (let i in old) {
                    if (!(i in value))
                        node.classList.remove(i);
                }
            }
            for (let i in value) {
                if (value[i])
                    node.classList.add(i);
                else
                    node.classList.remove(i);
            }
        }
    }
    else if (name === 'style') {
        if (!value || typeof value === 'string' || typeof old === 'string') {
            node.style.cssText = value || '';
        }
        else if (value && typeof value === 'object') {
            if (typeof old === 'object') {
                for (let i in old) {
                    if (!(i in value))
                        node.style[i] = '';
                }
            }
            else
                node.style.cssText = '';
            for (let i in value)
                node.style[i] = value[i] || '';
        }
    }
    else if (name[0] === 'o' && name[1] === 'n') {
        let useCapture = name !== (name = name.replace(/Capture$/, ''));
        name = name.toLowerCase().substring(2);
        if (value) {
            if (!old)
                node.addEventListener(name, value, useCapture);
        }
        else if (old)
            node.removeEventListener(name, old, useCapture);
    }
    else if (name !== 'list' && name !== 'type' && name in node) {
        try {
            node[name] = value == null ? '' : value;
        }
        catch (e) {
            if ((value == null || value === false) && name !== 'spellcheck')
                node.removeAttribute(name);
        }
    }
    else {
        if (value == null || value === false)
            node.removeAttribute(name);
        else if (typeof value !== 'function')
            node.setAttribute(name, value);
    }
}


/***/ }),

/***/ "./src/readapt-vdom/diff.ts":
/*!**********************************!*\
  !*** ./src/readapt-vdom/diff.ts ***!
  \**********************************/
/*! exports provided: inputs, hydrating, diffLevel, diff, recollectNodeTree, removeChildren */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "inputs", function() { return inputs; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "hydrating", function() { return hydrating; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "diffLevel", function() { return diffLevel; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "diff", function() { return diff; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "recollectNodeTree", function() { return recollectNodeTree; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "removeChildren", function() { return removeChildren; });
/* harmony import */ var _component__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../component */ "./src/component.ts");
/* harmony import */ var _constants__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../constants */ "./src/constants.ts");
/* harmony import */ var _readapt_dom_index__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../readapt-dom/index */ "./src/readapt-dom/index.ts");

var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};





const inputs = [
    'input',
    'textarea',
    'select',
    'meter',
    'progress',
    'button'
];
let hydrating = false;
let diffLevel = 0;
function diff(dom, node, parent, root) {
    return __awaiter(this, void 0, void 0, function* () {
        let ret = null;
        if (!diffLevel++)
            hydrating = dom && !dom[_constants__WEBPACK_IMPORTED_MODULE_1__["ATTR_KEY"]];
        ret = yield idiff(dom, node, parent, root);
        if (parent && ret.parentNode !== parent)
            parent.appendChild(ret);
        if (!--diffLevel) {
            hydrating = false;
        }
        return ret;
    });
}
function idiff(dom, node, parent, root) {
    return __awaiter(this, void 0, void 0, function* () {
        let out = dom;
        if (node.nodeValue == null || typeof node.nodeValue === 'boolean')
            node.nodeValue = '';
        if (node.nodeType === 'text') {
            if (dom && dom.splitText && dom.parentNode && (!dom._component || root)) {
                if (dom.nodeValue != node.nodeValue)
                    dom.nodeValue = node.nodeValue;
            }
            else {
                out = _readapt_dom_index__WEBPACK_IMPORTED_MODULE_2__["DOM"].document.createTextNode(node.nodeValue);
                if (dom) {
                    if (dom.parentNode)
                        dom.parentNode.replaceChild(out, dom);
                    yield recollectNodeTree(dom, false);
                }
            }
            out[_constants__WEBPACK_IMPORTED_MODULE_1__["ATTR_KEY"]] = {};
            return out;
        }
        let nodeName = node.nodeName, nroot;
        if (typeof nodeName === 'function')
            return yield Object(_component__WEBPACK_IMPORTED_MODULE_0__["buildComponent"])(dom, node, parent);
        if (!dom || dom.nodeName.toLowerCase() !== nodeName.toLowerCase()) {
            out = Object(_readapt_dom_index__WEBPACK_IMPORTED_MODULE_2__["createNode"])(nodeName);
            if (dom) {
                while (dom.firstChild)
                    out.appendChild(dom.firstChild);
                if (dom.parentNode)
                    dom.parentNode.replaceChild(out, dom);
                //recollect
                yield recollectNodeTree(dom, false);
            }
        }
        let props = out[_constants__WEBPACK_IMPORTED_MODULE_1__["ATTR_KEY"]];
        if (!props) {
            props = out[_constants__WEBPACK_IMPORTED_MODULE_1__["ATTR_KEY"]] = {};
            out.getAttributeNames().forEach(n => props[n] = out.getAttribute(n));
        }
        let fc = out.firstChild, children = node.childNodes;
        if ((children && children.length) || fc)
            yield innerDiffNode(out, children, root);
        diffAttributes(out, node.attributes, props);
        return out;
    });
}
function innerDiffNode(dom, vchildren, root) {
    return __awaiter(this, void 0, void 0, function* () {
        let originalChildren = dom.childNodes, children = Array(), keyed = {}, keyedLen = 0, min = 0, len = originalChildren.length, childrenLen = 0, vlen = vchildren ? vchildren.length : 0, j, c, f, vchild, child;
        // Build up a map of keyed children and an Array of unkeyed children:
        if (len !== 0) {
            for (let i = 0; i < len; i++) {
                let child = originalChildren[i], props = child[_constants__WEBPACK_IMPORTED_MODULE_1__["ATTR_KEY"]], key = vlen && props ? child._component ? child._component.key : props.key : null;
                if (key != null) {
                    keyedLen++;
                    keyed[key] = child;
                }
                else if (props || (child.splitText !== undefined ? (hydrating ? child.nodeValue.trim() : true) : hydrating)) {
                    children[childrenLen++] = child;
                }
            }
        }
        if (vlen !== 0) {
            for (let i = 0; i < vlen; i++) {
                vchild = vchildren[i];
                child = null;
                // attempt to find a node based on key matching
                let key = vchild.key;
                if (key != null) {
                    if (keyedLen && keyed[key] !== undefined) {
                        child = keyed[key];
                        keyed[key] = undefined;
                        keyedLen--;
                    }
                }
                // attempt to pluck a node of the same type from the existing children
                else if (min < childrenLen) {
                    for (j = min; j < childrenLen; j++) {
                        if (children[j] !== undefined && Object(_readapt_dom_index__WEBPACK_IMPORTED_MODULE_2__["isSameNodeType"])(c = children[j], vchild, hydrating)) {
                            child = c;
                            children[j] = undefined;
                            if (j === childrenLen - 1)
                                childrenLen--;
                            if (j === min)
                                min++;
                            break;
                        }
                    }
                }
                // morph the matched/found/created DOM child to match vchild (deep)
                child = yield idiff(child, vchild, dom, root);
                f = originalChildren[i];
                if (child && child !== dom && child !== f) {
                    if (f == null) {
                        dom.appendChild(child);
                    }
                    else if (child === f.nextSibling) {
                        Object(_readapt_dom_index__WEBPACK_IMPORTED_MODULE_2__["removeNode"])(f);
                    }
                    else {
                        dom.insertBefore(child, f);
                    }
                }
            }
        }
        // remove unused keyed children:
        if (keyedLen) {
            for (let i in keyed)
                if (keyed[i] !== undefined)
                    yield recollectNodeTree(keyed[i], false);
        }
        // remove orphaned unkeyed children:
        while (min <= childrenLen) {
            if ((child = children[childrenLen--]) !== undefined)
                yield recollectNodeTree(child, false);
        }
    });
}
function recollectNodeTree(node, unmountOnly) {
    return __awaiter(this, void 0, void 0, function* () {
        if (!node)
            return;
        let component = node._component;
        if (component)
            yield Object(_component__WEBPACK_IMPORTED_MODULE_0__["unmountComponent"])(component);
        if (node[_constants__WEBPACK_IMPORTED_MODULE_1__["ATTR_KEY"]] && node[_constants__WEBPACK_IMPORTED_MODULE_1__["ATTR_KEY"]].ref)
            node[_constants__WEBPACK_IMPORTED_MODULE_1__["ATTR_KEY"]].ref(null);
        if (unmountOnly === false || node[_constants__WEBPACK_IMPORTED_MODULE_1__["ATTR_KEY"]])
            Object(_readapt_dom_index__WEBPACK_IMPORTED_MODULE_2__["removeNode"])(node);
        yield removeChildren(node);
    });
}
function removeChildren(node) {
    return __awaiter(this, void 0, void 0, function* () {
        node = node.lastChild;
        while (node) {
            let next = node.previousSibling;
            yield recollectNodeTree(node, true);
            node = next;
        }
    });
}
function diffAttributes(dom, attrs, old) {
    let name;
    for (name in old) {
        if (!(attrs && attrs[name] != null) && old[name] != null)
            Object(_readapt_dom_index__WEBPACK_IMPORTED_MODULE_2__["setAccessor"])(dom, name, old, old[name] = undefined);
    }
    for (name in attrs) {
        if (name !== 'children' && name !== 'innerHTML'
            && (attrs[name] !== ((name === 'value' || name === 'checked') ? dom[name] : old[name])))
            Object(_readapt_dom_index__WEBPACK_IMPORTED_MODULE_2__["setAccessor"])(dom, name, old[name], old[name] = attrs[name]);
    }
}


/***/ }),

/***/ "./src/readapt-vdom/vnode.ts":
/*!***********************************!*\
  !*** ./src/readapt-vdom/vnode.ts ***!
  \***********************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return VNode; });

class VNode {
    constructor(name, type, v) {
        this.nodeName = name;
        this.nodeType = type;
        this.nodeValue = v;
        this.childNodes = Array(0);
    }
}


/***/ }),

/***/ "./src/render.ts":
/*!***********************!*\
  !*** ./src/render.ts ***!
  \***********************/
/*! exports provided: enqueue, hydrate, render */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "enqueue", function() { return enqueue; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "hydrate", function() { return hydrate; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "render", function() { return render; });
/* harmony import */ var _component__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./component */ "./src/component.ts");
/* harmony import */ var _readapt_vdom_diff__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./readapt-vdom/diff */ "./src/readapt-vdom/diff.ts");

var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};


let renderQueue = Array(0);
function enqueue(component) {
    renderQueue.unshift(component);
    (component.asyncMethod || _component__WEBPACK_IMPORTED_MODULE_0__["DEFER_PROMISE"])(() => __awaiter(this, void 0, void 0, function* () {
        let p, list = renderQueue;
        renderQueue = Array(0);
        while ((p = list.pop()))
            yield Object(_component__WEBPACK_IMPORTED_MODULE_0__["renderComponent"])(p, p.parentNode);
    }));
}
function hydrate(node, parent) {
    return __awaiter(this, void 0, void 0, function* () {
        return yield render(node, parent, parent.firstElementChild);
    });
}
function render(node, parent, merge) {
    return __awaiter(this, void 0, void 0, function* () {
        return yield Object(_readapt_vdom_diff__WEBPACK_IMPORTED_MODULE_1__["diff"])(merge, node, parent, true);
    });
}


/***/ })

/******/ });
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NsaWVudC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50LnRzIiwid2VicGFjazovLy8uL3NyYy9jb25zdGFudHMudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2gudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3JlYWRhcHQtZG9tL2luZGV4LnRzIiwid2VicGFjazovLy8uL3NyYy9yZWFkYXB0LXZkb20vZGlmZi50cyIsIndlYnBhY2s6Ly8vLi9zcmMvcmVhZGFwdC12ZG9tL3Zub2RlLnRzIiwid2VicGFjazovLy8uL3NyYy9yZW5kZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtRQUFBO1FBQ0E7O1FBRUE7UUFDQTs7UUFFQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTs7UUFFQTtRQUNBOztRQUVBO1FBQ0E7O1FBRUE7UUFDQTtRQUNBOzs7UUFHQTtRQUNBOztRQUVBO1FBQ0E7O1FBRUE7UUFDQTtRQUNBO1FBQ0EsMENBQTBDLGdDQUFnQztRQUMxRTtRQUNBOztRQUVBO1FBQ0E7UUFDQTtRQUNBLHdEQUF3RCxrQkFBa0I7UUFDMUU7UUFDQSxpREFBaUQsY0FBYztRQUMvRDs7UUFFQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0EseUNBQXlDLGlDQUFpQztRQUMxRSxnSEFBZ0gsbUJBQW1CLEVBQUU7UUFDckk7UUFDQTs7UUFFQTtRQUNBO1FBQ0E7UUFDQSwyQkFBMkIsMEJBQTBCLEVBQUU7UUFDdkQsaUNBQWlDLGVBQWU7UUFDaEQ7UUFDQTtRQUNBOztRQUVBO1FBQ0Esc0RBQXNELCtEQUErRDs7UUFFckg7UUFDQTs7O1FBR0E7UUFDQTs7Ozs7Ozs7Ozs7OztBQ2xGQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQWE7QUFDNkI7QUFDTjtBQUNJO0FBQ0M7QUFFekMsc0RBQUcs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QUFBIiwiZmlsZSI6InJlYWRhcHQuZGV2Lm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGdldHRlciB9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yID0gZnVuY3Rpb24oZXhwb3J0cykge1xuIFx0XHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcbiBcdFx0fVxuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xuIFx0fTtcblxuIFx0Ly8gY3JlYXRlIGEgZmFrZSBuYW1lc3BhY2Ugb2JqZWN0XG4gXHQvLyBtb2RlICYgMTogdmFsdWUgaXMgYSBtb2R1bGUgaWQsIHJlcXVpcmUgaXRcbiBcdC8vIG1vZGUgJiAyOiBtZXJnZSBhbGwgcHJvcGVydGllcyBvZiB2YWx1ZSBpbnRvIHRoZSBuc1xuIFx0Ly8gbW9kZSAmIDQ6IHJldHVybiB2YWx1ZSB3aGVuIGFscmVhZHkgbnMgb2JqZWN0XG4gXHQvLyBtb2RlICYgOHwxOiBiZWhhdmUgbGlrZSByZXF1aXJlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnQgPSBmdW5jdGlvbih2YWx1ZSwgbW9kZSkge1xuIFx0XHRpZihtb2RlICYgMSkgdmFsdWUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKHZhbHVlKTtcbiBcdFx0aWYobW9kZSAmIDgpIHJldHVybiB2YWx1ZTtcbiBcdFx0aWYoKG1vZGUgJiA0KSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHZhbHVlICYmIHZhbHVlLl9fZXNNb2R1bGUpIHJldHVybiB2YWx1ZTtcbiBcdFx0dmFyIG5zID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yKG5zKTtcbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KG5zLCAnZGVmYXVsdCcsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHZhbHVlIH0pO1xuIFx0XHRpZihtb2RlICYgMiAmJiB0eXBlb2YgdmFsdWUgIT0gJ3N0cmluZycpIGZvcih2YXIga2V5IGluIHZhbHVlKSBfX3dlYnBhY2tfcmVxdWlyZV9fLmQobnMsIGtleSwgZnVuY3Rpb24oa2V5KSB7IHJldHVybiB2YWx1ZVtrZXldOyB9LmJpbmQobnVsbCwga2V5KSk7XG4gXHRcdHJldHVybiBucztcbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSBcIi4vc3JjL2NsaWVudC5qc1wiKTtcbiIsIid1c2Ugc3RyaWN0JztcclxuaW1wb3J0IHtoLCBoIGFzIGNyZWF0ZUVsZW1lbnR9IGZyb20gJy4vaCc7XHJcbmltcG9ydCBDb21wb25lbnQgZnJvbSAnLi9jb21wb25lbnQnO1xyXG5pbXBvcnQge0RPTX0gZnJvbSAnLi9yZWFkYXB0LWRvbS9pbmRleCc7XHJcbmltcG9ydCB7cmVuZGVyLCBoeWRyYXRlfSBmcm9tICcuL3JlbmRlcic7XHJcblxyXG5ET00uZG9jdW1lbnQgPSBkb2N1bWVudDtcclxud2luZG93LmggPSBoO1xyXG53aW5kb3cuQ29tcG9uZW50ID0gQ29tcG9uZW50O1xyXG53aW5kb3cuUmVhZGFwdCA9IHtcclxuICAgIHJlbmRlcjogcmVuZGVyLFxyXG4gICAgaHlkcmF0ZTogaHlkcmF0ZVxyXG59O1xyXG53aW5kb3cuUmVhY3QgPSB7XHJcbiAgICBjcmVhdGVFbGVtZW50OiBjcmVhdGVFbGVtZW50LFxyXG4gICAgcmVuZGVyOiByZW5kZXIsXHJcbiAgICBoeWRyYXRlOiBoeWRyYXRlXHJcbn07IiwiJ3VzZSBzdHJpY3QnO1xyXG5pbXBvcnQge3JlbW92ZU5vZGV9IGZyb20gJy4vcmVhZGFwdC1kb20vaW5kZXgnO1xyXG5pbXBvcnQgVk5vZGUgZnJvbSAnLi9yZWFkYXB0LXZkb20vdm5vZGUnO1xyXG5pbXBvcnQgeyBBVFRSX0tFWSwgQVNZTkMsIFNZTkMgfSBmcm9tICcuL2NvbnN0YW50cyc7XHJcbmltcG9ydCB7IGRpZmYsIHJlY29sbGVjdE5vZGVUcmVlIH0gZnJvbSAnLi9yZWFkYXB0LXZkb20vZGlmZic7XHJcbmltcG9ydCB7IGRpZmZMZXZlbH0gZnJvbSAnLi9yZWFkYXB0LXZkb20vZGlmZic7XHJcbmltcG9ydCB7IGVucXVldWUgfSBmcm9tICcuL3JlbmRlcic7XHJcblxyXG5leHBvcnQgY29uc3QgREVGRVJfUFJPTUlTRSA9IFByb21pc2UucmVzb2x2ZSgpLnRoZW4uYmluZChQcm9taXNlLnJlc29sdmUoKSk7XHJcbmV4cG9ydCBjb25zdCBERUZFUl9USU1FT1VUID0gc2V0VGltZW91dDtcclxuZXhwb3J0IGNvbnN0IERFRkVSX0FOSU1BVElPTiA9IHR5cGVvZiByZXF1ZXN0QW5pbWF0aW9uRnJhbWUgIT09ICd1bmRlZmluZWQnID8gcmVxdWVzdEFuaW1hdGlvbkZyYW1lIDogREVGRVJfUFJPTUlTRTtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIENvbXBvbmVudCB7XHJcbiAgICBrZXk6IGFueTtcclxuICAgIHJlZjogYW55O1xyXG4gICAgZGlzYWJsZWQ6IGJvb2xlYW47XHJcbiAgICBwYXJlbnQgOiBhbnk7XHJcbiAgICBiYXNlOiBhbnk7XHJcbiAgICByZW5kZXJNb2RlOiBOdW1iZXI7XHJcbiAgICBjaGlsZDogYW55O1xyXG4gICAgYXN5bmNNZXRob2Q6IGFueTtcclxuICAgIHBhcmVudE5vZGU6IGFueTtcclxuICAgIGNoaWxkcmVuOiBBcnJheTxhbnk+O1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKHByb3BzOiBhbnksIHBhcmVudDogQ29tcG9uZW50LCByZW5kZXJNb2RlOiBhbnkpIHtcclxuICAgICAgICB0aGlzLmRpc2FibGVkID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5rZXkgPSBwcm9wcy5rZXk7XHJcbiAgICAgICAgdGhpcy5yZWYgPSBwcm9wcy5yZWY7XHJcbiAgICAgICAgdGhpcy5hc3luY01ldGhvZCA9IERFRkVSX1BST01JU0U7XHJcbiAgICAgICAgdGhpcy5yZW5kZXJNb2RlID0gcmVuZGVyTW9kZSB8fCBTWU5DO1xyXG4gICAgICAgIHRoaXMuY2hpbGQgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuYmFzZSA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5wYXJlbnQgPSBwYXJlbnQ7XHJcbiAgICAgICAgdGhpcy5wYXJlbnROb2RlID0gbnVsbDtcclxuICAgICAgICB0aGlzLmNoaWxkcmVuID0gW107XHJcbiAgICAgICAgXHJcbiAgICAgICAgZGVsZXRlIHByb3BzLnJlZjtcclxuICAgICAgICBkZWxldGUgcHJvcHMua2V5O1xyXG4gICBcclxuICAgICAgICB0aGlzLm9ic2VydmUocHJvcHMpO1xyXG4gICAgfVxyXG5cclxuICAgIHByb3RlY3RlZCBhc3luYyBjb21wb25lbnRDaGFuZ2Uoa2V5OiBzdHJpbmcsIHZhbHVlOiBhbnksIHByZXZpb3VzOiBhbnkpIHtcclxuICAgICAgICBpZih0aGlzLnNob3VsZENvbXBvbmVudFVwZGF0ZShrZXksdmFsdWUscHJldmlvdXMpKSB7XHJcbiAgICAgICAgICAgIGlmKHRoaXMucmVuZGVyTW9kZSA9PT0gU1lOQykgYXdhaXQgcmVuZGVyQ29tcG9uZW50KHRoaXMsIHRoaXMucGFyZW50Tm9kZSk7XHJcbiAgICAgICAgICAgIGVsc2UgaWYodGhpcy5yZW5kZXJNb2RlID09PSBBU1lOQykgZW5xdWV1ZSh0aGlzKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgYXN5bmMgZm9yY2VVcGRhdGUoKSB7XHJcbiAgICAgICAgYXdhaXQgcmVuZGVyQ29tcG9uZW50KHRoaXMsIHRoaXMucGFyZW50Tm9kZSk7XHJcbiAgICB9XHJcblxyXG4gICAgYXN5bmMgY29tcG9uZW50RGlkVXBkYXRlKHByZXZpb3VzKSA6IFByb21pc2U8YW55PiB7XHJcbiAgICAgICAgXHJcbiAgICB9XHJcblxyXG4gICAgYXN5bmMgcmVuZGVyKCkgOiBQcm9taXNlPGFueT4ge1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBhc3luYyBjb21wb25lbnRXaWxsVW5tb3VudCgpIDogUHJvbWlzZTxhbnk+IHtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgYXN5bmMgY29tcG9uZW50RGlkTW91bnQoKSA6IFByb21pc2U8YW55PiB7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIHByb3RlY3RlZCBzaG91bGRDb21wb25lbnRVcGRhdGUoa2V5OiBzdHJpbmcsIHZhbHVlOiBhbnksIHByZXZpb3VzOiBhbnkpIDogYm9vbGVhbiB7XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9XHJcblxyXG4gICAgcHJvdGVjdGVkIG9ic2VydmUobzogT2JqZWN0KSB7XHJcbiAgICAgICAgZm9yKGxldCBrIGluIG8pIHtcclxuICAgICAgICAgICAgbGV0IHYgOiBhbnkgPSBvW2tdO1xyXG5cclxuICAgICAgICAgICAgaWYodHlwZW9mIHYgPT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgICAgICAgICAgIHRoaXNba10gPSB2O1xyXG4gICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBgXFwkJHtrfWAsIHt2YWx1ZTogdiwgd3JpdGFibGU6IHRydWUsIGVudW1lcmFibGU6IGZhbHNlIH0pO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIGssIHtcclxuICAgICAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgICAgICAgICBnZXQoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXNbYFxcJCR7a31gXTtcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBzZXQobnY6IGFueSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHByZXYgPSB0aGlzW2BcXCQke2t9YF07XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpc1tgXFwkJHtrfWBdID0gbnY7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmKCF0aGlzLmRpc2FibGVkICYmIHByZXYgIT09IG52KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY29tcG9uZW50Q2hhbmdlKGssbnYscHJldik7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZW5kZXJDb21wb25lbnQoY29tcG9uZW50OiBDb21wb25lbnQsIHBhcmVudE5vZGU6IGFueSkge1xyXG4gICAgbGV0IGlzVXBkYXRlID0gY29tcG9uZW50LmJhc2UsIHAsIHByb3BzLCByZW5kZXJlZCwgdG9Vbm1vdW50LCBjYmFzZSwgaW5zdCwgYmFzZSwgdHlwZTtcclxuICAgIGlmKGNvbXBvbmVudC5kaXNhYmxlZCkgcmV0dXJuO1xyXG5cclxuICAgIHJlbmRlcmVkID0gYXdhaXQgY29tcG9uZW50LnJlbmRlcigpO1xyXG5cclxuICAgIGlmKCFyZW5kZXJlZCB8fCBBcnJheS5pc0FycmF5KHJlbmRlcmVkKSkge1xyXG4gICAgICAgIGlmKGNvbXBvbmVudC5jaGlsZCkge1xyXG4gICAgICAgICAgICBhd2FpdCB1bm1vdW50Q29tcG9uZW50KGNvbXBvbmVudC5jaGlsZCk7XHJcbiAgICAgICAgICAgIGNvbXBvbmVudC5jaGlsZCA9IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmKGNvbXBvbmVudC5iYXNlKSB7XHJcbiAgICAgICAgICAgIGNvbXBvbmVudC5iYXNlLl9jb21wb25lbnQgPSBudWxsO1xyXG4gICAgICAgICAgICBhd2FpdCByZWNvbGxlY3ROb2RlVHJlZShjb21wb25lbnQuYmFzZSwgZmFsc2UpO1xyXG4gICAgICAgICAgICBjb21wb25lbnQuYmFzZSA9IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICBjb21wb25lbnQucGFyZW50Tm9kZSA9IHBhcmVudE5vZGU7XHJcbiAgICBjYmFzZSA9IGJhc2UgPSBjb21wb25lbnQuYmFzZTtcclxuXHJcbiAgICBpZih0eXBlb2YgcmVuZGVyZWQubm9kZU5hbWUgPT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgICBwcm9wcyA9IHJlbmRlcmVkLmF0dHJpYnV0ZXM7XHJcbiAgICAgICAgaW5zdCA9IGNvbXBvbmVudC5jaGlsZDtcclxuICAgICAgICBpZihpbnN0ICYmIGluc3QuY29uc3RydWN0b3IgPT09IHJlbmRlcmVkLm5vZGVOYW1lKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHVwZGF0ZSA9IHByZXBhcmVSZW5kZXIoaW5zdCwgcHJvcHMsIHJlbmRlcmVkLmNoaWxkTm9kZXMpO1xyXG4gICAgICAgICAgICBpZih1cGRhdGUuX2RpZmZlcmVudCkge1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgcmVuZGVyQ29tcG9uZW50KGluc3QsIGluc3QucGFyZW50Tm9kZSk7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCBpbnN0LmNvbXBvbmVudERpZFVwZGF0ZSh1cGRhdGUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0b1VubW91bnQgPSBpbnN0OyB0eXBlID0gcmVuZGVyZWQubm9kZU5hbWU7XHJcblxyXG4gICAgICAgICAgICBpZihjYmFzZSAmJiAhdG9Vbm1vdW50KSB7XHJcbiAgICAgICAgICAgICAgICBjYmFzZS5fY29tcG9uZW50ID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIGF3YWl0IHJlY29sbGVjdE5vZGVUcmVlKGNiYXNlLCBmYWxzZSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNvbXBvbmVudC5jaGlsZCA9IGluc3QgPSBuZXcgdHlwZShwcm9wcywgY29tcG9uZW50KTtcclxuICAgICAgICAgICAgaW5zdC5jaGlsZHJlbiA9IHJlbmRlcmVkLmNoaWxkTm9kZXM7XHJcbiAgICAgICAgICAgIGlmKGluc3QucmVmKSBpbnN0LnJlZihpbnN0KTtcclxuICAgICAgICAgICAgYXdhaXQgcmVuZGVyQ29tcG9uZW50KGluc3QsIGNvbXBvbmVudC5wYXJlbnROb2RlKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGJhc2UgPSBpbnN0LmJhc2U7XHJcbiAgICB9XHJcbiAgICBpZih0eXBlb2YgcmVuZGVyZWQubm9kZU5hbWUgIT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgICB0b1VubW91bnQgPSBjb21wb25lbnQuY2hpbGQ7XHJcbiAgICAgICAgaWYodG9Vbm1vdW50KSBjYmFzZSA9IGNvbXBvbmVudC5jaGlsZCA9IG51bGw7XHJcbiAgICAgICAgYmFzZSA9IGF3YWl0IGRpZmYoY2Jhc2UsIHJlbmRlcmVkLCBjb21wb25lbnQucGFyZW50Tm9kZSwgdHJ1ZSk7XHJcbiAgICB9XHJcblxyXG4gICAgaWYoY2Jhc2UgJiYgYmFzZSAhPT0gY2Jhc2UgJiYgaW5zdCAhPT0gY29tcG9uZW50LmNoaWxkKSB7XHJcbiAgICAgICAgcCA9IGNiYXNlLnBhcmVudE5vZGU7XHJcbiAgICAgICAgaWYocCAmJiBiYXNlICE9PSBwKSB7XHJcbiAgICAgICAgICAgIHAucmVwbGFjZUNoaWxkKGJhc2UsIGNiYXNlKTtcclxuXHJcbiAgICAgICAgICAgIGlmKCF0b1VubW91bnQpIHtcclxuICAgICAgICAgICAgICAgIGNiYXNlLl9jb21wb25lbnQgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgcmVjb2xsZWN0Tm9kZVRyZWUoY2Jhc2UsIGZhbHNlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBpZih0b1VubW91bnQpIGF3YWl0IHVubW91bnRDb21wb25lbnQodG9Vbm1vdW50KTtcclxuXHJcbiAgICBjb21wb25lbnQuYmFzZSA9IGJhc2U7XHJcbiAgICBpZihiYXNlICYmICFjb21wb25lbnQuY2hpbGQpIHtcclxuICAgICAgICBsZXQgY21wID0gY29tcG9uZW50LCB0ID0gY29tcG9uZW50O1xyXG5cclxuICAgICAgICB3aGlsZSgodCA9IHQucGFyZW50KSkge1xyXG4gICAgICAgICAgICAoY21wID0gdCkuYmFzZSA9IGJhc2U7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBiYXNlLl9jb21wb25lbnQgPSBjbXA7XHJcbiAgICB9IFxyXG4gICAgaWYoIWlzVXBkYXRlKSB7XHJcbiAgICAgICAgYXdhaXQgY29tcG9uZW50LmNvbXBvbmVudERpZE1vdW50KCk7XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBwcmVwYXJlUmVuZGVyKGluc3Q6IENvbXBvbmVudCwgcHJvcHM6IGFueSwgY2hpbGRyZW46IEFycmF5PGFueT4pIDogYW55IHtcclxuICAgIGxldCBkaWZmID0ge19kaWZmZXJlbnQ6IGZhbHNlfTtcclxuICAgIGlmKGluc3QucmVmKSBpbnN0LnJlZihpbnN0KTtcclxuICAgIGluc3QuY2hpbGRyZW4gPSBjaGlsZHJlbjtcclxuXHJcbiAgICBpbnN0LmRpc2FibGVkID0gdHJ1ZTtcclxuICAgIGZvcihsZXQgbiBpbiBwcm9wcykge1xyXG5cdFx0aWYoaW5zdFtuXSAhPT0gcHJvcHNbbl0pIHtcclxuXHRcdFx0ZGlmZltuXSA9IGluc3Rbbl07XHJcblx0XHRcdGRpZmYuX2RpZmZlcmVudCA9IHRydWU7XHJcblx0XHR9XHJcblx0XHRpbnN0W25dID0gcHJvcHNbbl07XHJcbiAgICB9XHJcbiAgICBpbnN0LmRpc2FibGVkID0gZmFsc2U7XHJcblxyXG4gICAgcmV0dXJuIGRpZmY7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1bm1vdW50Q29tcG9uZW50KGNvbXBvbmVudDogQ29tcG9uZW50KSB7XHJcbiAgICBjb25zdCBiYXNlID0gY29tcG9uZW50LmJhc2U7XHJcbiAgICBjb21wb25lbnQuZGlzYWJsZWQgPSB0cnVlO1xyXG4gICAgYXdhaXQgY29tcG9uZW50LmNvbXBvbmVudFdpbGxVbm1vdW50KCk7XHJcbiAgICBpZihjb21wb25lbnQuY2hpbGQpIGF3YWl0IHVubW91bnRDb21wb25lbnQoY29tcG9uZW50LmNoaWxkKTtcclxuICAgIGNvbXBvbmVudC5iYXNlID0gbnVsbDtcclxuICAgIGNvbXBvbmVudC5wYXJlbnQgPSBudWxsO1xyXG4gICAgY29tcG9uZW50LmNoaWxkID0gbnVsbDtcclxuICAgIGlmKGJhc2UpIHtcclxuICAgICAgICBiYXNlLl9jb21wb25lbnQgPSBudWxsO1xyXG4gICAgICAgIGlmKGJhc2VbQVRUUl9LRVldICYmIGJhc2VbQVRUUl9LRVldLnJlZikgYmFzZVtBVFRSX0tFWV0ucmVmKG51bGwpO1xyXG5cclxuICAgICAgICBhd2FpdCByZWNvbGxlY3ROb2RlVHJlZShiYXNlLCBmYWxzZSk7XHJcbiAgICB9XHJcbiAgICBpZihjb21wb25lbnQucmVmKSBjb21wb25lbnQucmVmKG51bGwpO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gYnVpbGRDb21wb25lbnQoZG9tOiBhbnksIG5vZGU6IFZOb2RlLCBwYXJlbnROb2RlOiBhbnkpIHtcclxuICAgIGxldCBjID0gZG9tICYmIGRvbS5fY29tcG9uZW50LFxyXG4gICAgICAgIGlzRGlyZWN0T3duZXIgPSBjICYmIGMuY29uc3RydWN0b3IgPT09IG5vZGUubm9kZU5hbWUsXHJcbiAgICAgICAgcHJvcHMgPSBub2RlLmF0dHJpYnV0ZXMsXHJcbiAgICAgICAgdHlwZSA9IG5vZGUubm9kZU5hbWU7XHJcblxyXG4gICAgaWYoaXNEaXJlY3RPd25lciAmJiBjKSB7XHJcbiAgICAgICAgY29uc3QgdXBkYXRlID0gcHJlcGFyZVJlbmRlcihjLCBwcm9wcywgbm9kZS5jaGlsZE5vZGVzKTtcclxuICAgICAgICBpZih1cGRhdGUuX2RpZmZlcmVudCkge1xyXG4gICAgICAgICAgICBhd2FpdCByZW5kZXJDb21wb25lbnQoYywgcGFyZW50Tm9kZSk7XHJcbiAgICAgICAgICAgIGF3YWl0IGMuY29tcG9uZW50RGlkVXBkYXRlKHVwZGF0ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGRvbSA9IGMuYmFzZTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIGF3YWl0IHJlY29sbGVjdE5vZGVUcmVlKGRvbSwgZmFsc2UpO1xyXG4gICAgICAgIGMgPSBuZXcgdHlwZShwcm9wcywgbnVsbCk7XHJcbiAgICAgICAgYy5jaGlsZHJlbiA9IG5vZGUuY2hpbGROb2RlcztcclxuICAgICAgICBpZihjLnJlZikgYy5yZWYoYyk7XHJcbiAgICAgICAgYXdhaXQgcmVuZGVyQ29tcG9uZW50KGMsIHBhcmVudE5vZGUpO1xyXG4gICAgICAgIGRvbSA9IGMuYmFzZTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgcmV0dXJuIGRvbTtcclxufSIsIid1c2Ugc3RyaWN0JztcclxuXHJcbmV4cG9ydCBjb25zdCBBVFRSX0tFWSA9ICdfX3JlYWRhcHRfXyc7XHJcbmV4cG9ydCBjb25zdCBBU1lOQyA9IDM7XHJcbmV4cG9ydCBjb25zdCBTWU5DID0gMTtcclxuZXhwb3J0IGNvbnN0IE5PTkUgPSAwO1xyXG5leHBvcnQgY29uc3QgRk9SQ0UgPSAyOyIsIid1c2Ugc3RyaWN0JztcclxuXHJcbmltcG9ydCBWTm9kZSBmcm9tICcuL3JlYWRhcHQtdmRvbS92bm9kZSc7XHJcbmltcG9ydCBDb21wb25lbnQgZnJvbSAnLi9jb21wb25lbnQnO1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGgobm9kZU5hbWU6IHN0cmluZyB8IENvbXBvbmVudCwgYXR0cmlidXRlczogYW55LCAuLi5jaGlsZHJlbikge1xyXG4gICAgYXR0cmlidXRlcyA9IGF0dHJpYnV0ZXMgfHwge307XHJcbiAgICBjb25zdCBzdGFjayA9IEFycmF5PGFueT4oMCk7XHJcbiAgICBsZXQgY2hpbGQsIHAgPSBuZXcgVk5vZGUobm9kZU5hbWUsIHR5cGVvZiBub2RlTmFtZSA9PT0gJ2Z1bmN0aW9uJyA/ICdjb21wb25lbnQnIDogJ2VsZW1lbnQnLCAnJyk7XHJcblxyXG4gICAgY2hpbGRyZW4uZm9yRWFjaChjID0+IHN0YWNrLnVuc2hpZnQoYykpO1xyXG4gICAgaWYoYXR0cmlidXRlcyAmJiBhdHRyaWJ1dGVzLmNoaWxkcmVuICE9IG51bGwpIHtcclxuICAgICAgICBpZighc3RhY2subGVuZ3RoKSBzdGFjay5wdXNoKGF0dHJpYnV0ZXMuY2hpbGRyZW4pO1xyXG4gICAgICAgIGRlbGV0ZSBhdHRyaWJ1dGVzLmNoaWxkcmVuO1xyXG4gICAgfVxyXG5cclxuICAgIHdoaWxlKHN0YWNrLmxlbmd0aCkge1xyXG4gICAgICAgIGNoaWxkID0gc3RhY2sucG9wKCk7XHJcbiAgICAgICAgaWYoQXJyYXkuaXNBcnJheShjaGlsZCkpIGNoaWxkLmZvckVhY2goYyA9PiBzdGFjay51bnNoaWZ0KGMpKTtcclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgaWYoY2hpbGQgaW5zdGFuY2VvZiBWTm9kZSkgcC5jaGlsZE5vZGVzLnB1c2goY2hpbGQpO1xyXG4gICAgICAgICAgICBlbHNlIHAuY2hpbGROb2Rlcy5wdXNoKG5ldyBWTm9kZSgnI3RleHQnLCAndGV4dCcsIGNoaWxkKSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICBwLmF0dHJpYnV0ZXMgPSBhdHRyaWJ1dGVzO1xyXG4gICAgcC5rZXkgPSBhdHRyaWJ1dGVzLmtleSA/IGF0dHJpYnV0ZXMua2V5IDogdW5kZWZpbmVkO1xyXG5cclxuICAgIHJldHVybiBwO1xyXG59OyIsIid1c2Ugc3RyaWN0JztcclxuXHJcbmV4cG9ydCBjb25zdCBET00gOiBhbnkgPSB7XHJcbiAgICBkb2N1bWVudDogbnVsbFxyXG59O1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZU5vZGUobm9kZU5hbWU6IHN0cmluZykge1xyXG4gICAgcmV0dXJuIERPTS5kb2N1bWVudC5jcmVhdGVFbGVtZW50KG5vZGVOYW1lKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHJlbW92ZU5vZGUobm9kZSkge1xyXG4gICAgY29uc3QgcGFyZW50Tm9kZSA9IG5vZGUucGFyZW50Tm9kZTtcclxuICAgIGlmIChwYXJlbnROb2RlKSBwYXJlbnROb2RlLnJlbW92ZUNoaWxkKG5vZGUpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gaXNTYW1lTm9kZVR5cGUobm9kZTogYW55LCB2bm9kZTogYW55LCBoeWRyYXRpbmc6IGJvb2xlYW4pIHtcclxuICAgIGlmKCFub2RlKSByZXR1cm4gZmFsc2U7XHJcbiAgICBpZih2bm9kZS5ub2RlVHlwZSA9PT0gJ3RleHQnKSByZXR1cm4gbm9kZS5zcGxpdFRleHQ7XHJcbiAgICBpZih0eXBlb2Ygdm5vZGUubm9kZU5hbWUgPT09ICdzdHJpbmcnKSByZXR1cm4gIW5vZGUuX2NvbXBvbmVudCAmJiBub2RlLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkgPT09IHZub2RlLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk7XHJcblxyXG4gICAgcmV0dXJuIGh5ZHJhdGluZyB8fCAobm9kZS5fY29tcG9uZW50ICYmIG5vZGUuX2NvbXBvbmVudC5jb25zdHJ1Y3RvciA9PT0gdm5vZGUubm9kZU5hbWUpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gc2V0QWNjZXNzb3Iobm9kZSwgbmFtZSwgb2xkLCB2YWx1ZSkge1xyXG4gICAgaWYobmFtZSA9PT0gJ2NsYXNzTmFtZScpIG5hbWUgPSAnY2xhc3MnO1xyXG4gICAgaWYobmFtZSA9PT0gJ2tleScpIHtcclxuICAgICAgICAvL2RvIG5vdGhpbmdcclxuICAgIH1cclxuICAgIGVsc2UgaWYobmFtZSA9PT0gJ3JlZicpIHtcclxuICAgICAgICBpZihvbGQpIG9sZChudWxsKTtcclxuICAgICAgICBpZih2YWx1ZSkgdmFsdWUobm9kZSk7XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmKG5hbWUgPT09ICdodG1sJykge1xyXG4gICAgICAgIGlmKG9sZCAhPT0gdmFsdWUpIHtcclxuICAgICAgICAgICAgbm9kZS5pbm5lckhUTUwgPSB2YWx1ZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmKG5hbWUgPT09ICdjbGFzcycpIHtcclxuICAgICAgICBpZighdmFsdWUgfHwgdHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJykge1xyXG4gICAgICAgICAgICBub2RlLmNsYXNzTmFtZSA9IHZhbHVlIHx8ICcnO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmKHZhbHVlICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcpIHtcclxuICAgICAgICAgICAgaWYodHlwZW9mIG9sZCA9PT0gJ29iamVjdCcpIHtcclxuICAgICAgICAgICAgICAgIGZvcihsZXQgaSBpbiBvbGQpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIShpIGluIHZhbHVlKSkgbm9kZS5jbGFzc0xpc3QucmVtb3ZlKGkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGZvcihsZXQgaSBpbiB2YWx1ZSkgIHtcclxuICAgICAgICAgICAgICAgIGlmKHZhbHVlW2ldKSBub2RlLmNsYXNzTGlzdC5hZGQoaSk7XHJcbiAgICAgICAgICAgICAgICBlbHNlIG5vZGUuY2xhc3NMaXN0LnJlbW92ZShpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGVsc2UgaWYobmFtZSA9PT0gJ3N0eWxlJykge1xyXG4gICAgICAgIGlmKCF2YWx1ZSB8fCB0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnIHx8IHR5cGVvZiBvbGQgPT09ICdzdHJpbmcnKSB7XHJcbiAgICAgICAgICAgIG5vZGUuc3R5bGUuY3NzVGV4dCA9IHZhbHVlIHx8ICcnO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmKHZhbHVlICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcpIHtcclxuICAgICAgICAgICAgaWYodHlwZW9mIG9sZCA9PT0gJ29iamVjdCcpIHtcclxuICAgICAgICAgICAgICAgIGZvcihsZXQgaSBpbiBvbGQpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIShpIGluIHZhbHVlKSkgbm9kZS5zdHlsZVtpXSA9ICcnO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Ugbm9kZS5zdHlsZS5jc3NUZXh0ID0gJyc7XHJcbiAgICAgICAgICAgIGZvcihsZXQgaSBpbiB2YWx1ZSkgbm9kZS5zdHlsZVtpXSA9IHZhbHVlW2ldIHx8ICcnO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGVsc2UgaWYobmFtZVswXSA9PT0gJ28nICYmIG5hbWVbMV0gPT09ICduJykge1xyXG4gICAgICAgIGxldCB1c2VDYXB0dXJlID0gbmFtZSAhPT0gKG5hbWUgPSBuYW1lLnJlcGxhY2UoL0NhcHR1cmUkLywgJycpKTtcclxuICAgICAgICBuYW1lID0gbmFtZS50b0xvd2VyQ2FzZSgpLnN1YnN0cmluZygyKTtcclxuICAgICAgICBpZih2YWx1ZSkge1xyXG4gICAgICAgICAgICBpZighb2xkKSBub2RlLmFkZEV2ZW50TGlzdGVuZXIobmFtZSwgdmFsdWUsIHVzZUNhcHR1cmUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmKG9sZCkgbm9kZS5yZW1vdmVFdmVudExpc3RlbmVyKG5hbWUsIG9sZCwgdXNlQ2FwdHVyZSk7XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmKG5hbWUgIT09ICdsaXN0JyAmJiBuYW1lICE9PSAndHlwZScgJiYgbmFtZSBpbiBub2RlKSB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgbm9kZVtuYW1lXSA9IHZhbHVlID09IG51bGwgPyAnJyA6IHZhbHVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICBpZigodmFsdWUgPT0gbnVsbCB8fCB2YWx1ZSA9PT0gZmFsc2UpICYmIG5hbWUgIT09ICdzcGVsbGNoZWNrJykgbm9kZS5yZW1vdmVBdHRyaWJ1dGUobmFtZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgaWYodmFsdWUgPT0gbnVsbCB8fCB2YWx1ZSA9PT0gZmFsc2UpIG5vZGUucmVtb3ZlQXR0cmlidXRlKG5hbWUpO1xyXG4gICAgICAgIGVsc2UgaWYodHlwZW9mIHZhbHVlICE9PSAnZnVuY3Rpb24nKSBub2RlLnNldEF0dHJpYnV0ZShuYW1lLCB2YWx1ZSk7XHJcbiAgICB9XHJcbn0iLCIndXNlIHN0cmljdCc7XHJcblxyXG5pbXBvcnQgQ29tcG9uZW50LCB7IGJ1aWxkQ29tcG9uZW50IH0gZnJvbSAnLi4vY29tcG9uZW50JztcclxuaW1wb3J0IFZOb2RlIGZyb20gJy4vdm5vZGUnO1xyXG5pbXBvcnQge0FUVFJfS0VZfSBmcm9tICcuLi9jb25zdGFudHMnO1xyXG5pbXBvcnQge2NyZWF0ZU5vZGUsIHNldEFjY2Vzc29yLCBpc1NhbWVOb2RlVHlwZSwgcmVtb3ZlTm9kZX0gZnJvbSAnLi4vcmVhZGFwdC1kb20vaW5kZXgnO1xyXG5pbXBvcnQge3VubW91bnRDb21wb25lbnR9IGZyb20gJy4uL2NvbXBvbmVudCc7XHJcbmltcG9ydCB7RE9NfSBmcm9tICcuLi9yZWFkYXB0LWRvbS9pbmRleCc7XHJcblxyXG5leHBvcnQgY29uc3QgaW5wdXRzIDogYW55ID0gW1xyXG4gICAgJ2lucHV0JyxcclxuICAgICd0ZXh0YXJlYScsXHJcbiAgICAnc2VsZWN0JyxcclxuICAgICdtZXRlcicsXHJcbiAgICAncHJvZ3Jlc3MnLFxyXG4gICAgJ2J1dHRvbidcclxuXTtcclxuXHJcbmV4cG9ydCBsZXQgaHlkcmF0aW5nID0gZmFsc2U7XHJcbmV4cG9ydCBsZXQgZGlmZkxldmVsID0gMDtcclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkaWZmKGRvbTogYW55LCBub2RlOiBWTm9kZSwgcGFyZW50OiBhbnksIHJvb3Q6IGJvb2xlYW4pIHtcclxuICAgIGxldCByZXQgOiBhbnkgPSBudWxsO1xyXG4gICAgaWYoIWRpZmZMZXZlbCsrKSBoeWRyYXRpbmcgPSBkb20gJiYgIWRvbVtBVFRSX0tFWV07XHJcblxyXG4gICAgcmV0ID0gYXdhaXQgaWRpZmYoZG9tLCBub2RlLCBwYXJlbnQsIHJvb3QpO1xyXG4gICAgaWYocGFyZW50ICYmIHJldC5wYXJlbnROb2RlICE9PSBwYXJlbnQpIHBhcmVudC5hcHBlbmRDaGlsZChyZXQpO1xyXG5cclxuICAgIGlmKCEtLWRpZmZMZXZlbCkge1xyXG4gICAgICAgIGh5ZHJhdGluZyA9IGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiByZXQ7XHJcbn1cclxuXHJcbmFzeW5jIGZ1bmN0aW9uIGlkaWZmKGRvbTogYW55LCBub2RlOiBWTm9kZSwgcGFyZW50OiBhbnksIHJvb3Q6IGJvb2xlYW4pIHtcclxuICAgIGxldCBvdXQgOiBhbnkgPSBkb207XHJcbiAgICBpZihub2RlLm5vZGVWYWx1ZSA9PSBudWxsIHx8IHR5cGVvZiBub2RlLm5vZGVWYWx1ZSA9PT0gJ2Jvb2xlYW4nKSBub2RlLm5vZGVWYWx1ZSA9ICcnO1xyXG4gICAgaWYobm9kZS5ub2RlVHlwZSA9PT0gJ3RleHQnKSB7XHJcbiAgICAgICAgaWYoZG9tICYmIGRvbS5zcGxpdFRleHQgJiYgZG9tLnBhcmVudE5vZGUgJiYgKCFkb20uX2NvbXBvbmVudCB8fCByb290KSkge1xyXG4gICAgICAgICAgICBpZihkb20ubm9kZVZhbHVlICE9IG5vZGUubm9kZVZhbHVlKSBkb20ubm9kZVZhbHVlID0gbm9kZS5ub2RlVmFsdWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBvdXQgPSBET00uZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUobm9kZS5ub2RlVmFsdWUpO1xyXG4gICAgICAgICAgICBpZihkb20pIHtcclxuICAgICAgICAgICAgICAgIGlmKGRvbS5wYXJlbnROb2RlKSBkb20ucGFyZW50Tm9kZS5yZXBsYWNlQ2hpbGQob3V0LCBkb20pO1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgcmVjb2xsZWN0Tm9kZVRyZWUoZG9tLCBmYWxzZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIG91dFtBVFRSX0tFWV0gPSB7fTtcclxuICAgICAgICByZXR1cm4gb3V0O1xyXG4gICAgfVxyXG5cclxuICAgIGxldCBub2RlTmFtZSA6IGFueSA9IG5vZGUubm9kZU5hbWUsIG5yb290O1xyXG4gICAgaWYodHlwZW9mIG5vZGVOYW1lID09PSAnZnVuY3Rpb24nKSByZXR1cm4gYXdhaXQgYnVpbGRDb21wb25lbnQoZG9tLCBub2RlLCBwYXJlbnQpO1xyXG4gICAgaWYoIWRvbSB8fCBkb20ubm9kZU5hbWUudG9Mb3dlckNhc2UoKSAhPT0gbm9kZU5hbWUudG9Mb3dlckNhc2UoKSkge1xyXG4gICAgICAgIG91dCA9IGNyZWF0ZU5vZGUobm9kZU5hbWUpO1xyXG4gICAgICAgIGlmKGRvbSkge1xyXG4gICAgICAgICAgICB3aGlsZShkb20uZmlyc3RDaGlsZCkgb3V0LmFwcGVuZENoaWxkKGRvbS5maXJzdENoaWxkKTtcclxuICAgICAgICAgICAgaWYoZG9tLnBhcmVudE5vZGUpIGRvbS5wYXJlbnROb2RlLnJlcGxhY2VDaGlsZChvdXQsIGRvbSk7XHJcblxyXG4gICAgICAgICAgICAvL3JlY29sbGVjdFxyXG4gICAgICAgICAgICBhd2FpdCByZWNvbGxlY3ROb2RlVHJlZShkb20sIGZhbHNlKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBsZXQgcHJvcHMgOiBhbnkgPSBvdXRbQVRUUl9LRVldO1xyXG4gICAgaWYoIXByb3BzKSB7XHJcbiAgICAgICAgcHJvcHMgPSBvdXRbQVRUUl9LRVldID0ge307XHJcbiAgICAgICAgb3V0LmdldEF0dHJpYnV0ZU5hbWVzKCkuZm9yRWFjaChuID0+IHByb3BzW25dID0gb3V0LmdldEF0dHJpYnV0ZShuKSk7XHJcbiAgICB9XHJcblxyXG4gICAgbGV0IGZjID0gb3V0LmZpcnN0Q2hpbGQsIGNoaWxkcmVuID0gbm9kZS5jaGlsZE5vZGVzO1xyXG4gICAgaWYoKGNoaWxkcmVuICYmIGNoaWxkcmVuLmxlbmd0aCkgfHwgZmMpIGF3YWl0IGlubmVyRGlmZk5vZGUob3V0LCBjaGlsZHJlbiwgcm9vdCk7XHJcblxyXG4gICAgZGlmZkF0dHJpYnV0ZXMob3V0LCBub2RlLmF0dHJpYnV0ZXMsIHByb3BzKTtcclxuXHJcbiAgICByZXR1cm4gb3V0O1xyXG59XHJcblxyXG5hc3luYyBmdW5jdGlvbiBpbm5lckRpZmZOb2RlKGRvbSwgdmNoaWxkcmVuOiBBcnJheTxWTm9kZT4sIHJvb3Q6IGJvb2xlYW4pIHtcclxuXHRsZXQgb3JpZ2luYWxDaGlsZHJlbiA9IGRvbS5jaGlsZE5vZGVzLFxyXG5cdFx0Y2hpbGRyZW4gPSBBcnJheTxhbnk+KCksXHJcblx0XHRrZXllZCA9IHt9LFxyXG5cdFx0a2V5ZWRMZW4gPSAwLFxyXG5cdFx0bWluID0gMCxcclxuXHRcdGxlbiA9IG9yaWdpbmFsQ2hpbGRyZW4ubGVuZ3RoLFxyXG5cdFx0Y2hpbGRyZW5MZW4gPSAwLFxyXG5cdFx0dmxlbiA9IHZjaGlsZHJlbiA/IHZjaGlsZHJlbi5sZW5ndGggOiAwLFxyXG5cdFx0aiwgYywgZiwgdmNoaWxkLCBjaGlsZDtcclxuXHJcblx0Ly8gQnVpbGQgdXAgYSBtYXAgb2Yga2V5ZWQgY2hpbGRyZW4gYW5kIGFuIEFycmF5IG9mIHVua2V5ZWQgY2hpbGRyZW46XHJcblx0aWYgKGxlbiE9PTApIHtcclxuXHRcdGZvciAobGV0IGk9MDsgaTxsZW47IGkrKykge1xyXG5cdFx0XHRsZXQgY2hpbGQgPSBvcmlnaW5hbENoaWxkcmVuW2ldLFxyXG5cdFx0XHRcdHByb3BzID0gY2hpbGRbQVRUUl9LRVldLFxyXG5cdFx0XHRcdGtleSA9IHZsZW4gJiYgcHJvcHMgPyBjaGlsZC5fY29tcG9uZW50ID8gY2hpbGQuX2NvbXBvbmVudC5rZXkgOiBwcm9wcy5rZXkgOiBudWxsO1xyXG5cdFx0XHRpZiAoa2V5IT1udWxsKSB7XHJcblx0XHRcdFx0a2V5ZWRMZW4rKztcclxuXHRcdFx0XHRrZXllZFtrZXldID0gY2hpbGQ7XHJcblx0XHRcdH1cclxuXHRcdFx0ZWxzZSBpZiAocHJvcHMgfHwgKGNoaWxkLnNwbGl0VGV4dCE9PXVuZGVmaW5lZCA/IChoeWRyYXRpbmcgPyBjaGlsZC5ub2RlVmFsdWUudHJpbSgpIDogdHJ1ZSkgOiBoeWRyYXRpbmcpKSB7XHJcblx0XHRcdFx0Y2hpbGRyZW5bY2hpbGRyZW5MZW4rK10gPSBjaGlsZDtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0aWYgKHZsZW4hPT0wKSB7XHJcblx0XHRmb3IgKGxldCBpPTA7IGk8dmxlbjsgaSsrKSB7XHJcblx0XHRcdHZjaGlsZCA9IHZjaGlsZHJlbltpXTtcclxuXHRcdFx0Y2hpbGQgPSBudWxsO1xyXG5cclxuXHRcdFx0Ly8gYXR0ZW1wdCB0byBmaW5kIGEgbm9kZSBiYXNlZCBvbiBrZXkgbWF0Y2hpbmdcclxuXHRcdFx0bGV0IGtleSA9IHZjaGlsZC5rZXk7XHJcblx0XHRcdGlmIChrZXkhPW51bGwpIHtcclxuXHRcdFx0XHRpZiAoa2V5ZWRMZW4gJiYga2V5ZWRba2V5XSE9PXVuZGVmaW5lZCkge1xyXG5cdFx0XHRcdFx0Y2hpbGQgPSBrZXllZFtrZXldO1xyXG5cdFx0XHRcdFx0a2V5ZWRba2V5XSA9IHVuZGVmaW5lZDtcclxuXHRcdFx0XHRcdGtleWVkTGVuLS07XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHRcdC8vIGF0dGVtcHQgdG8gcGx1Y2sgYSBub2RlIG9mIHRoZSBzYW1lIHR5cGUgZnJvbSB0aGUgZXhpc3RpbmcgY2hpbGRyZW5cclxuXHRcdFx0ZWxzZSBpZiAobWluPGNoaWxkcmVuTGVuKSB7XHJcblx0XHRcdFx0Zm9yIChqPW1pbjsgajxjaGlsZHJlbkxlbjsgaisrKSB7XHJcblx0XHRcdFx0XHRpZiAoY2hpbGRyZW5bal0hPT11bmRlZmluZWQgJiYgaXNTYW1lTm9kZVR5cGUoYyA9IGNoaWxkcmVuW2pdLCB2Y2hpbGQsIGh5ZHJhdGluZykpIHtcclxuXHRcdFx0XHRcdFx0Y2hpbGQgPSBjO1xyXG5cdFx0XHRcdFx0XHRjaGlsZHJlbltqXSA9IHVuZGVmaW5lZDtcclxuXHRcdFx0XHRcdFx0aWYgKGo9PT1jaGlsZHJlbkxlbi0xKSBjaGlsZHJlbkxlbi0tO1xyXG5cdFx0XHRcdFx0XHRpZiAoaj09PW1pbikgbWluKys7XHJcblx0XHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0Ly8gbW9ycGggdGhlIG1hdGNoZWQvZm91bmQvY3JlYXRlZCBET00gY2hpbGQgdG8gbWF0Y2ggdmNoaWxkIChkZWVwKVxyXG5cdFx0XHRjaGlsZCA9IGF3YWl0IGlkaWZmKGNoaWxkLCB2Y2hpbGQsIGRvbSwgcm9vdCk7XHJcblxyXG5cdFx0XHRmID0gb3JpZ2luYWxDaGlsZHJlbltpXTtcclxuXHRcdFx0aWYgKGNoaWxkICYmIGNoaWxkIT09ZG9tICYmIGNoaWxkIT09Zikge1xyXG5cdFx0XHRcdGlmIChmPT1udWxsKSB7XHJcblx0XHRcdFx0XHRkb20uYXBwZW5kQ2hpbGQoY2hpbGQpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRlbHNlIGlmIChjaGlsZD09PWYubmV4dFNpYmxpbmcpIHtcclxuXHRcdFx0XHRcdHJlbW92ZU5vZGUoZik7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGVsc2Uge1xyXG5cdFx0XHRcdFx0ZG9tLmluc2VydEJlZm9yZShjaGlsZCwgZik7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHJcblx0Ly8gcmVtb3ZlIHVudXNlZCBrZXllZCBjaGlsZHJlbjpcclxuXHRpZiAoa2V5ZWRMZW4pIHtcclxuXHRcdGZvciAobGV0IGkgaW4ga2V5ZWQpIGlmIChrZXllZFtpXSE9PXVuZGVmaW5lZCkgYXdhaXQgcmVjb2xsZWN0Tm9kZVRyZWUoa2V5ZWRbaV0sIGZhbHNlKTtcclxuXHR9XHJcblxyXG5cdC8vIHJlbW92ZSBvcnBoYW5lZCB1bmtleWVkIGNoaWxkcmVuOlxyXG5cdHdoaWxlIChtaW48PWNoaWxkcmVuTGVuKSB7XHJcblx0XHRpZiAoKGNoaWxkID0gY2hpbGRyZW5bY2hpbGRyZW5MZW4tLV0pIT09dW5kZWZpbmVkKSBhd2FpdCByZWNvbGxlY3ROb2RlVHJlZShjaGlsZCwgZmFsc2UpO1xyXG5cdH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJlY29sbGVjdE5vZGVUcmVlKG5vZGU6IGFueSwgdW5tb3VudE9ubHk6IGJvb2xlYW4pIHtcclxuICAgIGlmKCFub2RlKSByZXR1cm47XHJcbiAgICBsZXQgY29tcG9uZW50ID0gbm9kZS5fY29tcG9uZW50O1xyXG4gICAgaWYoY29tcG9uZW50KSBhd2FpdCB1bm1vdW50Q29tcG9uZW50KGNvbXBvbmVudCk7XHJcbiAgICBpZihub2RlW0FUVFJfS0VZXSAmJiBub2RlW0FUVFJfS0VZXS5yZWYpIG5vZGVbQVRUUl9LRVldLnJlZihudWxsKTtcclxuICAgIGlmKHVubW91bnRPbmx5ID09PSBmYWxzZSB8fCBub2RlW0FUVFJfS0VZXSkgcmVtb3ZlTm9kZShub2RlKTtcclxuICAgIGF3YWl0IHJlbW92ZUNoaWxkcmVuKG5vZGUpO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcmVtb3ZlQ2hpbGRyZW4obm9kZTogYW55KSB7XHJcbiAgICBub2RlID0gbm9kZS5sYXN0Q2hpbGQ7XHJcbiAgICB3aGlsZShub2RlKSB7XHJcbiAgICAgICAgbGV0IG5leHQgPSBub2RlLnByZXZpb3VzU2libGluZztcclxuICAgICAgICBhd2FpdCByZWNvbGxlY3ROb2RlVHJlZShub2RlLCB0cnVlKTtcclxuICAgICAgICBub2RlID0gbmV4dDtcclxuICAgIH1cclxufVxyXG5cclxuZnVuY3Rpb24gZGlmZkF0dHJpYnV0ZXMoZG9tOiBhbnksIGF0dHJzOiBhbnksIG9sZDogYW55KSB7XHJcbiAgICBsZXQgbmFtZTtcclxuICAgIGZvcihuYW1lIGluIG9sZCkge1xyXG4gICAgICAgIGlmKCEoYXR0cnMgJiYgYXR0cnNbbmFtZV0gIT0gbnVsbCkgJiYgb2xkW25hbWVdICE9IG51bGwpIHNldEFjY2Vzc29yKGRvbSwgbmFtZSwgb2xkLCBvbGRbbmFtZV0gPSB1bmRlZmluZWQpO1xyXG4gICAgfVxyXG4gICAgZm9yKG5hbWUgaW4gYXR0cnMpIHtcclxuICAgICAgICBpZihuYW1lICE9PSAnY2hpbGRyZW4nICYmIG5hbWUgIT09ICdpbm5lckhUTUwnIFxyXG4gICAgICAgICAgICAmJiAoYXR0cnNbbmFtZV0gIT09ICgobmFtZSA9PT0gJ3ZhbHVlJyB8fCBuYW1lID09PSAnY2hlY2tlZCcpID8gZG9tW25hbWVdIDogb2xkW25hbWVdKSkpIHNldEFjY2Vzc29yKGRvbSwgbmFtZSwgb2xkW25hbWVdLCBvbGRbbmFtZV0gPSBhdHRyc1tuYW1lXSk7IFxyXG4gICAgfVxyXG59IiwiJ3VzZSBzdHJpY3QnO1xyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBWTm9kZSB7XHJcbiAgICBhdHRyaWJ1dGVzOiBhbnk7XHJcbiAgICBub2RlTmFtZTogYW55O1xyXG4gICAgbm9kZVR5cGU6IHN0cmluZztcclxuICAgIG5vZGVWYWx1ZTogYW55O1xyXG4gICAgY2hpbGROb2RlczogQXJyYXk8YW55PjtcclxuICAgIGtleTogYW55O1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKG5hbWU6IGFueSwgdHlwZTogc3RyaW5nLCB2OiBhbnkgKSB7XHJcbiAgICAgICAgdGhpcy5ub2RlTmFtZSA9IG5hbWU7XHJcbiAgICAgICAgdGhpcy5ub2RlVHlwZSA9IHR5cGU7XHJcbiAgICAgICAgdGhpcy5ub2RlVmFsdWUgPSB2O1xyXG4gICAgICAgIHRoaXMuY2hpbGROb2RlcyA9IEFycmF5PGFueT4oMCk7XHJcbiAgICB9XHJcbn0iLCIndXNlIHN0cmljdCc7XHJcblxyXG5pbXBvcnQgQ29tcG9uZW50LCB7IERFRkVSX1BST01JU0UsIHJlbmRlckNvbXBvbmVudCB9IGZyb20gJy4vY29tcG9uZW50JztcclxuaW1wb3J0IFZOb2RlIGZyb20gJy4vcmVhZGFwdC12ZG9tL3Zub2RlJztcclxuaW1wb3J0IHsgZGlmZiB9IGZyb20gJy4vcmVhZGFwdC12ZG9tL2RpZmYnO1xyXG5cclxubGV0IHJlbmRlclF1ZXVlID0gQXJyYXk8Q29tcG9uZW50PigwKTtcclxuZXhwb3J0IGZ1bmN0aW9uIGVucXVldWUoY29tcG9uZW50OiBDb21wb25lbnQpIHtcclxuICAgIHJlbmRlclF1ZXVlLnVuc2hpZnQoY29tcG9uZW50KTtcclxuICAgIChjb21wb25lbnQuYXN5bmNNZXRob2QgfHwgREVGRVJfUFJPTUlTRSkoYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgIGxldCBwLCBsaXN0ID0gcmVuZGVyUXVldWU7XHJcbiAgICAgICAgcmVuZGVyUXVldWUgPSBBcnJheTxDb21wb25lbnQ+KDApOyAgICAgICAgICAgXHJcbiAgICAgICAgd2hpbGUoKHAgPSBsaXN0LnBvcCgpKSkgYXdhaXQgcmVuZGVyQ29tcG9uZW50KHAsIHAucGFyZW50Tm9kZSk7XHJcbiAgICB9KTtcclxufVxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gaHlkcmF0ZShub2RlOiBWTm9kZSwgcGFyZW50OiBhbnkpIHtcclxuICAgIHJldHVybiBhd2FpdCByZW5kZXIobm9kZSwgcGFyZW50LCBwYXJlbnQuZmlyc3RFbGVtZW50Q2hpbGQpO1xyXG59XHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZW5kZXIobm9kZTogVk5vZGUsIHBhcmVudDogYW55LCBtZXJnZTogYW55KSB7XHJcbiAgICByZXR1cm4gYXdhaXQgZGlmZihtZXJnZSwgbm9kZSwgcGFyZW50LCB0cnVlKTtcclxufSJdLCJzb3VyY2VSb290IjoiIn0=