/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, { enumerable: true, get: getter });
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = function(exports) {
/******/ 		if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 			Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 		}
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// create a fake namespace object
/******/ 	// mode & 1: value is a module id, require it
/******/ 	// mode & 2: merge all properties of value into the ns
/******/ 	// mode & 4: return value when already ns object
/******/ 	// mode & 8|1: behave like require
/******/ 	__webpack_require__.t = function(value, mode) {
/******/ 		if(mode & 1) value = __webpack_require__(value);
/******/ 		if(mode & 8) return value;
/******/ 		if((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;
/******/ 		var ns = Object.create(null);
/******/ 		__webpack_require__.r(ns);
/******/ 		Object.defineProperty(ns, 'default', { enumerable: true, value: value });
/******/ 		if(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));
/******/ 		return ns;
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = "./src/client.js");
/******/ })
/************************************************************************/
/******/ ({

/***/ "./src/client.js":
/*!***********************!*\
  !*** ./src/client.js ***!
  \***********************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _h__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./h */ "./src/h.ts");
/* harmony import */ var _component__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./component */ "./src/component.ts");
/* harmony import */ var _readapt_dom_index__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./readapt-dom/index */ "./src/readapt-dom/index.ts");
/* harmony import */ var _render__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./render */ "./src/render.ts");





_readapt_dom_index__WEBPACK_IMPORTED_MODULE_2__["DOM"].document = document;
window.h = _h__WEBPACK_IMPORTED_MODULE_0__["h"];
window.Component = _component__WEBPACK_IMPORTED_MODULE_1__["default"];
window.Readapt = {
    render: _render__WEBPACK_IMPORTED_MODULE_3__["render"],
    hydrate: _render__WEBPACK_IMPORTED_MODULE_3__["hydrate"]
};
window.React = {
    createElement: _h__WEBPACK_IMPORTED_MODULE_0__["h"],
    render: _render__WEBPACK_IMPORTED_MODULE_3__["render"],
    hydrate: _render__WEBPACK_IMPORTED_MODULE_3__["hydrate"]
};


/***/ }),

/***/ "./src/component.ts":
/*!**************************!*\
  !*** ./src/component.ts ***!
  \**************************/
/*! exports provided: DEFER_PROMISE, DEFER_TIMEOUT, DEFER_ANIMATION, default, renderComponent, prepareRender, unmountComponent, buildComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DEFER_PROMISE", function() { return DEFER_PROMISE; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DEFER_TIMEOUT", function() { return DEFER_TIMEOUT; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DEFER_ANIMATION", function() { return DEFER_ANIMATION; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return Component; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "renderComponent", function() { return renderComponent; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "prepareRender", function() { return prepareRender; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "unmountComponent", function() { return unmountComponent; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "buildComponent", function() { return buildComponent; });
/* harmony import */ var _constants__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./constants */ "./src/constants.ts");
/* harmony import */ var _readapt_vdom_diff__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./readapt-vdom/diff */ "./src/readapt-vdom/diff.ts");
/* harmony import */ var _render__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./render */ "./src/render.ts");

var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};



const DEFER_PROMISE = Promise.resolve().then.bind(Promise.resolve());
const DEFER_TIMEOUT = setTimeout;
const DEFER_ANIMATION = typeof requestAnimationFrame !== 'undefined' ? requestAnimationFrame : DEFER_PROMISE;
class Component {
    constructor(props, parent, renderMode) {
        this.disabled = false;
        this.key = props.key;
        this.ref = props.ref;
        this.asyncMethod = DEFER_PROMISE;
        this.renderMode = renderMode || _constants__WEBPACK_IMPORTED_MODULE_0__["SYNC"];
        this.child = null;
        this.base = null;
        this.parent = parent;
        this.parentNode = null;
        this.children = [];
        this.state = {};
        this.__props = props;
        delete props.ref;
        delete props.key;
        this.observe(props);
    }
    componentChange(key, value, previous) {
        return __awaiter(this, void 0, void 0, function* () {
            if (this.shouldComponentUpdate(key, value, previous)) {
                if (this.renderMode === _constants__WEBPACK_IMPORTED_MODULE_0__["SYNC"])
                    yield renderComponent(this, this.parentNode, false);
                else if (this.renderMode === _constants__WEBPACK_IMPORTED_MODULE_0__["ASYNC"])
                    Object(_render__WEBPACK_IMPORTED_MODULE_2__["enqueue"])(this);
            }
        });
    }
    forceUpdate() {
        return __awaiter(this, void 0, void 0, function* () {
            yield renderComponent(this, this.parentNode, false);
        });
    }
    componentDidUpdate(previous) {
        return __awaiter(this, void 0, void 0, function* () {
        });
    }
    render() {
        return __awaiter(this, void 0, void 0, function* () {
        });
    }
    componentWillUnmount() {
        return __awaiter(this, void 0, void 0, function* () {
        });
    }
    componentDidMount() {
        return __awaiter(this, void 0, void 0, function* () {
        });
    }
    setState(sm) {
        return __awaiter(this, void 0, void 0, function* () {
            const update = new Promise((r, rj) => __awaiter(this, void 0, void 0, function* () {
                //immutable from original state
                const oldState = Object(_constants__WEBPACK_IMPORTED_MODULE_0__["extend"])({}, this.state);
                const finalState = Object(_constants__WEBPACK_IMPORTED_MODULE_0__["extend"])({}, this.state);
                let newState = {};
                if (typeof sm === 'function') {
                    //copy current props for immutable
                    const props = {};
                    if (this.__props) {
                        for (let k in this.__props)
                            props[k] = this[k];
                    }
                    //immutable from original state
                    newState = sm(Object(_constants__WEBPACK_IMPORTED_MODULE_0__["extend"])(newState, this.state), props) || newState;
                    Object(_constants__WEBPACK_IMPORTED_MODULE_0__["extend"])(finalState, newState);
                }
                else if (typeof sm === 'object')
                    Object(_constants__WEBPACK_IMPORTED_MODULE_0__["extend"])(finalState, sm);
                this.state = finalState;
                for (let k in finalState) {
                    if (oldState[k] !== finalState[k])
                        yield this.componentChange(k, newState[k], oldState[k]);
                }
                r();
            }));
            if (this.renderMode === _constants__WEBPACK_IMPORTED_MODULE_0__["SYNC"])
                yield update;
            else if (this.renderMode === _constants__WEBPACK_IMPORTED_MODULE_0__["ASYNC"])
                Object(_render__WEBPACK_IMPORTED_MODULE_2__["enqueueState"])(this, update);
        });
    }
    shouldComponentUpdate(key, value, previous) {
        return true;
    }
    observe(o) {
        for (let k in o) {
            let v = o[k];
            if (typeof v === 'function') {
                this[k] = v;
                continue;
            }
            Object.defineProperty(this, `\$${k}`, { value: v, writable: true, enumerable: false });
            Object.defineProperty(this, k, {
                enumerable: true,
                get() {
                    return this[`\$${k}`];
                },
                set(nv) {
                    const prev = this[`\$${k}`];
                    this[`\$${k}`] = nv;
                    if (!this.disabled && prev !== nv) {
                        this.componentChange(k, nv, prev);
                    }
                }
            });
        }
    }
}
function renderComponent(component, parentNode, hydrating) {
    return __awaiter(this, void 0, void 0, function* () {
        let isUpdate = component.base, p, props, rendered, toUnmount, cbase, inst, base, type;
        if (component.disabled)
            return;
        rendered = yield component.render();
        if (!rendered || Array.isArray(rendered)) {
            if (component.child) {
                yield unmountComponent(component.child);
                component.child = null;
            }
            if (component.base) {
                component.base._component = null;
                yield Object(_readapt_vdom_diff__WEBPACK_IMPORTED_MODULE_1__["recollectNodeTree"])(component.base, false);
                component.base = null;
            }
            return;
        }
        component.parentNode = parentNode;
        cbase = base = component.base;
        if (typeof rendered.nodeName === 'function') {
            props = rendered.attributes;
            inst = component.child;
            if (inst && inst.constructor === rendered.nodeName) {
                const update = prepareRender(inst, props, rendered.childNodes);
                if (update._different) {
                    yield renderComponent(inst, inst.parentNode, hydrating);
                    yield inst.componentDidUpdate(update);
                }
            }
            else {
                toUnmount = inst;
                type = rendered.nodeName;
                if (cbase && !toUnmount && !hydrating) {
                    cbase._component = null;
                    yield Object(_readapt_vdom_diff__WEBPACK_IMPORTED_MODULE_1__["recollectNodeTree"])(cbase, false);
                }
                component.child = inst = new type(props, component);
                if (hydrating)
                    inst.base = cbase;
                inst.children = rendered.childNodes;
                if (inst.ref)
                    inst.ref(inst);
                yield renderComponent(inst, component.parentNode, hydrating);
            }
            base = inst.base;
        }
        if (typeof rendered.nodeName !== 'function') {
            toUnmount = component.child;
            if (toUnmount)
                cbase = component.child = null;
            base = yield Object(_readapt_vdom_diff__WEBPACK_IMPORTED_MODULE_1__["diff"])(cbase, rendered, component.parentNode, true);
        }
        if (cbase && base !== cbase && inst !== component.child) {
            p = cbase.parentNode;
            if (p && base !== p) {
                p.replaceChild(base, cbase);
                if (!toUnmount) {
                    cbase._component = null;
                    yield Object(_readapt_vdom_diff__WEBPACK_IMPORTED_MODULE_1__["recollectNodeTree"])(cbase, false);
                }
            }
        }
        if (toUnmount)
            yield unmountComponent(toUnmount);
        component.base = base;
        if (base && !component.child) {
            let cmp = component, t = component;
            while ((t = t.parent)) {
                (cmp = t).base = base;
            }
            base._component = cmp;
        }
        if (!isUpdate) {
            yield component.componentDidMount();
        }
    });
}
function prepareRender(inst, props, children) {
    let diff = { _different: false };
    if (inst.ref)
        inst.ref(inst);
    inst.children = children;
    inst.disabled = true;
    for (let n in props) {
        if (inst[n] !== props[n]) {
            diff[n] = inst[n];
            diff._different = true;
        }
        inst[n] = props[n];
    }
    inst.disabled = false;
    return diff;
}
function unmountComponent(component) {
    return __awaiter(this, void 0, void 0, function* () {
        const base = component.base;
        component.disabled = true;
        yield component.componentWillUnmount();
        if (component.child)
            yield unmountComponent(component.child);
        component.base = null;
        component.parent = null;
        component.child = null;
        if (base) {
            base._component = null;
            if (base[_constants__WEBPACK_IMPORTED_MODULE_0__["ATTR_KEY"]] && base[_constants__WEBPACK_IMPORTED_MODULE_0__["ATTR_KEY"]].ref)
                base[_constants__WEBPACK_IMPORTED_MODULE_0__["ATTR_KEY"]].ref(null);
            yield Object(_readapt_vdom_diff__WEBPACK_IMPORTED_MODULE_1__["recollectNodeTree"])(base, false);
        }
        if (component.ref)
            component.ref(null);
    });
}
function buildComponent(dom, node, parentNode, hydrating) {
    return __awaiter(this, void 0, void 0, function* () {
        let c = dom && dom._component, isDirectOwner = c && c.constructor === node.nodeName, props = node.attributes, type = node.nodeName;
        if (isDirectOwner && c) {
            const update = prepareRender(c, props, node.childNodes);
            if (update._different) {
                yield renderComponent(c, parentNode, hydrating);
                yield c.componentDidUpdate(update);
            }
            dom = c.base;
        }
        else {
            if (!hydrating)
                yield Object(_readapt_vdom_diff__WEBPACK_IMPORTED_MODULE_1__["recollectNodeTree"])(dom, false);
            c = new type(props, null);
            c.children = node.childNodes;
            if (hydrating)
                c.base = dom;
            if (c.ref)
                c.ref(c);
            yield renderComponent(c, parentNode, hydrating);
            dom = c.base;
        }
        return dom;
    });
}


/***/ }),

/***/ "./src/constants.ts":
/*!**************************!*\
  !*** ./src/constants.ts ***!
  \**************************/
/*! exports provided: ATTR_KEY, ASYNC, SYNC, NONE, FORCE, extend */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ATTR_KEY", function() { return ATTR_KEY; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ASYNC", function() { return ASYNC; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SYNC", function() { return SYNC; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "NONE", function() { return NONE; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FORCE", function() { return FORCE; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "extend", function() { return extend; });

const ATTR_KEY = '__readapt__';
const ASYNC = 3;
const SYNC = 1;
const NONE = 0;
const FORCE = 2;
function extend(base, ref) {
    for (let k in ref)
        base[k] = ref[k];
    return base;
}
;


/***/ }),

/***/ "./src/h.ts":
/*!******************!*\
  !*** ./src/h.ts ***!
  \******************/
/*! exports provided: h */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "h", function() { return h; });
/* harmony import */ var _readapt_vdom_vnode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./readapt-vdom/vnode */ "./src/readapt-vdom/vnode.ts");


function h(nodeName, attributes, ...children) {
    attributes = attributes || {};
    const stack = Array(0);
    let child, p = new _readapt_vdom_vnode__WEBPACK_IMPORTED_MODULE_0__["default"](nodeName, typeof nodeName === 'function' ? 'component' : 'element', '');
    children.forEach(c => stack.unshift(c));
    if (attributes && attributes.children != null) {
        if (!stack.length)
            stack.push(attributes.children);
        delete attributes.children;
    }
    while (stack.length) {
        child = stack.pop();
        if (Array.isArray(child))
            child.forEach(c => stack.unshift(c));
        else {
            if (child instanceof _readapt_vdom_vnode__WEBPACK_IMPORTED_MODULE_0__["default"])
                p.childNodes.push(child);
            else
                p.childNodes.push(new _readapt_vdom_vnode__WEBPACK_IMPORTED_MODULE_0__["default"]('#text', 'text', child));
        }
    }
    p.attributes = attributes;
    p.key = attributes.key ? attributes.key : undefined;
    return p;
}
;


/***/ }),

/***/ "./src/readapt-dom/index.ts":
/*!**********************************!*\
  !*** ./src/readapt-dom/index.ts ***!
  \**********************************/
/*! exports provided: DOM, createNode, removeNode, isSameNodeType, setAccessor */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DOM", function() { return DOM; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "createNode", function() { return createNode; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "removeNode", function() { return removeNode; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "isSameNodeType", function() { return isSameNodeType; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "setAccessor", function() { return setAccessor; });

const DOM = {
    document: null
};
function createNode(nodeName) {
    return DOM.document.createElement(nodeName);
}
function removeNode(node) {
    const parentNode = node.parentNode;
    if (parentNode)
        parentNode.removeChild(node);
}
function isSameNodeType(node, vnode, hydrating) {
    if (!node)
        return false;
    if (vnode.nodeType === 'text')
        return node.splitText;
    if (typeof vnode.nodeName === 'string')
        return !node._component && node.nodeName.toLowerCase() === vnode.nodeName.toLowerCase();
    return hydrating || (node._component && node._component.constructor === vnode.nodeName);
}
function setAccessor(node, name, old, value) {
    if (name === 'className')
        name = 'class';
    if (name === '__html')
        name = 'html';
    if (name === 'key') {
        //do nothing
    }
    else if (name === 'ref') {
        if (old)
            old(null);
        if (value)
            value(node);
    }
    //please for the love of god
    //never use this unless you really have to
    //for showing mark down or something similar
    else if (name === 'html') {
        if (old !== value) {
            node.innerHTML = value;
        }
    }
    else if (name === 'class') {
        if (!value || typeof value === 'string') {
            node.className = value || '';
        }
        else if (value && typeof value === 'object') {
            if (typeof old === 'object') {
                for (let i in old) {
                    if (!(i in value))
                        node.classList.remove(i);
                }
            }
            for (let i in value) {
                if (value[i])
                    node.classList.add(i);
                else
                    node.classList.remove(i);
            }
        }
    }
    else if (name === 'style') {
        if (value && typeof value === 'object') {
            if (typeof old === 'object') {
                for (let i in old) {
                    if (!(i in value))
                        node.style[i] = '';
                }
            }
            else
                node.style.cssText = '';
            for (let i in value)
                node.style[i] = value[i] || '';
        }
        else if (!value || typeof value === 'string' || typeof old === 'string') {
            node.style.cssText = value || '';
        }
    }
    else if (name[0] === 'o' && name[1] === 'n') {
        let useCapture = name !== (name = name.replace(/Capture$/, ''));
        name = name.toLowerCase().substring(2);
        if (value) {
            if (!old)
                node.addEventListener(name, value, useCapture);
        }
        else if (old)
            node.removeEventListener(name, old, useCapture);
    }
    else if (name !== 'list' && name !== 'type' && name in node) {
        try {
            node[name] = value == null ? '' : value;
        }
        catch (e) {
            if ((value == null || value === false) && name !== 'spellcheck')
                node.removeAttribute(name);
        }
    }
    else {
        if (value == null || value === false)
            node.removeAttribute(name);
        else if (typeof value !== 'function')
            node.setAttribute(name, value);
    }
}


/***/ }),

/***/ "./src/readapt-vdom/diff.ts":
/*!**********************************!*\
  !*** ./src/readapt-vdom/diff.ts ***!
  \**********************************/
/*! exports provided: inputs, hydrating, diffLevel, diff, recollectNodeTree, removeChildren */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "inputs", function() { return inputs; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "hydrating", function() { return hydrating; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "diffLevel", function() { return diffLevel; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "diff", function() { return diff; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "recollectNodeTree", function() { return recollectNodeTree; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "removeChildren", function() { return removeChildren; });
/* harmony import */ var _component__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../component */ "./src/component.ts");
/* harmony import */ var _constants__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../constants */ "./src/constants.ts");
/* harmony import */ var _readapt_dom_index__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../readapt-dom/index */ "./src/readapt-dom/index.ts");

var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};





const inputs = [
    'input',
    'textarea',
    'select',
    'meter',
    'progress',
    'button'
];
let hydrating = false;
let diffLevel = 0;
function diff(dom, node, parent, root) {
    return __awaiter(this, void 0, void 0, function* () {
        let ret = null;
        if (!diffLevel++)
            hydrating = dom && !dom[_constants__WEBPACK_IMPORTED_MODULE_1__["ATTR_KEY"]];
        ret = yield idiff(dom, node, parent, root);
        if (parent && ret.parentNode !== parent)
            parent.appendChild(ret);
        if (!--diffLevel) {
            hydrating = false;
        }
        return ret;
    });
}
function idiff(dom, node, parent, root) {
    return __awaiter(this, void 0, void 0, function* () {
        let out = dom;
        if (node.nodeValue == null || typeof node.nodeValue === 'boolean')
            node.nodeValue = '';
        if (node.nodeType === 'text') {
            if (dom && dom.splitText && dom.parentNode && (!dom._component || root)) {
                if (dom.nodeValue != node.nodeValue)
                    dom.nodeValue = node.nodeValue;
            }
            else {
                out = _readapt_dom_index__WEBPACK_IMPORTED_MODULE_2__["DOM"].document.createTextNode(node.nodeValue);
                if (dom) {
                    if (dom.parentNode)
                        dom.parentNode.replaceChild(out, dom);
                    yield recollectNodeTree(dom, false);
                }
            }
            out[_constants__WEBPACK_IMPORTED_MODULE_1__["ATTR_KEY"]] = {};
            return out;
        }
        let nodeName = node.nodeName, nroot;
        if (typeof nodeName === 'function')
            return yield Object(_component__WEBPACK_IMPORTED_MODULE_0__["buildComponent"])(dom, node, parent, hydrating);
        if (!dom || dom.nodeName.toLowerCase() !== nodeName.toLowerCase()) {
            out = Object(_readapt_dom_index__WEBPACK_IMPORTED_MODULE_2__["createNode"])(nodeName);
            if (dom) {
                while (dom.firstChild)
                    out.appendChild(dom.firstChild);
                if (dom.parentNode)
                    dom.parentNode.replaceChild(out, dom);
                //recollect
                yield recollectNodeTree(dom, false);
            }
        }
        let props = out[_constants__WEBPACK_IMPORTED_MODULE_1__["ATTR_KEY"]];
        if (!props) {
            props = out[_constants__WEBPACK_IMPORTED_MODULE_1__["ATTR_KEY"]] = {};
            out.getAttributeNames().forEach(n => props[n] = out.getAttribute(n));
        }
        let fc = out.firstChild, children = node.childNodes;
        if ((children && children.length) || fc)
            yield innerDiffNode(out, children, root);
        diffAttributes(out, node.attributes, props);
        return out;
    });
}
function innerDiffNode(dom, vchildren, root) {
    return __awaiter(this, void 0, void 0, function* () {
        let originalChildren = dom.childNodes, children = Array(), keyed = {}, keyedLen = 0, min = 0, len = originalChildren.length, childrenLen = 0, vlen = vchildren ? vchildren.length : 0, j, c, f, vchild, child;
        // Build up a map of keyed children and an Array of unkeyed children:
        if (len !== 0) {
            for (let i = 0; i < len; i++) {
                let child = originalChildren[i], props = child[_constants__WEBPACK_IMPORTED_MODULE_1__["ATTR_KEY"]], key = vlen && props ? child._component ? child._component.key : props.key : null;
                if (key != null) {
                    keyedLen++;
                    keyed[key] = child;
                }
                else if (props || (child.splitText !== undefined ? (hydrating ? child.nodeValue.trim() : true) : hydrating)) {
                    children[childrenLen++] = child;
                }
            }
        }
        if (vlen !== 0) {
            for (let i = 0; i < vlen; i++) {
                vchild = vchildren[i];
                child = null;
                // attempt to find a node based on key matching
                let key = vchild.key;
                if (key != null) {
                    if (keyedLen && keyed[key] !== undefined) {
                        child = keyed[key];
                        keyed[key] = undefined;
                        keyedLen--;
                    }
                }
                // attempt to pluck a node of the same type from the existing children
                else if (min < childrenLen) {
                    for (j = min; j < childrenLen; j++) {
                        if (children[j] !== undefined && Object(_readapt_dom_index__WEBPACK_IMPORTED_MODULE_2__["isSameNodeType"])(c = children[j], vchild, hydrating)) {
                            child = c;
                            children[j] = undefined;
                            if (j === childrenLen - 1)
                                childrenLen--;
                            if (j === min)
                                min++;
                            break;
                        }
                    }
                }
                // morph the matched/found/created DOM child to match vchild (deep)
                child = yield idiff(child, vchild, dom, root);
                f = originalChildren[i];
                if (child && child !== dom && child !== f) {
                    if (f == null) {
                        dom.appendChild(child);
                    }
                    else if (child === f.nextSibling) {
                        Object(_readapt_dom_index__WEBPACK_IMPORTED_MODULE_2__["removeNode"])(f);
                    }
                    else {
                        dom.insertBefore(child, f);
                    }
                }
            }
        }
        // remove unused keyed children:
        if (keyedLen) {
            for (let i in keyed)
                if (keyed[i] !== undefined)
                    yield recollectNodeTree(keyed[i], false);
        }
        // remove orphaned unkeyed children:
        while (min <= childrenLen) {
            if ((child = children[childrenLen--]) !== undefined)
                yield recollectNodeTree(child, false);
        }
    });
}
function recollectNodeTree(node, unmountOnly) {
    return __awaiter(this, void 0, void 0, function* () {
        if (!node)
            return;
        let component = node._component;
        if (component)
            yield Object(_component__WEBPACK_IMPORTED_MODULE_0__["unmountComponent"])(component);
        if (node[_constants__WEBPACK_IMPORTED_MODULE_1__["ATTR_KEY"]] && node[_constants__WEBPACK_IMPORTED_MODULE_1__["ATTR_KEY"]].ref)
            node[_constants__WEBPACK_IMPORTED_MODULE_1__["ATTR_KEY"]].ref(null);
        if (unmountOnly === false || node[_constants__WEBPACK_IMPORTED_MODULE_1__["ATTR_KEY"]])
            Object(_readapt_dom_index__WEBPACK_IMPORTED_MODULE_2__["removeNode"])(node);
        yield removeChildren(node);
    });
}
function removeChildren(node) {
    return __awaiter(this, void 0, void 0, function* () {
        node = node.lastChild;
        while (node) {
            let next = node.previousSibling;
            yield recollectNodeTree(node, true);
            node = next;
        }
    });
}
function diffAttributes(dom, attrs, old) {
    let name;
    for (name in old) {
        if (!(attrs && attrs[name] != null) && old[name] != null)
            Object(_readapt_dom_index__WEBPACK_IMPORTED_MODULE_2__["setAccessor"])(dom, name, old, old[name] = undefined);
    }
    for (name in attrs) {
        if (name !== 'children' && name !== 'innerHTML'
            && (attrs[name] !== ((name === 'value' || name === 'checked') ? dom[name] : old[name])))
            Object(_readapt_dom_index__WEBPACK_IMPORTED_MODULE_2__["setAccessor"])(dom, name, old[name], old[name] = attrs[name]);
    }
}


/***/ }),

/***/ "./src/readapt-vdom/vnode.ts":
/*!***********************************!*\
  !*** ./src/readapt-vdom/vnode.ts ***!
  \***********************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return VNode; });

class VNode {
    constructor(name, type, v) {
        this.nodeName = name;
        this.nodeType = type;
        this.nodeValue = v;
        this.childNodes = Array(0);
    }
}


/***/ }),

/***/ "./src/render.ts":
/*!***********************!*\
  !*** ./src/render.ts ***!
  \***********************/
/*! exports provided: enqueue, enqueueState, hydrate, render */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "enqueue", function() { return enqueue; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "enqueueState", function() { return enqueueState; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "hydrate", function() { return hydrate; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "render", function() { return render; });
/* harmony import */ var _component__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./component */ "./src/component.ts");
/* harmony import */ var _readapt_vdom_diff__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./readapt-vdom/diff */ "./src/readapt-vdom/diff.ts");

var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};


function enqueue(component) {
    (component.asyncMethod || _component__WEBPACK_IMPORTED_MODULE_0__["DEFER_PROMISE"])(() => __awaiter(this, void 0, void 0, function* () {
        yield Object(_component__WEBPACK_IMPORTED_MODULE_0__["renderComponent"])(component, component.parentNode, false);
    }));
}
function enqueueState(component, state) {
    (component.asyncMethod || _component__WEBPACK_IMPORTED_MODULE_0__["DEFER_PROMISE"])(() => __awaiter(this, void 0, void 0, function* () {
        yield state;
    }));
}
function hydrate(node, parent) {
    return __awaiter(this, void 0, void 0, function* () {
        return yield render(node, parent, parent.firstElementChild);
    });
}
function render(node, parent, merge) {
    return __awaiter(this, void 0, void 0, function* () {
        return yield Object(_readapt_vdom_diff__WEBPACK_IMPORTED_MODULE_1__["diff"])(merge, node, parent, true);
    });
}


/***/ })

/******/ });
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NsaWVudC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50LnRzIiwid2VicGFjazovLy8uL3NyYy9jb25zdGFudHMudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2gudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3JlYWRhcHQtZG9tL2luZGV4LnRzIiwid2VicGFjazovLy8uL3NyYy9yZWFkYXB0LXZkb20vZGlmZi50cyIsIndlYnBhY2s6Ly8vLi9zcmMvcmVhZGFwdC12ZG9tL3Zub2RlLnRzIiwid2VicGFjazovLy8uL3NyYy9yZW5kZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtRQUFBO1FBQ0E7O1FBRUE7UUFDQTs7UUFFQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTs7UUFFQTtRQUNBOztRQUVBO1FBQ0E7O1FBRUE7UUFDQTtRQUNBOzs7UUFHQTtRQUNBOztRQUVBO1FBQ0E7O1FBRUE7UUFDQTtRQUNBO1FBQ0EsMENBQTBDLGdDQUFnQztRQUMxRTtRQUNBOztRQUVBO1FBQ0E7UUFDQTtRQUNBLHdEQUF3RCxrQkFBa0I7UUFDMUU7UUFDQSxpREFBaUQsY0FBYztRQUMvRDs7UUFFQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0EseUNBQXlDLGlDQUFpQztRQUMxRSxnSEFBZ0gsbUJBQW1CLEVBQUU7UUFDckk7UUFDQTs7UUFFQTtRQUNBO1FBQ0E7UUFDQSwyQkFBMkIsMEJBQTBCLEVBQUU7UUFDdkQsaUNBQWlDLGVBQWU7UUFDaEQ7UUFDQTtRQUNBOztRQUVBO1FBQ0Esc0RBQXNELCtEQUErRDs7UUFFckg7UUFDQTs7O1FBR0E7UUFDQTs7Ozs7Ozs7Ozs7OztBQ2xGQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQWE7QUFDNkI7QUFDTjtBQUNJO0FBQ0M7QUFFekMsc0RBQUcsQ0FBQyxRQUFRLEdBQUcsUUFBUSxDQUFDO0FBQ3hCLE1BQU0sQ0FBQyxDQUFDLEdBQUcsb0NBQUMsQ0FBQztBQUNiLE1BQU0sQ0FBQyxTQUFTLEdBQUcsa0RBQVMsQ0FBQztBQUM3QixNQUFNLENBQUMsT0FBTyxHQUFHO0lBQ2IsTUFBTSxFQUFFLDhDQUFNO0lBQ2QsT0FBTyxFQUFFLCtDQUFPO0NBQ25CLENBQUM7QUFDRixNQUFNLENBQUMsS0FBSyxHQUFHO0lBQ1gsYUFBYSxFQUFFLG9DQUFhO0lBQzVCLE1BQU0sRUFBRSw4Q0FBTTtJQUNkLE9BQU8sRUFBRSwrQ0FBTztDQUNuQixDQUFDOzs7Ozs7Ozs7Ozs7O0FDakJGO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFhOzs7Ozs7Ozs7QUFHK0M7QUFDRTtBQUViO0FBRTFDLE1BQU0sYUFBYSxHQUFHLE9BQU8sQ0FBQyxPQUFPLEVBQUUsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxPQUFPLEVBQUUsQ0FBQyxDQUFDO0FBQ3JFLE1BQU0sYUFBYSxHQUFHLFVBQVUsQ0FBQztBQUNqQyxNQUFNLGVBQWUsR0FBRyxPQUFPLHFCQUFxQixLQUFLLFdBQVcsQ0FBQyxDQUFDLENBQUMscUJBQXFCLENBQUMsQ0FBQyxDQUFDLGFBQWEsQ0FBQztBQUVyRztJQWVYLFlBQVksS0FBVSxFQUFFLE1BQWlCLEVBQUUsVUFBZTtRQUN0RCxJQUFJLENBQUMsUUFBUSxHQUFHLEtBQUssQ0FBQztRQUN0QixJQUFJLENBQUMsR0FBRyxHQUFHLEtBQUssQ0FBQyxHQUFHLENBQUM7UUFDckIsSUFBSSxDQUFDLEdBQUcsR0FBRyxLQUFLLENBQUMsR0FBRyxDQUFDO1FBQ3JCLElBQUksQ0FBQyxXQUFXLEdBQUcsYUFBYSxDQUFDO1FBQ2pDLElBQUksQ0FBQyxVQUFVLEdBQUcsVUFBVSxJQUFJLCtDQUFJLENBQUM7UUFDckMsSUFBSSxDQUFDLEtBQUssR0FBRyxJQUFJLENBQUM7UUFDbEIsSUFBSSxDQUFDLElBQUksR0FBRyxJQUFJLENBQUM7UUFDakIsSUFBSSxDQUFDLE1BQU0sR0FBRyxNQUFNLENBQUM7UUFDckIsSUFBSSxDQUFDLFVBQVUsR0FBRyxJQUFJLENBQUM7UUFDdkIsSUFBSSxDQUFDLFFBQVEsR0FBRyxFQUFFLENBQUM7UUFDbkIsSUFBSSxDQUFDLEtBQUssR0FBRyxFQUFFLENBQUM7UUFDaEIsSUFBSSxDQUFDLE9BQU8sR0FBRyxLQUFLLENBQUM7UUFFckIsT0FBTyxLQUFLLENBQUMsR0FBRyxDQUFDO1FBQ2pCLE9BQU8sS0FBSyxDQUFDLEdBQUcsQ0FBQztRQUVqQixJQUFJLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxDQUFDO0lBQ3hCLENBQUM7SUFFZSxlQUFlLENBQUMsR0FBVyxFQUFFLEtBQVUsRUFBRSxRQUFhOztZQUNsRSxJQUFHLElBQUksQ0FBQyxxQkFBcUIsQ0FBQyxHQUFHLEVBQUMsS0FBSyxFQUFDLFFBQVEsQ0FBQyxFQUFFO2dCQUMvQyxJQUFHLElBQUksQ0FBQyxVQUFVLEtBQUssK0NBQUk7b0JBQUUsTUFBTSxlQUFlLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQyxVQUFVLEVBQUUsS0FBSyxDQUFDLENBQUM7cUJBQzVFLElBQUcsSUFBSSxDQUFDLFVBQVUsS0FBSyxnREFBSztvQkFBRSx1REFBTyxDQUFDLElBQUksQ0FBQyxDQUFDO2FBQ3BEO1FBQ0wsQ0FBQztLQUFBO0lBRUssV0FBVzs7WUFDYixNQUFNLGVBQWUsQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLFVBQVUsRUFBRSxLQUFLLENBQUMsQ0FBQztRQUN4RCxDQUFDO0tBQUE7SUFFSyxrQkFBa0IsQ0FBQyxRQUFROztRQUVqQyxDQUFDO0tBQUE7SUFFSyxNQUFNOztRQUVaLENBQUM7S0FBQTtJQUVLLG9CQUFvQjs7UUFFMUIsQ0FBQztLQUFBO0lBRUssaUJBQWlCOztRQUV2QixDQUFDO0tBQUE7SUFFZSxRQUFRLENBQUMsRUFBTzs7WUFDNUIsTUFBTSxNQUFNLEdBQUcsSUFBSSxPQUFPLENBQUMsQ0FBTyxDQUFDLEVBQUMsRUFBRSxFQUFFLEVBQUU7Z0JBQ3RDLCtCQUErQjtnQkFDL0IsTUFBTSxRQUFRLEdBQUcseURBQU0sQ0FBQyxFQUFFLEVBQUUsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO2dCQUN4QyxNQUFNLFVBQVUsR0FBRyx5REFBTSxDQUFDLEVBQUUsRUFBRSxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7Z0JBQzFDLElBQUksUUFBUSxHQUFZLEVBQUUsQ0FBQztnQkFDM0IsSUFBSSxPQUFPLEVBQUUsS0FBSyxVQUFVLEVBQUU7b0JBQzFCLGtDQUFrQztvQkFDbEMsTUFBTSxLQUFLLEdBQUcsRUFBRSxDQUFDO29CQUNqQixJQUFJLElBQUksQ0FBQyxPQUFPLEVBQUU7d0JBQ2QsS0FBSSxJQUFJLENBQUMsSUFBSSxJQUFJLENBQUMsT0FBTzs0QkFBRSxLQUFLLENBQUMsQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO3FCQUNqRDtvQkFDRCwrQkFBK0I7b0JBQy9CLFFBQVEsR0FBRyxFQUFFLENBQUMseURBQU0sQ0FBQyxRQUFRLEVBQUUsSUFBSSxDQUFDLEtBQUssQ0FBQyxFQUFFLEtBQUssQ0FBQyxJQUFJLFFBQVEsQ0FBQztvQkFDL0QseURBQU0sQ0FBQyxVQUFVLEVBQUUsUUFBUSxDQUFDLENBQUM7aUJBQ2hDO3FCQUNJLElBQUcsT0FBTyxFQUFFLEtBQUssUUFBUTtvQkFBRSx5REFBTSxDQUFDLFVBQVUsRUFBRSxFQUFFLENBQUMsQ0FBQztnQkFFdkQsSUFBSSxDQUFDLEtBQUssR0FBRyxVQUFVLENBQUM7Z0JBRXhCLEtBQUksSUFBSSxDQUFDLElBQUksVUFBVSxFQUFFO29CQUNyQixJQUFHLFFBQVEsQ0FBQyxDQUFDLENBQUMsS0FBSyxVQUFVLENBQUMsQ0FBQyxDQUFDO3dCQUFFLE1BQU0sSUFBSSxDQUFDLGVBQWUsQ0FBQyxDQUFDLEVBQUUsUUFBUSxDQUFDLENBQUMsQ0FBQyxFQUFFLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO2lCQUM3RjtnQkFDRCxDQUFDLEVBQUUsQ0FBQztZQUNSLENBQUMsRUFBQyxDQUFDO1lBQ0gsSUFBSSxJQUFJLENBQUMsVUFBVSxLQUFLLCtDQUFJO2dCQUFFLE1BQU0sTUFBTSxDQUFDO2lCQUN0QyxJQUFHLElBQUksQ0FBQyxVQUFVLEtBQUssZ0RBQUs7Z0JBQUUsNERBQVksQ0FBQyxJQUFJLEVBQUUsTUFBTSxDQUFDLENBQUM7UUFDbEUsQ0FBQztLQUFBO0lBRVMscUJBQXFCLENBQUMsR0FBVyxFQUFFLEtBQVUsRUFBRSxRQUFhO1FBQ2xFLE9BQU8sSUFBSSxDQUFDO0lBQ2hCLENBQUM7SUFFUyxPQUFPLENBQUMsQ0FBUztRQUN2QixLQUFJLElBQUksQ0FBQyxJQUFJLENBQUMsRUFBRTtZQUNaLElBQUksQ0FBQyxHQUFTLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUVuQixJQUFHLE9BQU8sQ0FBQyxLQUFLLFVBQVUsRUFBRTtnQkFDeEIsSUFBSSxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQztnQkFDWixTQUFTO2FBQ1o7WUFFRCxNQUFNLENBQUMsY0FBYyxDQUFDLElBQUksRUFBRSxLQUFLLENBQUMsRUFBRSxFQUFFLEVBQUMsS0FBSyxFQUFFLENBQUMsRUFBRSxRQUFRLEVBQUUsSUFBSSxFQUFFLFVBQVUsRUFBRSxLQUFLLEVBQUUsQ0FBQyxDQUFDO1lBRXRGLE1BQU0sQ0FBQyxjQUFjLENBQUMsSUFBSSxFQUFFLENBQUMsRUFBRTtnQkFDM0IsVUFBVSxFQUFFLElBQUk7Z0JBQ2hCLEdBQUc7b0JBQ0MsT0FBTyxJQUFJLENBQUMsS0FBSyxDQUFDLEVBQUUsQ0FBQyxDQUFDO2dCQUMxQixDQUFDO2dCQUNELEdBQUcsQ0FBQyxFQUFPO29CQUNQLE1BQU0sSUFBSSxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsRUFBRSxDQUFDLENBQUM7b0JBQzVCLElBQUksQ0FBQyxLQUFLLENBQUMsRUFBRSxDQUFDLEdBQUcsRUFBRSxDQUFDO29CQUVwQixJQUFHLENBQUMsSUFBSSxDQUFDLFFBQVEsSUFBSSxJQUFJLEtBQUssRUFBRSxFQUFFO3dCQUM5QixJQUFJLENBQUMsZUFBZSxDQUFDLENBQUMsRUFBQyxFQUFFLEVBQUMsSUFBSSxDQUFDLENBQUM7cUJBQ25DO2dCQUNMLENBQUM7YUFDSixDQUFDLENBQUM7U0FDTjtJQUNMLENBQUM7Q0FDSjtBQUVNLHlCQUErQixTQUFvQixFQUFFLFVBQWUsRUFBRSxTQUFrQjs7UUFDM0YsSUFBSSxRQUFRLEdBQUcsU0FBUyxDQUFDLElBQUksRUFBRSxDQUFDLEVBQUUsS0FBSyxFQUFFLFFBQVEsRUFBRSxTQUFTLEVBQUUsS0FBSyxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxDQUFDO1FBQ3RGLElBQUcsU0FBUyxDQUFDLFFBQVE7WUFBRSxPQUFPO1FBRTlCLFFBQVEsR0FBRyxNQUFNLFNBQVMsQ0FBQyxNQUFNLEVBQUUsQ0FBQztRQUVwQyxJQUFHLENBQUMsUUFBUSxJQUFJLEtBQUssQ0FBQyxPQUFPLENBQUMsUUFBUSxDQUFDLEVBQUU7WUFDckMsSUFBRyxTQUFTLENBQUMsS0FBSyxFQUFFO2dCQUNoQixNQUFNLGdCQUFnQixDQUFDLFNBQVMsQ0FBQyxLQUFLLENBQUMsQ0FBQztnQkFDeEMsU0FBUyxDQUFDLEtBQUssR0FBRyxJQUFJLENBQUM7YUFDMUI7WUFDRCxJQUFHLFNBQVMsQ0FBQyxJQUFJLEVBQUU7Z0JBQ2YsU0FBUyxDQUFDLElBQUksQ0FBQyxVQUFVLEdBQUcsSUFBSSxDQUFDO2dCQUNqQyxNQUFNLDRFQUFpQixDQUFDLFNBQVMsQ0FBQyxJQUFJLEVBQUUsS0FBSyxDQUFDLENBQUM7Z0JBQy9DLFNBQVMsQ0FBQyxJQUFJLEdBQUcsSUFBSSxDQUFDO2FBQ3pCO1lBQ0QsT0FBTztTQUNWO1FBRUQsU0FBUyxDQUFDLFVBQVUsR0FBRyxVQUFVLENBQUM7UUFDbEMsS0FBSyxHQUFHLElBQUksR0FBRyxTQUFTLENBQUMsSUFBSSxDQUFDO1FBRTlCLElBQUcsT0FBTyxRQUFRLENBQUMsUUFBUSxLQUFLLFVBQVUsRUFBRTtZQUN4QyxLQUFLLEdBQUcsUUFBUSxDQUFDLFVBQVUsQ0FBQztZQUM1QixJQUFJLEdBQUcsU0FBUyxDQUFDLEtBQUssQ0FBQztZQUN2QixJQUFHLElBQUksSUFBSSxJQUFJLENBQUMsV0FBVyxLQUFLLFFBQVEsQ0FBQyxRQUFRLEVBQUU7Z0JBQy9DLE1BQU0sTUFBTSxHQUFHLGFBQWEsQ0FBQyxJQUFJLEVBQUUsS0FBSyxFQUFFLFFBQVEsQ0FBQyxVQUFVLENBQUMsQ0FBQztnQkFDL0QsSUFBRyxNQUFNLENBQUMsVUFBVSxFQUFFO29CQUNsQixNQUFNLGVBQWUsQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLFVBQVUsRUFBRSxTQUFTLENBQUMsQ0FBQztvQkFDeEQsTUFBTSxJQUFJLENBQUMsa0JBQWtCLENBQUMsTUFBTSxDQUFDLENBQUM7aUJBQ3pDO2FBQ0o7aUJBQ0k7Z0JBQ0QsU0FBUyxHQUFHLElBQUksQ0FBQztnQkFBQyxJQUFJLEdBQUcsUUFBUSxDQUFDLFFBQVEsQ0FBQztnQkFFM0MsSUFBRyxLQUFLLElBQUksQ0FBQyxTQUFTLElBQUksQ0FBQyxTQUFTLEVBQUU7b0JBQ2xDLEtBQUssQ0FBQyxVQUFVLEdBQUcsSUFBSSxDQUFDO29CQUN4QixNQUFNLDRFQUFpQixDQUFDLEtBQUssRUFBRSxLQUFLLENBQUMsQ0FBQztpQkFDekM7Z0JBRUQsU0FBUyxDQUFDLEtBQUssR0FBRyxJQUFJLEdBQUcsSUFBSSxJQUFJLENBQUMsS0FBSyxFQUFFLFNBQVMsQ0FBQyxDQUFDO2dCQUNwRCxJQUFJLFNBQVM7b0JBQUUsSUFBSSxDQUFDLElBQUksR0FBRyxLQUFLLENBQUM7Z0JBQ2pDLElBQUksQ0FBQyxRQUFRLEdBQUcsUUFBUSxDQUFDLFVBQVUsQ0FBQztnQkFDcEMsSUFBRyxJQUFJLENBQUMsR0FBRztvQkFBRSxJQUFJLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxDQUFDO2dCQUM1QixNQUFNLGVBQWUsQ0FBQyxJQUFJLEVBQUUsU0FBUyxDQUFDLFVBQVUsRUFBRSxTQUFTLENBQUMsQ0FBQzthQUNoRTtZQUVELElBQUksR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDO1NBQ3BCO1FBQ0QsSUFBRyxPQUFPLFFBQVEsQ0FBQyxRQUFRLEtBQUssVUFBVSxFQUFFO1lBQ3hDLFNBQVMsR0FBRyxTQUFTLENBQUMsS0FBSyxDQUFDO1lBQzVCLElBQUcsU0FBUztnQkFBRSxLQUFLLEdBQUcsU0FBUyxDQUFDLEtBQUssR0FBRyxJQUFJLENBQUM7WUFDN0MsSUFBSSxHQUFHLE1BQU0sK0RBQUksQ0FBQyxLQUFLLEVBQUUsUUFBUSxFQUFFLFNBQVMsQ0FBQyxVQUFVLEVBQUUsSUFBSSxDQUFDLENBQUM7U0FDbEU7UUFFRCxJQUFHLEtBQUssSUFBSSxJQUFJLEtBQUssS0FBSyxJQUFJLElBQUksS0FBSyxTQUFTLENBQUMsS0FBSyxFQUFFO1lBQ3BELENBQUMsR0FBRyxLQUFLLENBQUMsVUFBVSxDQUFDO1lBQ3JCLElBQUcsQ0FBQyxJQUFJLElBQUksS0FBSyxDQUFDLEVBQUU7Z0JBQ2hCLENBQUMsQ0FBQyxZQUFZLENBQUMsSUFBSSxFQUFFLEtBQUssQ0FBQyxDQUFDO2dCQUU1QixJQUFHLENBQUMsU0FBUyxFQUFFO29CQUNYLEtBQUssQ0FBQyxVQUFVLEdBQUcsSUFBSSxDQUFDO29CQUN4QixNQUFNLDRFQUFpQixDQUFDLEtBQUssRUFBRSxLQUFLLENBQUMsQ0FBQztpQkFDekM7YUFDSjtTQUNKO1FBRUQsSUFBRyxTQUFTO1lBQUUsTUFBTSxnQkFBZ0IsQ0FBQyxTQUFTLENBQUMsQ0FBQztRQUVoRCxTQUFTLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQztRQUN0QixJQUFHLElBQUksSUFBSSxDQUFDLFNBQVMsQ0FBQyxLQUFLLEVBQUU7WUFDekIsSUFBSSxHQUFHLEdBQUcsU0FBUyxFQUFFLENBQUMsR0FBRyxTQUFTLENBQUM7WUFFbkMsT0FBTSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsTUFBTSxDQUFDLEVBQUU7Z0JBQ2xCLENBQUMsR0FBRyxHQUFHLENBQUMsQ0FBQyxDQUFDLElBQUksR0FBRyxJQUFJLENBQUM7YUFDekI7WUFFRCxJQUFJLENBQUMsVUFBVSxHQUFHLEdBQUcsQ0FBQztTQUN6QjtRQUNELElBQUcsQ0FBQyxRQUFRLEVBQUU7WUFDVixNQUFNLFNBQVMsQ0FBQyxpQkFBaUIsRUFBRSxDQUFDO1NBQ3ZDO0lBQ0wsQ0FBQztDQUFBO0FBRU0sdUJBQXVCLElBQWUsRUFBRSxLQUFVLEVBQUUsUUFBb0I7SUFDM0UsSUFBSSxJQUFJLEdBQUcsRUFBQyxVQUFVLEVBQUUsS0FBSyxFQUFDLENBQUM7SUFDL0IsSUFBRyxJQUFJLENBQUMsR0FBRztRQUFFLElBQUksQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDNUIsSUFBSSxDQUFDLFFBQVEsR0FBRyxRQUFRLENBQUM7SUFFekIsSUFBSSxDQUFDLFFBQVEsR0FBRyxJQUFJLENBQUM7SUFDckIsS0FBSSxJQUFJLENBQUMsSUFBSSxLQUFLLEVBQUU7UUFDdEIsSUFBRyxJQUFJLENBQUMsQ0FBQyxDQUFDLEtBQUssS0FBSyxDQUFDLENBQUMsQ0FBQyxFQUFFO1lBQ3hCLElBQUksQ0FBQyxDQUFDLENBQUMsR0FBRyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDbEIsSUFBSSxDQUFDLFVBQVUsR0FBRyxJQUFJLENBQUM7U0FDdkI7UUFDRCxJQUFJLENBQUMsQ0FBQyxDQUFDLEdBQUcsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDO0tBQ2hCO0lBQ0QsSUFBSSxDQUFDLFFBQVEsR0FBRyxLQUFLLENBQUM7SUFFdEIsT0FBTyxJQUFJLENBQUM7QUFDaEIsQ0FBQztBQUVNLDBCQUFnQyxTQUFvQjs7UUFDdkQsTUFBTSxJQUFJLEdBQUcsU0FBUyxDQUFDLElBQUksQ0FBQztRQUM1QixTQUFTLENBQUMsUUFBUSxHQUFHLElBQUksQ0FBQztRQUMxQixNQUFNLFNBQVMsQ0FBQyxvQkFBb0IsRUFBRSxDQUFDO1FBQ3ZDLElBQUcsU0FBUyxDQUFDLEtBQUs7WUFBRSxNQUFNLGdCQUFnQixDQUFDLFNBQVMsQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUM1RCxTQUFTLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQztRQUN0QixTQUFTLENBQUMsTUFBTSxHQUFHLElBQUksQ0FBQztRQUN4QixTQUFTLENBQUMsS0FBSyxHQUFHLElBQUksQ0FBQztRQUN2QixJQUFHLElBQUksRUFBRTtZQUNMLElBQUksQ0FBQyxVQUFVLEdBQUcsSUFBSSxDQUFDO1lBQ3ZCLElBQUcsSUFBSSxDQUFDLG1EQUFRLENBQUMsSUFBSSxJQUFJLENBQUMsbURBQVEsQ0FBQyxDQUFDLEdBQUc7Z0JBQUUsSUFBSSxDQUFDLG1EQUFRLENBQUMsQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLENBQUM7WUFFbEUsTUFBTSw0RUFBaUIsQ0FBQyxJQUFJLEVBQUUsS0FBSyxDQUFDLENBQUM7U0FDeEM7UUFDRCxJQUFHLFNBQVMsQ0FBQyxHQUFHO1lBQUUsU0FBUyxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUMxQyxDQUFDO0NBQUE7QUFFTSx3QkFBOEIsR0FBUSxFQUFFLElBQVcsRUFBRSxVQUFlLEVBQUUsU0FBa0I7O1FBQzNGLElBQUksQ0FBQyxHQUFHLEdBQUcsSUFBSSxHQUFHLENBQUMsVUFBVSxFQUN6QixhQUFhLEdBQUcsQ0FBQyxJQUFJLENBQUMsQ0FBQyxXQUFXLEtBQUssSUFBSSxDQUFDLFFBQVEsRUFDcEQsS0FBSyxHQUFHLElBQUksQ0FBQyxVQUFVLEVBQ3ZCLElBQUksR0FBRyxJQUFJLENBQUMsUUFBUSxDQUFDO1FBRXpCLElBQUcsYUFBYSxJQUFJLENBQUMsRUFBRTtZQUNuQixNQUFNLE1BQU0sR0FBRyxhQUFhLENBQUMsQ0FBQyxFQUFFLEtBQUssRUFBRSxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUM7WUFDeEQsSUFBRyxNQUFNLENBQUMsVUFBVSxFQUFFO2dCQUNsQixNQUFNLGVBQWUsQ0FBQyxDQUFDLEVBQUUsVUFBVSxFQUFFLFNBQVMsQ0FBQyxDQUFDO2dCQUNoRCxNQUFNLENBQUMsQ0FBQyxrQkFBa0IsQ0FBQyxNQUFNLENBQUMsQ0FBQzthQUN0QztZQUNELEdBQUcsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDO1NBQ2hCO2FBQ0k7WUFDRCxJQUFHLENBQUMsU0FBUztnQkFBRSxNQUFNLDRFQUFpQixDQUFDLEdBQUcsRUFBRSxLQUFLLENBQUMsQ0FBQztZQUNuRCxDQUFDLEdBQUcsSUFBSSxJQUFJLENBQUMsS0FBSyxFQUFFLElBQUksQ0FBQyxDQUFDO1lBQzFCLENBQUMsQ0FBQyxRQUFRLEdBQUcsSUFBSSxDQUFDLFVBQVUsQ0FBQztZQUM3QixJQUFJLFNBQVM7Z0JBQUUsQ0FBQyxDQUFDLElBQUksR0FBRyxHQUFHLENBQUM7WUFDNUIsSUFBRyxDQUFDLENBQUMsR0FBRztnQkFBRSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQ25CLE1BQU0sZUFBZSxDQUFDLENBQUMsRUFBRSxVQUFVLEVBQUUsU0FBUyxDQUFDLENBQUM7WUFDaEQsR0FBRyxHQUFHLENBQUMsQ0FBQyxJQUFJLENBQUM7U0FDaEI7UUFFRCxPQUFPLEdBQUcsQ0FBQztJQUNmLENBQUM7Q0FBQTs7Ozs7Ozs7Ozs7OztBQ3hSRDtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFhO0FBRU4sTUFBTSxRQUFRLEdBQUcsYUFBYSxDQUFDO0FBQy9CLE1BQU0sS0FBSyxHQUFHLENBQUMsQ0FBQztBQUNoQixNQUFNLElBQUksR0FBRyxDQUFDLENBQUM7QUFDZixNQUFNLElBQUksR0FBRyxDQUFDLENBQUM7QUFDZixNQUFNLEtBQUssR0FBRyxDQUFDLENBQUM7QUFFaEIsZ0JBQWdCLElBQVksRUFBRSxHQUFXO0lBQzVDLEtBQUksSUFBSSxDQUFDLElBQUksR0FBRztRQUFFLElBQUksQ0FBQyxDQUFDLENBQUMsR0FBRyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFDbkMsT0FBTyxJQUFJLENBQUM7QUFDaEIsQ0FBQztBQUFBLENBQUM7Ozs7Ozs7Ozs7Ozs7QUNYRjtBQUFBO0FBQUE7QUFBYTtBQUU0QjtBQUdsQyxXQUFXLFFBQTRCLEVBQUUsVUFBZSxFQUFFLEdBQUcsUUFBUTtJQUN4RSxVQUFVLEdBQUcsVUFBVSxJQUFJLEVBQUUsQ0FBQztJQUM5QixNQUFNLEtBQUssR0FBRyxLQUFLLENBQU0sQ0FBQyxDQUFDLENBQUM7SUFDNUIsSUFBSSxLQUFLLEVBQUUsQ0FBQyxHQUFHLElBQUksMkRBQUssQ0FBQyxRQUFRLEVBQUUsT0FBTyxRQUFRLEtBQUssVUFBVSxDQUFDLENBQUMsQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUFDLFNBQVMsRUFBRSxFQUFFLENBQUMsQ0FBQztJQUVqRyxRQUFRLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQ3hDLElBQUcsVUFBVSxJQUFJLFVBQVUsQ0FBQyxRQUFRLElBQUksSUFBSSxFQUFFO1FBQzFDLElBQUcsQ0FBQyxLQUFLLENBQUMsTUFBTTtZQUFFLEtBQUssQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1FBQ2xELE9BQU8sVUFBVSxDQUFDLFFBQVEsQ0FBQztLQUM5QjtJQUVELE9BQU0sS0FBSyxDQUFDLE1BQU0sRUFBRTtRQUNoQixLQUFLLEdBQUcsS0FBSyxDQUFDLEdBQUcsRUFBRSxDQUFDO1FBQ3BCLElBQUcsS0FBSyxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUM7WUFBRSxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO2FBQ3pEO1lBQ0QsSUFBRyxLQUFLLFlBQVksMkRBQUs7Z0JBQUUsQ0FBQyxDQUFDLFVBQVUsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7O2dCQUMvQyxDQUFDLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQyxJQUFJLDJEQUFLLENBQUMsT0FBTyxFQUFFLE1BQU0sRUFBRSxLQUFLLENBQUMsQ0FBQyxDQUFDO1NBQzdEO0tBQ0o7SUFFRCxDQUFDLENBQUMsVUFBVSxHQUFHLFVBQVUsQ0FBQztJQUMxQixDQUFDLENBQUMsR0FBRyxHQUFHLFVBQVUsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLFVBQVUsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLFNBQVMsQ0FBQztJQUVwRCxPQUFPLENBQUMsQ0FBQztBQUNiLENBQUM7QUFBQSxDQUFDOzs7Ozs7Ozs7Ozs7O0FDN0JGO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFhO0FBRU4sTUFBTSxHQUFHLEdBQVM7SUFDckIsUUFBUSxFQUFFLElBQUk7Q0FDakIsQ0FBQztBQUVLLG9CQUFvQixRQUFnQjtJQUN2QyxPQUFPLEdBQUcsQ0FBQyxRQUFRLENBQUMsYUFBYSxDQUFDLFFBQVEsQ0FBQyxDQUFDO0FBQ2hELENBQUM7QUFFTSxvQkFBb0IsSUFBSTtJQUMzQixNQUFNLFVBQVUsR0FBRyxJQUFJLENBQUMsVUFBVSxDQUFDO0lBQ25DLElBQUksVUFBVTtRQUFFLFVBQVUsQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDLENBQUM7QUFDakQsQ0FBQztBQUVNLHdCQUF3QixJQUFTLEVBQUUsS0FBVSxFQUFFLFNBQWtCO0lBQ3BFLElBQUcsQ0FBQyxJQUFJO1FBQUUsT0FBTyxLQUFLLENBQUM7SUFDdkIsSUFBRyxLQUFLLENBQUMsUUFBUSxLQUFLLE1BQU07UUFBRSxPQUFPLElBQUksQ0FBQyxTQUFTLENBQUM7SUFDcEQsSUFBRyxPQUFPLEtBQUssQ0FBQyxRQUFRLEtBQUssUUFBUTtRQUFFLE9BQU8sQ0FBQyxJQUFJLENBQUMsVUFBVSxJQUFJLElBQUksQ0FBQyxRQUFRLENBQUMsV0FBVyxFQUFFLEtBQUssS0FBSyxDQUFDLFFBQVEsQ0FBQyxXQUFXLEVBQUUsQ0FBQztJQUUvSCxPQUFPLFNBQVMsSUFBSSxDQUFDLElBQUksQ0FBQyxVQUFVLElBQUksSUFBSSxDQUFDLFVBQVUsQ0FBQyxXQUFXLEtBQUssS0FBSyxDQUFDLFFBQVEsQ0FBQyxDQUFDO0FBQzVGLENBQUM7QUFFTSxxQkFBcUIsSUFBSSxFQUFFLElBQUksRUFBRSxHQUFHLEVBQUUsS0FBSztJQUM5QyxJQUFHLElBQUksS0FBSyxXQUFXO1FBQUUsSUFBSSxHQUFHLE9BQU8sQ0FBQztJQUN4QyxJQUFHLElBQUksS0FBSyxRQUFRO1FBQUUsSUFBSSxHQUFHLE1BQU0sQ0FBQztJQUNwQyxJQUFHLElBQUksS0FBSyxLQUFLLEVBQUU7UUFDZixZQUFZO0tBQ2Y7U0FDSSxJQUFHLElBQUksS0FBSyxLQUFLLEVBQUU7UUFDcEIsSUFBRyxHQUFHO1lBQUUsR0FBRyxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQ2xCLElBQUcsS0FBSztZQUFFLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQztLQUN6QjtJQUNELDRCQUE0QjtJQUM1QiwwQ0FBMEM7SUFDMUMsNENBQTRDO1NBQ3ZDLElBQUcsSUFBSSxLQUFLLE1BQU0sRUFBRTtRQUNyQixJQUFHLEdBQUcsS0FBSyxLQUFLLEVBQUU7WUFDZCxJQUFJLENBQUMsU0FBUyxHQUFHLEtBQUssQ0FBQztTQUMxQjtLQUNKO1NBQ0ksSUFBRyxJQUFJLEtBQUssT0FBTyxFQUFFO1FBQ3RCLElBQUcsQ0FBQyxLQUFLLElBQUksT0FBTyxLQUFLLEtBQUssUUFBUSxFQUFFO1lBQ3BDLElBQUksQ0FBQyxTQUFTLEdBQUcsS0FBSyxJQUFJLEVBQUUsQ0FBQztTQUNoQzthQUNJLElBQUcsS0FBSyxJQUFJLE9BQU8sS0FBSyxLQUFLLFFBQVEsRUFBRTtZQUN4QyxJQUFHLE9BQU8sR0FBRyxLQUFLLFFBQVEsRUFBRTtnQkFDeEIsS0FBSSxJQUFJLENBQUMsSUFBSSxHQUFHLEVBQUU7b0JBQ2QsSUFBSSxDQUFDLENBQUMsQ0FBQyxJQUFJLEtBQUssQ0FBQzt3QkFBRSxJQUFJLENBQUMsU0FBUyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQztpQkFDL0M7YUFDSjtZQUNELEtBQUksSUFBSSxDQUFDLElBQUksS0FBSyxFQUFHO2dCQUNqQixJQUFHLEtBQUssQ0FBQyxDQUFDLENBQUM7b0JBQUUsSUFBSSxDQUFDLFNBQVMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUM7O29CQUM5QixJQUFJLENBQUMsU0FBUyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQzthQUNqQztTQUNKO0tBQ0o7U0FDSSxJQUFHLElBQUksS0FBSyxPQUFPLEVBQUU7UUFDdEIsSUFBRyxLQUFLLElBQUksT0FBTyxLQUFLLEtBQUssUUFBUSxFQUFFO1lBQ25DLElBQUcsT0FBTyxHQUFHLEtBQUssUUFBUSxFQUFFO2dCQUN4QixLQUFJLElBQUksQ0FBQyxJQUFJLEdBQUcsRUFBRTtvQkFDZCxJQUFJLENBQUMsQ0FBQyxDQUFDLElBQUksS0FBSyxDQUFDO3dCQUFFLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLEdBQUcsRUFBRSxDQUFDO2lCQUN6QzthQUNKOztnQkFDSSxJQUFJLENBQUMsS0FBSyxDQUFDLE9BQU8sR0FBRyxFQUFFLENBQUM7WUFDN0IsS0FBSSxJQUFJLENBQUMsSUFBSSxLQUFLO2dCQUFFLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLEdBQUcsS0FBSyxDQUFDLENBQUMsQ0FBQyxJQUFJLEVBQUUsQ0FBQztTQUN0RDthQUNJLElBQUcsQ0FBQyxLQUFLLElBQUksT0FBTyxLQUFLLEtBQUssUUFBUSxJQUFJLE9BQU8sR0FBRyxLQUFLLFFBQVEsRUFBRTtZQUNwRSxJQUFJLENBQUMsS0FBSyxDQUFDLE9BQU8sR0FBRyxLQUFLLElBQUksRUFBRSxDQUFDO1NBQ3BDO0tBQ0o7U0FDSSxJQUFHLElBQUksQ0FBQyxDQUFDLENBQUMsS0FBSyxHQUFHLElBQUksSUFBSSxDQUFDLENBQUMsQ0FBQyxLQUFLLEdBQUcsRUFBRTtRQUN4QyxJQUFJLFVBQVUsR0FBRyxJQUFJLEtBQUssQ0FBQyxJQUFJLEdBQUcsSUFBSSxDQUFDLE9BQU8sQ0FBQyxVQUFVLEVBQUUsRUFBRSxDQUFDLENBQUMsQ0FBQztRQUNoRSxJQUFJLEdBQUcsSUFBSSxDQUFDLFdBQVcsRUFBRSxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUN2QyxJQUFHLEtBQUssRUFBRTtZQUNOLElBQUcsQ0FBQyxHQUFHO2dCQUFFLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxJQUFJLEVBQUUsS0FBSyxFQUFFLFVBQVUsQ0FBQyxDQUFDO1NBQzNEO2FBQ0ksSUFBRyxHQUFHO1lBQUUsSUFBSSxDQUFDLG1CQUFtQixDQUFDLElBQUksRUFBRSxHQUFHLEVBQUUsVUFBVSxDQUFDLENBQUM7S0FDaEU7U0FDSSxJQUFHLElBQUksS0FBSyxNQUFNLElBQUksSUFBSSxLQUFLLE1BQU0sSUFBSSxJQUFJLElBQUksSUFBSSxFQUFFO1FBQ3hELElBQUk7WUFDQSxJQUFJLENBQUMsSUFBSSxDQUFDLEdBQUcsS0FBSyxJQUFJLElBQUksQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUM7U0FDM0M7UUFDRCxPQUFPLENBQUMsRUFBRTtZQUNOLElBQUcsQ0FBQyxLQUFLLElBQUksSUFBSSxJQUFJLEtBQUssS0FBSyxLQUFLLENBQUMsSUFBSSxJQUFJLEtBQUssWUFBWTtnQkFBRSxJQUFJLENBQUMsZUFBZSxDQUFDLElBQUksQ0FBQyxDQUFDO1NBQzlGO0tBQ0o7U0FDSTtRQUNELElBQUcsS0FBSyxJQUFJLElBQUksSUFBSSxLQUFLLEtBQUssS0FBSztZQUFFLElBQUksQ0FBQyxlQUFlLENBQUMsSUFBSSxDQUFDLENBQUM7YUFDM0QsSUFBRyxPQUFPLEtBQUssS0FBSyxVQUFVO1lBQUUsSUFBSSxDQUFDLFlBQVksQ0FBQyxJQUFJLEVBQUUsS0FBSyxDQUFDLENBQUM7S0FDdkU7QUFDTCxDQUFDOzs7Ozs7Ozs7Ozs7O0FDM0ZEO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQWE7Ozs7Ozs7OztBQUU0QztBQUVuQjtBQUNtRDtBQUMzQztBQUNMO0FBRWxDLE1BQU0sTUFBTSxHQUFTO0lBQ3hCLE9BQU87SUFDUCxVQUFVO0lBQ1YsUUFBUTtJQUNSLE9BQU87SUFDUCxVQUFVO0lBQ1YsUUFBUTtDQUNYLENBQUM7QUFFSyxJQUFJLFNBQVMsR0FBRyxLQUFLLENBQUM7QUFDdEIsSUFBSSxTQUFTLEdBQUcsQ0FBQyxDQUFDO0FBRWxCLGNBQW9CLEdBQVEsRUFBRSxJQUFXLEVBQUUsTUFBVyxFQUFFLElBQWE7O1FBQ3hFLElBQUksR0FBRyxHQUFTLElBQUksQ0FBQztRQUNyQixJQUFHLENBQUMsU0FBUyxFQUFFO1lBQUUsU0FBUyxHQUFHLEdBQUcsSUFBSSxDQUFDLEdBQUcsQ0FBQyxtREFBUSxDQUFDLENBQUM7UUFFbkQsR0FBRyxHQUFHLE1BQU0sS0FBSyxDQUFDLEdBQUcsRUFBRSxJQUFJLEVBQUUsTUFBTSxFQUFFLElBQUksQ0FBQyxDQUFDO1FBQzNDLElBQUcsTUFBTSxJQUFJLEdBQUcsQ0FBQyxVQUFVLEtBQUssTUFBTTtZQUFFLE1BQU0sQ0FBQyxXQUFXLENBQUMsR0FBRyxDQUFDLENBQUM7UUFFaEUsSUFBRyxDQUFDLEVBQUUsU0FBUyxFQUFFO1lBQ2IsU0FBUyxHQUFHLEtBQUssQ0FBQztTQUNyQjtRQUVELE9BQU8sR0FBRyxDQUFDO0lBQ2YsQ0FBQztDQUFBO0FBRUQsZUFBcUIsR0FBUSxFQUFFLElBQVcsRUFBRSxNQUFXLEVBQUUsSUFBYTs7UUFDbEUsSUFBSSxHQUFHLEdBQVMsR0FBRyxDQUFDO1FBQ3BCLElBQUcsSUFBSSxDQUFDLFNBQVMsSUFBSSxJQUFJLElBQUksT0FBTyxJQUFJLENBQUMsU0FBUyxLQUFLLFNBQVM7WUFBRSxJQUFJLENBQUMsU0FBUyxHQUFHLEVBQUUsQ0FBQztRQUN0RixJQUFHLElBQUksQ0FBQyxRQUFRLEtBQUssTUFBTSxFQUFFO1lBQ3pCLElBQUcsR0FBRyxJQUFJLEdBQUcsQ0FBQyxTQUFTLElBQUksR0FBRyxDQUFDLFVBQVUsSUFBSSxDQUFDLENBQUMsR0FBRyxDQUFDLFVBQVUsSUFBSSxJQUFJLENBQUMsRUFBRTtnQkFDcEUsSUFBRyxHQUFHLENBQUMsU0FBUyxJQUFJLElBQUksQ0FBQyxTQUFTO29CQUFFLEdBQUcsQ0FBQyxTQUFTLEdBQUcsSUFBSSxDQUFDLFNBQVMsQ0FBQzthQUN0RTtpQkFDSTtnQkFDRCxHQUFHLEdBQUcsc0RBQUcsQ0FBQyxRQUFRLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsQ0FBQztnQkFDbEQsSUFBRyxHQUFHLEVBQUU7b0JBQ0osSUFBRyxHQUFHLENBQUMsVUFBVTt3QkFBRSxHQUFHLENBQUMsVUFBVSxDQUFDLFlBQVksQ0FBQyxHQUFHLEVBQUUsR0FBRyxDQUFDLENBQUM7b0JBQ3pELE1BQU0saUJBQWlCLENBQUMsR0FBRyxFQUFFLEtBQUssQ0FBQyxDQUFDO2lCQUN2QzthQUNKO1lBRUQsR0FBRyxDQUFDLG1EQUFRLENBQUMsR0FBRyxFQUFFLENBQUM7WUFDbkIsT0FBTyxHQUFHLENBQUM7U0FDZDtRQUVELElBQUksUUFBUSxHQUFTLElBQUksQ0FBQyxRQUFRLEVBQUUsS0FBSyxDQUFDO1FBQzFDLElBQUcsT0FBTyxRQUFRLEtBQUssVUFBVTtZQUFFLE9BQU8sTUFBTSxpRUFBYyxDQUFDLEdBQUcsRUFBRSxJQUFJLEVBQUUsTUFBTSxFQUFFLFNBQVMsQ0FBQyxDQUFDO1FBQzdGLElBQUcsQ0FBQyxHQUFHLElBQUksR0FBRyxDQUFDLFFBQVEsQ0FBQyxXQUFXLEVBQUUsS0FBSyxRQUFRLENBQUMsV0FBVyxFQUFFLEVBQUU7WUFDOUQsR0FBRyxHQUFHLHFFQUFVLENBQUMsUUFBUSxDQUFDLENBQUM7WUFDM0IsSUFBRyxHQUFHLEVBQUU7Z0JBQ0osT0FBTSxHQUFHLENBQUMsVUFBVTtvQkFBRSxHQUFHLENBQUMsV0FBVyxDQUFDLEdBQUcsQ0FBQyxVQUFVLENBQUMsQ0FBQztnQkFDdEQsSUFBRyxHQUFHLENBQUMsVUFBVTtvQkFBRSxHQUFHLENBQUMsVUFBVSxDQUFDLFlBQVksQ0FBQyxHQUFHLEVBQUUsR0FBRyxDQUFDLENBQUM7Z0JBRXpELFdBQVc7Z0JBQ1gsTUFBTSxpQkFBaUIsQ0FBQyxHQUFHLEVBQUUsS0FBSyxDQUFDLENBQUM7YUFDdkM7U0FDSjtRQUNELElBQUksS0FBSyxHQUFTLEdBQUcsQ0FBQyxtREFBUSxDQUFDLENBQUM7UUFDaEMsSUFBRyxDQUFDLEtBQUssRUFBRTtZQUNQLEtBQUssR0FBRyxHQUFHLENBQUMsbURBQVEsQ0FBQyxHQUFHLEVBQUUsQ0FBQztZQUMzQixHQUFHLENBQUMsaUJBQWlCLEVBQUUsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLEdBQUcsR0FBRyxDQUFDLFlBQVksQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1NBQ3hFO1FBRUQsSUFBSSxFQUFFLEdBQUcsR0FBRyxDQUFDLFVBQVUsRUFBRSxRQUFRLEdBQUcsSUFBSSxDQUFDLFVBQVUsQ0FBQztRQUNwRCxJQUFHLENBQUMsUUFBUSxJQUFJLFFBQVEsQ0FBQyxNQUFNLENBQUMsSUFBSSxFQUFFO1lBQUUsTUFBTSxhQUFhLENBQUMsR0FBRyxFQUFFLFFBQVEsRUFBRSxJQUFJLENBQUMsQ0FBQztRQUVqRixjQUFjLENBQUMsR0FBRyxFQUFFLElBQUksQ0FBQyxVQUFVLEVBQUUsS0FBSyxDQUFDLENBQUM7UUFFNUMsT0FBTyxHQUFHLENBQUM7SUFDZixDQUFDO0NBQUE7QUFFRCx1QkFBNkIsR0FBRyxFQUFFLFNBQXVCLEVBQUUsSUFBYTs7UUFDdkUsSUFBSSxnQkFBZ0IsR0FBRyxHQUFHLENBQUMsVUFBVSxFQUNwQyxRQUFRLEdBQUcsS0FBSyxFQUFPLEVBQ3ZCLEtBQUssR0FBRyxFQUFFLEVBQ1YsUUFBUSxHQUFHLENBQUMsRUFDWixHQUFHLEdBQUcsQ0FBQyxFQUNQLEdBQUcsR0FBRyxnQkFBZ0IsQ0FBQyxNQUFNLEVBQzdCLFdBQVcsR0FBRyxDQUFDLEVBQ2YsSUFBSSxHQUFHLFNBQVMsQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUN2QyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxNQUFNLEVBQUUsS0FBSyxDQUFDO1FBRXhCLHFFQUFxRTtRQUNyRSxJQUFJLEdBQUcsS0FBRyxDQUFDLEVBQUU7WUFDWixLQUFLLElBQUksQ0FBQyxHQUFDLENBQUMsRUFBRSxDQUFDLEdBQUMsR0FBRyxFQUFFLENBQUMsRUFBRSxFQUFFO2dCQUN6QixJQUFJLEtBQUssR0FBRyxnQkFBZ0IsQ0FBQyxDQUFDLENBQUMsRUFDOUIsS0FBSyxHQUFHLEtBQUssQ0FBQyxtREFBUSxDQUFDLEVBQ3ZCLEdBQUcsR0FBRyxJQUFJLElBQUksS0FBSyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsVUFBVSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDO2dCQUNsRixJQUFJLEdBQUcsSUFBRSxJQUFJLEVBQUU7b0JBQ2QsUUFBUSxFQUFFLENBQUM7b0JBQ1gsS0FBSyxDQUFDLEdBQUcsQ0FBQyxHQUFHLEtBQUssQ0FBQztpQkFDbkI7cUJBQ0ksSUFBSSxLQUFLLElBQUksQ0FBQyxLQUFLLENBQUMsU0FBUyxLQUFHLFNBQVMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxTQUFTLENBQUMsSUFBSSxFQUFFLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUMsRUFBRTtvQkFDMUcsUUFBUSxDQUFDLFdBQVcsRUFBRSxDQUFDLEdBQUcsS0FBSyxDQUFDO2lCQUNoQzthQUNEO1NBQ0Q7UUFFRCxJQUFJLElBQUksS0FBRyxDQUFDLEVBQUU7WUFDYixLQUFLLElBQUksQ0FBQyxHQUFDLENBQUMsRUFBRSxDQUFDLEdBQUMsSUFBSSxFQUFFLENBQUMsRUFBRSxFQUFFO2dCQUMxQixNQUFNLEdBQUcsU0FBUyxDQUFDLENBQUMsQ0FBQyxDQUFDO2dCQUN0QixLQUFLLEdBQUcsSUFBSSxDQUFDO2dCQUViLCtDQUErQztnQkFDL0MsSUFBSSxHQUFHLEdBQUcsTUFBTSxDQUFDLEdBQUcsQ0FBQztnQkFDckIsSUFBSSxHQUFHLElBQUUsSUFBSSxFQUFFO29CQUNkLElBQUksUUFBUSxJQUFJLEtBQUssQ0FBQyxHQUFHLENBQUMsS0FBRyxTQUFTLEVBQUU7d0JBQ3ZDLEtBQUssR0FBRyxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUM7d0JBQ25CLEtBQUssQ0FBQyxHQUFHLENBQUMsR0FBRyxTQUFTLENBQUM7d0JBQ3ZCLFFBQVEsRUFBRSxDQUFDO3FCQUNYO2lCQUNEO2dCQUNELHNFQUFzRTtxQkFDakUsSUFBSSxHQUFHLEdBQUMsV0FBVyxFQUFFO29CQUN6QixLQUFLLENBQUMsR0FBQyxHQUFHLEVBQUUsQ0FBQyxHQUFDLFdBQVcsRUFBRSxDQUFDLEVBQUUsRUFBRTt3QkFDL0IsSUFBSSxRQUFRLENBQUMsQ0FBQyxDQUFDLEtBQUcsU0FBUyxJQUFJLHlFQUFjLENBQUMsQ0FBQyxHQUFHLFFBQVEsQ0FBQyxDQUFDLENBQUMsRUFBRSxNQUFNLEVBQUUsU0FBUyxDQUFDLEVBQUU7NEJBQ2xGLEtBQUssR0FBRyxDQUFDLENBQUM7NEJBQ1YsUUFBUSxDQUFDLENBQUMsQ0FBQyxHQUFHLFNBQVMsQ0FBQzs0QkFDeEIsSUFBSSxDQUFDLEtBQUcsV0FBVyxHQUFDLENBQUM7Z0NBQUUsV0FBVyxFQUFFLENBQUM7NEJBQ3JDLElBQUksQ0FBQyxLQUFHLEdBQUc7Z0NBQUUsR0FBRyxFQUFFLENBQUM7NEJBQ25CLE1BQU07eUJBQ047cUJBQ0Q7aUJBQ0Q7Z0JBRUQsbUVBQW1FO2dCQUNuRSxLQUFLLEdBQUcsTUFBTSxLQUFLLENBQUMsS0FBSyxFQUFFLE1BQU0sRUFBRSxHQUFHLEVBQUUsSUFBSSxDQUFDLENBQUM7Z0JBRTlDLENBQUMsR0FBRyxnQkFBZ0IsQ0FBQyxDQUFDLENBQUMsQ0FBQztnQkFDeEIsSUFBSSxLQUFLLElBQUksS0FBSyxLQUFHLEdBQUcsSUFBSSxLQUFLLEtBQUcsQ0FBQyxFQUFFO29CQUN0QyxJQUFJLENBQUMsSUFBRSxJQUFJLEVBQUU7d0JBQ1osR0FBRyxDQUFDLFdBQVcsQ0FBQyxLQUFLLENBQUMsQ0FBQztxQkFDdkI7eUJBQ0ksSUFBSSxLQUFLLEtBQUcsQ0FBQyxDQUFDLFdBQVcsRUFBRTt3QkFDL0IscUVBQVUsQ0FBQyxDQUFDLENBQUMsQ0FBQztxQkFDZDt5QkFDSTt3QkFDSixHQUFHLENBQUMsWUFBWSxDQUFDLEtBQUssRUFBRSxDQUFDLENBQUMsQ0FBQztxQkFDM0I7aUJBQ0Q7YUFDRDtTQUNEO1FBR0QsZ0NBQWdDO1FBQ2hDLElBQUksUUFBUSxFQUFFO1lBQ2IsS0FBSyxJQUFJLENBQUMsSUFBSSxLQUFLO2dCQUFFLElBQUksS0FBSyxDQUFDLENBQUMsQ0FBQyxLQUFHLFNBQVM7b0JBQUUsTUFBTSxpQkFBaUIsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLEVBQUUsS0FBSyxDQUFDLENBQUM7U0FDeEY7UUFFRCxvQ0FBb0M7UUFDcEMsT0FBTyxHQUFHLElBQUUsV0FBVyxFQUFFO1lBQ3hCLElBQUksQ0FBQyxLQUFLLEdBQUcsUUFBUSxDQUFDLFdBQVcsRUFBRSxDQUFDLENBQUMsS0FBRyxTQUFTO2dCQUFFLE1BQU0saUJBQWlCLENBQUMsS0FBSyxFQUFFLEtBQUssQ0FBQyxDQUFDO1NBQ3pGO0lBQ0YsQ0FBQztDQUFBO0FBRU0sMkJBQWlDLElBQVMsRUFBRSxXQUFvQjs7UUFDbkUsSUFBRyxDQUFDLElBQUk7WUFBRSxPQUFPO1FBQ2pCLElBQUksU0FBUyxHQUFHLElBQUksQ0FBQyxVQUFVLENBQUM7UUFDaEMsSUFBRyxTQUFTO1lBQUUsTUFBTSxtRUFBZ0IsQ0FBQyxTQUFTLENBQUMsQ0FBQztRQUNoRCxJQUFHLElBQUksQ0FBQyxtREFBUSxDQUFDLElBQUksSUFBSSxDQUFDLG1EQUFRLENBQUMsQ0FBQyxHQUFHO1lBQUUsSUFBSSxDQUFDLG1EQUFRLENBQUMsQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDbEUsSUFBRyxXQUFXLEtBQUssS0FBSyxJQUFJLElBQUksQ0FBQyxtREFBUSxDQUFDO1lBQUUscUVBQVUsQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUM3RCxNQUFNLGNBQWMsQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUMvQixDQUFDO0NBQUE7QUFFTSx3QkFBOEIsSUFBUzs7UUFDMUMsSUFBSSxHQUFHLElBQUksQ0FBQyxTQUFTLENBQUM7UUFDdEIsT0FBTSxJQUFJLEVBQUU7WUFDUixJQUFJLElBQUksR0FBRyxJQUFJLENBQUMsZUFBZSxDQUFDO1lBQ2hDLE1BQU0saUJBQWlCLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQyxDQUFDO1lBQ3BDLElBQUksR0FBRyxJQUFJLENBQUM7U0FDZjtJQUNMLENBQUM7Q0FBQTtBQUVELHdCQUF3QixHQUFRLEVBQUUsS0FBVSxFQUFFLEdBQVE7SUFDbEQsSUFBSSxJQUFJLENBQUM7SUFDVCxLQUFJLElBQUksSUFBSSxHQUFHLEVBQUU7UUFDYixJQUFHLENBQUMsQ0FBQyxLQUFLLElBQUksS0FBSyxDQUFDLElBQUksQ0FBQyxJQUFJLElBQUksQ0FBQyxJQUFJLEdBQUcsQ0FBQyxJQUFJLENBQUMsSUFBSSxJQUFJO1lBQUUsc0VBQVcsQ0FBQyxHQUFHLEVBQUUsSUFBSSxFQUFFLEdBQUcsRUFBRSxHQUFHLENBQUMsSUFBSSxDQUFDLEdBQUcsU0FBUyxDQUFDLENBQUM7S0FDL0c7SUFDRCxLQUFJLElBQUksSUFBSSxLQUFLLEVBQUU7UUFDZixJQUFHLElBQUksS0FBSyxVQUFVLElBQUksSUFBSSxLQUFLLFdBQVc7ZUFDdkMsQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLElBQUksS0FBSyxPQUFPLElBQUksSUFBSSxLQUFLLFNBQVMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDO1lBQUUsc0VBQVcsQ0FBQyxHQUFHLEVBQUUsSUFBSSxFQUFFLEdBQUcsQ0FBQyxJQUFJLENBQUMsRUFBRSxHQUFHLENBQUMsSUFBSSxDQUFDLEdBQUcsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7S0FDM0o7QUFDTCxDQUFDOzs7Ozs7Ozs7Ozs7O0FDL0xEO0FBQUE7QUFBYTtBQUNFO0lBUVgsWUFBWSxJQUFTLEVBQUUsSUFBWSxFQUFFLENBQU07UUFDdkMsSUFBSSxDQUFDLFFBQVEsR0FBRyxJQUFJLENBQUM7UUFDckIsSUFBSSxDQUFDLFFBQVEsR0FBRyxJQUFJLENBQUM7UUFDckIsSUFBSSxDQUFDLFNBQVMsR0FBRyxDQUFDLENBQUM7UUFDbkIsSUFBSSxDQUFDLFVBQVUsR0FBRyxLQUFLLENBQU0sQ0FBQyxDQUFDLENBQUM7SUFDcEMsQ0FBQztDQUNKOzs7Ozs7Ozs7Ozs7O0FDZkQ7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBYTs7Ozs7Ozs7O0FBRTJEO0FBRTdCO0FBRXBDLGlCQUFpQixTQUFvQjtJQUN4QyxDQUFDLFNBQVMsQ0FBQyxXQUFXLElBQUksd0RBQWEsQ0FBQyxDQUFDLEdBQVMsRUFBRTtRQUNoRCxNQUFNLGtFQUFlLENBQUMsU0FBUyxFQUFFLFNBQVMsQ0FBQyxVQUFVLEVBQUUsS0FBSyxDQUFDLENBQUM7SUFDbEUsQ0FBQyxFQUFDLENBQUM7QUFDUCxDQUFDO0FBQ00sc0JBQXNCLFNBQW9CLEVBQUUsS0FBbUI7SUFDbEUsQ0FBQyxTQUFTLENBQUMsV0FBVyxJQUFJLHdEQUFhLENBQUMsQ0FBQyxHQUFTLEVBQUU7UUFDaEQsTUFBTSxLQUFLLENBQUM7SUFDaEIsQ0FBQyxFQUFDLENBQUM7QUFDUCxDQUFDO0FBQ00saUJBQXVCLElBQVcsRUFBRSxNQUFXOztRQUNsRCxPQUFPLE1BQU0sTUFBTSxDQUFDLElBQUksRUFBRSxNQUFNLEVBQUUsTUFBTSxDQUFDLGlCQUFpQixDQUFDLENBQUM7SUFDaEUsQ0FBQztDQUFBO0FBQ00sZ0JBQXNCLElBQVcsRUFBRSxNQUFXLEVBQUUsS0FBVTs7UUFDN0QsT0FBTyxNQUFNLCtEQUFJLENBQUMsS0FBSyxFQUFFLElBQUksRUFBRSxNQUFNLEVBQUUsSUFBSSxDQUFDLENBQUM7SUFDakQsQ0FBQztDQUFBIiwiZmlsZSI6InJlYWRhcHQuZGV2Lm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGdldHRlciB9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yID0gZnVuY3Rpb24oZXhwb3J0cykge1xuIFx0XHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcbiBcdFx0fVxuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xuIFx0fTtcblxuIFx0Ly8gY3JlYXRlIGEgZmFrZSBuYW1lc3BhY2Ugb2JqZWN0XG4gXHQvLyBtb2RlICYgMTogdmFsdWUgaXMgYSBtb2R1bGUgaWQsIHJlcXVpcmUgaXRcbiBcdC8vIG1vZGUgJiAyOiBtZXJnZSBhbGwgcHJvcGVydGllcyBvZiB2YWx1ZSBpbnRvIHRoZSBuc1xuIFx0Ly8gbW9kZSAmIDQ6IHJldHVybiB2YWx1ZSB3aGVuIGFscmVhZHkgbnMgb2JqZWN0XG4gXHQvLyBtb2RlICYgOHwxOiBiZWhhdmUgbGlrZSByZXF1aXJlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnQgPSBmdW5jdGlvbih2YWx1ZSwgbW9kZSkge1xuIFx0XHRpZihtb2RlICYgMSkgdmFsdWUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKHZhbHVlKTtcbiBcdFx0aWYobW9kZSAmIDgpIHJldHVybiB2YWx1ZTtcbiBcdFx0aWYoKG1vZGUgJiA0KSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHZhbHVlICYmIHZhbHVlLl9fZXNNb2R1bGUpIHJldHVybiB2YWx1ZTtcbiBcdFx0dmFyIG5zID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yKG5zKTtcbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KG5zLCAnZGVmYXVsdCcsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHZhbHVlIH0pO1xuIFx0XHRpZihtb2RlICYgMiAmJiB0eXBlb2YgdmFsdWUgIT0gJ3N0cmluZycpIGZvcih2YXIga2V5IGluIHZhbHVlKSBfX3dlYnBhY2tfcmVxdWlyZV9fLmQobnMsIGtleSwgZnVuY3Rpb24oa2V5KSB7IHJldHVybiB2YWx1ZVtrZXldOyB9LmJpbmQobnVsbCwga2V5KSk7XG4gXHRcdHJldHVybiBucztcbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSBcIi4vc3JjL2NsaWVudC5qc1wiKTtcbiIsIid1c2Ugc3RyaWN0JztcclxuaW1wb3J0IHtoLCBoIGFzIGNyZWF0ZUVsZW1lbnR9IGZyb20gJy4vaCc7XHJcbmltcG9ydCBDb21wb25lbnQgZnJvbSAnLi9jb21wb25lbnQnO1xyXG5pbXBvcnQge0RPTX0gZnJvbSAnLi9yZWFkYXB0LWRvbS9pbmRleCc7XHJcbmltcG9ydCB7cmVuZGVyLCBoeWRyYXRlfSBmcm9tICcuL3JlbmRlcic7XHJcblxyXG5ET00uZG9jdW1lbnQgPSBkb2N1bWVudDtcclxud2luZG93LmggPSBoO1xyXG53aW5kb3cuQ29tcG9uZW50ID0gQ29tcG9uZW50O1xyXG53aW5kb3cuUmVhZGFwdCA9IHtcclxuICAgIHJlbmRlcjogcmVuZGVyLFxyXG4gICAgaHlkcmF0ZTogaHlkcmF0ZVxyXG59O1xyXG53aW5kb3cuUmVhY3QgPSB7XHJcbiAgICBjcmVhdGVFbGVtZW50OiBjcmVhdGVFbGVtZW50LFxyXG4gICAgcmVuZGVyOiByZW5kZXIsXHJcbiAgICBoeWRyYXRlOiBoeWRyYXRlXHJcbn07IiwiJ3VzZSBzdHJpY3QnO1xyXG5pbXBvcnQge3JlbW92ZU5vZGV9IGZyb20gJy4vcmVhZGFwdC1kb20vaW5kZXgnO1xyXG5pbXBvcnQgVk5vZGUgZnJvbSAnLi9yZWFkYXB0LXZkb20vdm5vZGUnO1xyXG5pbXBvcnQgeyBBVFRSX0tFWSwgQVNZTkMsIFNZTkMsIGV4dGVuZCB9IGZyb20gJy4vY29uc3RhbnRzJztcclxuaW1wb3J0IHsgZGlmZiwgcmVjb2xsZWN0Tm9kZVRyZWUgfSBmcm9tICcuL3JlYWRhcHQtdmRvbS9kaWZmJztcclxuaW1wb3J0IHsgZGlmZkxldmVsfSBmcm9tICcuL3JlYWRhcHQtdmRvbS9kaWZmJztcclxuaW1wb3J0IHsgZW5xdWV1ZSwgZW5xdWV1ZVN0YXRlIH0gZnJvbSAnLi9yZW5kZXInO1xyXG5cclxuZXhwb3J0IGNvbnN0IERFRkVSX1BST01JU0UgPSBQcm9taXNlLnJlc29sdmUoKS50aGVuLmJpbmQoUHJvbWlzZS5yZXNvbHZlKCkpO1xyXG5leHBvcnQgY29uc3QgREVGRVJfVElNRU9VVCA9IHNldFRpbWVvdXQ7XHJcbmV4cG9ydCBjb25zdCBERUZFUl9BTklNQVRJT04gPSB0eXBlb2YgcmVxdWVzdEFuaW1hdGlvbkZyYW1lICE9PSAndW5kZWZpbmVkJyA/IHJlcXVlc3RBbmltYXRpb25GcmFtZSA6IERFRkVSX1BST01JU0U7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBDb21wb25lbnQge1xyXG4gICAga2V5OiBhbnk7XHJcbiAgICByZWY6IGFueTtcclxuICAgIGRpc2FibGVkOiBib29sZWFuO1xyXG4gICAgcGFyZW50IDogYW55O1xyXG4gICAgYmFzZTogYW55O1xyXG4gICAgcmVuZGVyTW9kZTogTnVtYmVyO1xyXG4gICAgY2hpbGQ6IGFueTtcclxuICAgIGFzeW5jTWV0aG9kOiBhbnk7XHJcbiAgICBwYXJlbnROb2RlOiBhbnk7XHJcbiAgICBjaGlsZHJlbjogQXJyYXk8YW55PjtcclxuICAgIHN0YXRlOiBPYmplY3Q7XHJcbiAgICAvL2NvbnRhaW5lciB0byBob2xkIG9yaWdpbmFsIHBhc3NlZCBwcm9wc1xyXG4gICAgX19wcm9wczogYW55O1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKHByb3BzOiBhbnksIHBhcmVudDogQ29tcG9uZW50LCByZW5kZXJNb2RlOiBhbnkpIHtcclxuICAgICAgICB0aGlzLmRpc2FibGVkID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5rZXkgPSBwcm9wcy5rZXk7XHJcbiAgICAgICAgdGhpcy5yZWYgPSBwcm9wcy5yZWY7XHJcbiAgICAgICAgdGhpcy5hc3luY01ldGhvZCA9IERFRkVSX1BST01JU0U7XHJcbiAgICAgICAgdGhpcy5yZW5kZXJNb2RlID0gcmVuZGVyTW9kZSB8fCBTWU5DO1xyXG4gICAgICAgIHRoaXMuY2hpbGQgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuYmFzZSA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5wYXJlbnQgPSBwYXJlbnQ7XHJcbiAgICAgICAgdGhpcy5wYXJlbnROb2RlID0gbnVsbDtcclxuICAgICAgICB0aGlzLmNoaWxkcmVuID0gW107XHJcbiAgICAgICAgdGhpcy5zdGF0ZSA9IHt9O1xyXG4gICAgICAgIHRoaXMuX19wcm9wcyA9IHByb3BzO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGRlbGV0ZSBwcm9wcy5yZWY7XHJcbiAgICAgICAgZGVsZXRlIHByb3BzLmtleTtcclxuICAgXHJcbiAgICAgICAgdGhpcy5vYnNlcnZlKHByb3BzKTtcclxuICAgIH1cclxuXHJcbiAgICBwcm90ZWN0ZWQgYXN5bmMgY29tcG9uZW50Q2hhbmdlKGtleTogc3RyaW5nLCB2YWx1ZTogYW55LCBwcmV2aW91czogYW55KSA6IFByb21pc2U8YW55PiB7XHJcbiAgICAgICAgaWYodGhpcy5zaG91bGRDb21wb25lbnRVcGRhdGUoa2V5LHZhbHVlLHByZXZpb3VzKSkge1xyXG4gICAgICAgICAgICBpZih0aGlzLnJlbmRlck1vZGUgPT09IFNZTkMpIGF3YWl0IHJlbmRlckNvbXBvbmVudCh0aGlzLCB0aGlzLnBhcmVudE5vZGUsIGZhbHNlKTtcclxuICAgICAgICAgICAgZWxzZSBpZih0aGlzLnJlbmRlck1vZGUgPT09IEFTWU5DKSBlbnF1ZXVlKHRoaXMpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBhc3luYyBmb3JjZVVwZGF0ZSgpIDogUHJvbWlzZTxhbnk+IHtcclxuICAgICAgICBhd2FpdCByZW5kZXJDb21wb25lbnQodGhpcywgdGhpcy5wYXJlbnROb2RlLCBmYWxzZSk7XHJcbiAgICB9XHJcblxyXG4gICAgYXN5bmMgY29tcG9uZW50RGlkVXBkYXRlKHByZXZpb3VzKSA6IFByb21pc2U8YW55PiB7XHJcbiAgICAgICAgXHJcbiAgICB9XHJcblxyXG4gICAgYXN5bmMgcmVuZGVyKCkgOiBQcm9taXNlPGFueT4ge1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBhc3luYyBjb21wb25lbnRXaWxsVW5tb3VudCgpIDogUHJvbWlzZTxhbnk+IHtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgYXN5bmMgY29tcG9uZW50RGlkTW91bnQoKSA6IFByb21pc2U8YW55PiB7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIHByb3RlY3RlZCBhc3luYyBzZXRTdGF0ZShzbTogYW55KSA6IFByb21pc2U8YW55PiB7XHJcbiAgICAgICAgY29uc3QgdXBkYXRlID0gbmV3IFByb21pc2UoYXN5bmMgKHIscmopID0+IHtcclxuICAgICAgICAgICAgLy9pbW11dGFibGUgZnJvbSBvcmlnaW5hbCBzdGF0ZVxyXG4gICAgICAgICAgICBjb25zdCBvbGRTdGF0ZSA9IGV4dGVuZCh7fSwgdGhpcy5zdGF0ZSk7XHJcbiAgICAgICAgICAgIGNvbnN0IGZpbmFsU3RhdGUgPSBleHRlbmQoe30sIHRoaXMuc3RhdGUpO1xyXG4gICAgICAgICAgICBsZXQgbmV3U3RhdGUgOiBPYmplY3QgPSB7fTtcclxuICAgICAgICAgICAgaWYgKHR5cGVvZiBzbSA9PT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICAgICAgICAgICAgLy9jb3B5IGN1cnJlbnQgcHJvcHMgZm9yIGltbXV0YWJsZVxyXG4gICAgICAgICAgICAgICAgY29uc3QgcHJvcHMgPSB7fTtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9fcHJvcHMpIHtcclxuICAgICAgICAgICAgICAgICAgICBmb3IobGV0IGsgaW4gdGhpcy5fX3Byb3BzKSBwcm9wc1trXSA9IHRoaXNba107XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAvL2ltbXV0YWJsZSBmcm9tIG9yaWdpbmFsIHN0YXRlXHJcbiAgICAgICAgICAgICAgICBuZXdTdGF0ZSA9IHNtKGV4dGVuZChuZXdTdGF0ZSwgdGhpcy5zdGF0ZSksIHByb3BzKSB8fCBuZXdTdGF0ZTtcclxuICAgICAgICAgICAgICAgIGV4dGVuZChmaW5hbFN0YXRlLCBuZXdTdGF0ZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZih0eXBlb2Ygc20gPT09ICdvYmplY3QnKSBleHRlbmQoZmluYWxTdGF0ZSwgc20pO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5zdGF0ZSA9IGZpbmFsU3RhdGU7XHJcblxyXG4gICAgICAgICAgICBmb3IobGV0IGsgaW4gZmluYWxTdGF0ZSkge1xyXG4gICAgICAgICAgICAgICAgaWYob2xkU3RhdGVba10gIT09IGZpbmFsU3RhdGVba10pIGF3YWl0IHRoaXMuY29tcG9uZW50Q2hhbmdlKGssIG5ld1N0YXRlW2tdLCBvbGRTdGF0ZVtrXSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcigpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGlmICh0aGlzLnJlbmRlck1vZGUgPT09IFNZTkMpIGF3YWl0IHVwZGF0ZTtcclxuICAgICAgICBlbHNlIGlmKHRoaXMucmVuZGVyTW9kZSA9PT0gQVNZTkMpIGVucXVldWVTdGF0ZSh0aGlzLCB1cGRhdGUpO1xyXG4gICAgfSBcclxuXHJcbiAgICBwcm90ZWN0ZWQgc2hvdWxkQ29tcG9uZW50VXBkYXRlKGtleTogc3RyaW5nLCB2YWx1ZTogYW55LCBwcmV2aW91czogYW55KSA6IGJvb2xlYW4ge1xyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfVxyXG5cclxuICAgIHByb3RlY3RlZCBvYnNlcnZlKG86IE9iamVjdCkge1xyXG4gICAgICAgIGZvcihsZXQgayBpbiBvKSB7XHJcbiAgICAgICAgICAgIGxldCB2IDogYW55ID0gb1trXTtcclxuXHJcbiAgICAgICAgICAgIGlmKHR5cGVvZiB2ID09PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzW2tdID0gdjtcclxuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgYFxcJCR7a31gLCB7dmFsdWU6IHYsIHdyaXRhYmxlOiB0cnVlLCBlbnVtZXJhYmxlOiBmYWxzZSB9KTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBrLCB7XHJcbiAgICAgICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgZ2V0KCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzW2BcXCQke2t9YF07XHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgc2V0KG52OiBhbnkpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBwcmV2ID0gdGhpc1tgXFwkJHtrfWBdO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXNbYFxcJCR7a31gXSA9IG52O1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZighdGhpcy5kaXNhYmxlZCAmJiBwcmV2ICE9PSBudikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbXBvbmVudENoYW5nZShrLG52LHByZXYpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcmVuZGVyQ29tcG9uZW50KGNvbXBvbmVudDogQ29tcG9uZW50LCBwYXJlbnROb2RlOiBhbnksIGh5ZHJhdGluZzogYm9vbGVhbikge1xyXG4gICAgbGV0IGlzVXBkYXRlID0gY29tcG9uZW50LmJhc2UsIHAsIHByb3BzLCByZW5kZXJlZCwgdG9Vbm1vdW50LCBjYmFzZSwgaW5zdCwgYmFzZSwgdHlwZTtcclxuICAgIGlmKGNvbXBvbmVudC5kaXNhYmxlZCkgcmV0dXJuO1xyXG5cclxuICAgIHJlbmRlcmVkID0gYXdhaXQgY29tcG9uZW50LnJlbmRlcigpO1xyXG5cclxuICAgIGlmKCFyZW5kZXJlZCB8fCBBcnJheS5pc0FycmF5KHJlbmRlcmVkKSkge1xyXG4gICAgICAgIGlmKGNvbXBvbmVudC5jaGlsZCkge1xyXG4gICAgICAgICAgICBhd2FpdCB1bm1vdW50Q29tcG9uZW50KGNvbXBvbmVudC5jaGlsZCk7XHJcbiAgICAgICAgICAgIGNvbXBvbmVudC5jaGlsZCA9IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmKGNvbXBvbmVudC5iYXNlKSB7XHJcbiAgICAgICAgICAgIGNvbXBvbmVudC5iYXNlLl9jb21wb25lbnQgPSBudWxsO1xyXG4gICAgICAgICAgICBhd2FpdCByZWNvbGxlY3ROb2RlVHJlZShjb21wb25lbnQuYmFzZSwgZmFsc2UpO1xyXG4gICAgICAgICAgICBjb21wb25lbnQuYmFzZSA9IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICBjb21wb25lbnQucGFyZW50Tm9kZSA9IHBhcmVudE5vZGU7XHJcbiAgICBjYmFzZSA9IGJhc2UgPSBjb21wb25lbnQuYmFzZTtcclxuXHJcbiAgICBpZih0eXBlb2YgcmVuZGVyZWQubm9kZU5hbWUgPT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgICBwcm9wcyA9IHJlbmRlcmVkLmF0dHJpYnV0ZXM7XHJcbiAgICAgICAgaW5zdCA9IGNvbXBvbmVudC5jaGlsZDtcclxuICAgICAgICBpZihpbnN0ICYmIGluc3QuY29uc3RydWN0b3IgPT09IHJlbmRlcmVkLm5vZGVOYW1lKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHVwZGF0ZSA9IHByZXBhcmVSZW5kZXIoaW5zdCwgcHJvcHMsIHJlbmRlcmVkLmNoaWxkTm9kZXMpO1xyXG4gICAgICAgICAgICBpZih1cGRhdGUuX2RpZmZlcmVudCkge1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgcmVuZGVyQ29tcG9uZW50KGluc3QsIGluc3QucGFyZW50Tm9kZSwgaHlkcmF0aW5nKTtcclxuICAgICAgICAgICAgICAgIGF3YWl0IGluc3QuY29tcG9uZW50RGlkVXBkYXRlKHVwZGF0ZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHRvVW5tb3VudCA9IGluc3Q7IHR5cGUgPSByZW5kZXJlZC5ub2RlTmFtZTtcclxuXHJcbiAgICAgICAgICAgIGlmKGNiYXNlICYmICF0b1VubW91bnQgJiYgIWh5ZHJhdGluZykge1xyXG4gICAgICAgICAgICAgICAgY2Jhc2UuX2NvbXBvbmVudCA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCByZWNvbGxlY3ROb2RlVHJlZShjYmFzZSwgZmFsc2UpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjb21wb25lbnQuY2hpbGQgPSBpbnN0ID0gbmV3IHR5cGUocHJvcHMsIGNvbXBvbmVudCk7XHJcbiAgICAgICAgICAgIGlmIChoeWRyYXRpbmcpIGluc3QuYmFzZSA9IGNiYXNlO1xyXG4gICAgICAgICAgICBpbnN0LmNoaWxkcmVuID0gcmVuZGVyZWQuY2hpbGROb2RlcztcclxuICAgICAgICAgICAgaWYoaW5zdC5yZWYpIGluc3QucmVmKGluc3QpO1xyXG4gICAgICAgICAgICBhd2FpdCByZW5kZXJDb21wb25lbnQoaW5zdCwgY29tcG9uZW50LnBhcmVudE5vZGUsIGh5ZHJhdGluZyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBiYXNlID0gaW5zdC5iYXNlO1xyXG4gICAgfVxyXG4gICAgaWYodHlwZW9mIHJlbmRlcmVkLm5vZGVOYW1lICE9PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgdG9Vbm1vdW50ID0gY29tcG9uZW50LmNoaWxkO1xyXG4gICAgICAgIGlmKHRvVW5tb3VudCkgY2Jhc2UgPSBjb21wb25lbnQuY2hpbGQgPSBudWxsO1xyXG4gICAgICAgIGJhc2UgPSBhd2FpdCBkaWZmKGNiYXNlLCByZW5kZXJlZCwgY29tcG9uZW50LnBhcmVudE5vZGUsIHRydWUpO1xyXG4gICAgfVxyXG5cclxuICAgIGlmKGNiYXNlICYmIGJhc2UgIT09IGNiYXNlICYmIGluc3QgIT09IGNvbXBvbmVudC5jaGlsZCkge1xyXG4gICAgICAgIHAgPSBjYmFzZS5wYXJlbnROb2RlO1xyXG4gICAgICAgIGlmKHAgJiYgYmFzZSAhPT0gcCkge1xyXG4gICAgICAgICAgICBwLnJlcGxhY2VDaGlsZChiYXNlLCBjYmFzZSk7XHJcblxyXG4gICAgICAgICAgICBpZighdG9Vbm1vdW50KSB7XHJcbiAgICAgICAgICAgICAgICBjYmFzZS5fY29tcG9uZW50ID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIGF3YWl0IHJlY29sbGVjdE5vZGVUcmVlKGNiYXNlLCBmYWxzZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgaWYodG9Vbm1vdW50KSBhd2FpdCB1bm1vdW50Q29tcG9uZW50KHRvVW5tb3VudCk7XHJcblxyXG4gICAgY29tcG9uZW50LmJhc2UgPSBiYXNlO1xyXG4gICAgaWYoYmFzZSAmJiAhY29tcG9uZW50LmNoaWxkKSB7XHJcbiAgICAgICAgbGV0IGNtcCA9IGNvbXBvbmVudCwgdCA9IGNvbXBvbmVudDtcclxuXHJcbiAgICAgICAgd2hpbGUoKHQgPSB0LnBhcmVudCkpIHtcclxuICAgICAgICAgICAgKGNtcCA9IHQpLmJhc2UgPSBiYXNlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgYmFzZS5fY29tcG9uZW50ID0gY21wO1xyXG4gICAgfSBcclxuICAgIGlmKCFpc1VwZGF0ZSkge1xyXG4gICAgICAgIGF3YWl0IGNvbXBvbmVudC5jb21wb25lbnREaWRNb3VudCgpO1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gcHJlcGFyZVJlbmRlcihpbnN0OiBDb21wb25lbnQsIHByb3BzOiBhbnksIGNoaWxkcmVuOiBBcnJheTxhbnk+KSA6IGFueSB7XHJcbiAgICBsZXQgZGlmZiA9IHtfZGlmZmVyZW50OiBmYWxzZX07XHJcbiAgICBpZihpbnN0LnJlZikgaW5zdC5yZWYoaW5zdCk7XHJcbiAgICBpbnN0LmNoaWxkcmVuID0gY2hpbGRyZW47XHJcblxyXG4gICAgaW5zdC5kaXNhYmxlZCA9IHRydWU7XHJcbiAgICBmb3IobGV0IG4gaW4gcHJvcHMpIHtcclxuXHRcdGlmKGluc3Rbbl0gIT09IHByb3BzW25dKSB7XHJcblx0XHRcdGRpZmZbbl0gPSBpbnN0W25dO1xyXG5cdFx0XHRkaWZmLl9kaWZmZXJlbnQgPSB0cnVlO1xyXG5cdFx0fVxyXG5cdFx0aW5zdFtuXSA9IHByb3BzW25dO1xyXG4gICAgfVxyXG4gICAgaW5zdC5kaXNhYmxlZCA9IGZhbHNlO1xyXG5cclxuICAgIHJldHVybiBkaWZmO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdW5tb3VudENvbXBvbmVudChjb21wb25lbnQ6IENvbXBvbmVudCkge1xyXG4gICAgY29uc3QgYmFzZSA9IGNvbXBvbmVudC5iYXNlO1xyXG4gICAgY29tcG9uZW50LmRpc2FibGVkID0gdHJ1ZTtcclxuICAgIGF3YWl0IGNvbXBvbmVudC5jb21wb25lbnRXaWxsVW5tb3VudCgpO1xyXG4gICAgaWYoY29tcG9uZW50LmNoaWxkKSBhd2FpdCB1bm1vdW50Q29tcG9uZW50KGNvbXBvbmVudC5jaGlsZCk7XHJcbiAgICBjb21wb25lbnQuYmFzZSA9IG51bGw7XHJcbiAgICBjb21wb25lbnQucGFyZW50ID0gbnVsbDtcclxuICAgIGNvbXBvbmVudC5jaGlsZCA9IG51bGw7XHJcbiAgICBpZihiYXNlKSB7XHJcbiAgICAgICAgYmFzZS5fY29tcG9uZW50ID0gbnVsbDtcclxuICAgICAgICBpZihiYXNlW0FUVFJfS0VZXSAmJiBiYXNlW0FUVFJfS0VZXS5yZWYpIGJhc2VbQVRUUl9LRVldLnJlZihudWxsKTtcclxuXHJcbiAgICAgICAgYXdhaXQgcmVjb2xsZWN0Tm9kZVRyZWUoYmFzZSwgZmFsc2UpO1xyXG4gICAgfVxyXG4gICAgaWYoY29tcG9uZW50LnJlZikgY29tcG9uZW50LnJlZihudWxsKTtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGJ1aWxkQ29tcG9uZW50KGRvbTogYW55LCBub2RlOiBWTm9kZSwgcGFyZW50Tm9kZTogYW55LCBoeWRyYXRpbmc6IGJvb2xlYW4pIHtcclxuICAgIGxldCBjID0gZG9tICYmIGRvbS5fY29tcG9uZW50LFxyXG4gICAgICAgIGlzRGlyZWN0T3duZXIgPSBjICYmIGMuY29uc3RydWN0b3IgPT09IG5vZGUubm9kZU5hbWUsXHJcbiAgICAgICAgcHJvcHMgPSBub2RlLmF0dHJpYnV0ZXMsXHJcbiAgICAgICAgdHlwZSA9IG5vZGUubm9kZU5hbWU7XHJcblxyXG4gICAgaWYoaXNEaXJlY3RPd25lciAmJiBjKSB7XHJcbiAgICAgICAgY29uc3QgdXBkYXRlID0gcHJlcGFyZVJlbmRlcihjLCBwcm9wcywgbm9kZS5jaGlsZE5vZGVzKTtcclxuICAgICAgICBpZih1cGRhdGUuX2RpZmZlcmVudCkge1xyXG4gICAgICAgICAgICBhd2FpdCByZW5kZXJDb21wb25lbnQoYywgcGFyZW50Tm9kZSwgaHlkcmF0aW5nKTtcclxuICAgICAgICAgICAgYXdhaXQgYy5jb21wb25lbnREaWRVcGRhdGUodXBkYXRlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZG9tID0gYy5iYXNlO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgaWYoIWh5ZHJhdGluZykgYXdhaXQgcmVjb2xsZWN0Tm9kZVRyZWUoZG9tLCBmYWxzZSk7XHJcbiAgICAgICAgYyA9IG5ldyB0eXBlKHByb3BzLCBudWxsKTtcclxuICAgICAgICBjLmNoaWxkcmVuID0gbm9kZS5jaGlsZE5vZGVzO1xyXG4gICAgICAgIGlmIChoeWRyYXRpbmcpIGMuYmFzZSA9IGRvbTtcclxuICAgICAgICBpZihjLnJlZikgYy5yZWYoYyk7XHJcbiAgICAgICAgYXdhaXQgcmVuZGVyQ29tcG9uZW50KGMsIHBhcmVudE5vZGUsIGh5ZHJhdGluZyk7XHJcbiAgICAgICAgZG9tID0gYy5iYXNlO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICByZXR1cm4gZG9tO1xyXG59IiwiJ3VzZSBzdHJpY3QnO1xyXG5cclxuZXhwb3J0IGNvbnN0IEFUVFJfS0VZID0gJ19fcmVhZGFwdF9fJztcclxuZXhwb3J0IGNvbnN0IEFTWU5DID0gMztcclxuZXhwb3J0IGNvbnN0IFNZTkMgPSAxO1xyXG5leHBvcnQgY29uc3QgTk9ORSA9IDA7XHJcbmV4cG9ydCBjb25zdCBGT1JDRSA9IDI7XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZXh0ZW5kKGJhc2U6IE9iamVjdCwgcmVmOiBPYmplY3QpIHtcclxuICAgIGZvcihsZXQgayBpbiByZWYpIGJhc2Vba10gPSByZWZba107XHJcbiAgICByZXR1cm4gYmFzZTtcclxufTsiLCIndXNlIHN0cmljdCc7XHJcblxyXG5pbXBvcnQgVk5vZGUgZnJvbSAnLi9yZWFkYXB0LXZkb20vdm5vZGUnO1xyXG5pbXBvcnQgQ29tcG9uZW50IGZyb20gJy4vY29tcG9uZW50JztcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBoKG5vZGVOYW1lOiBzdHJpbmcgfCBDb21wb25lbnQsIGF0dHJpYnV0ZXM6IGFueSwgLi4uY2hpbGRyZW4pIHtcclxuICAgIGF0dHJpYnV0ZXMgPSBhdHRyaWJ1dGVzIHx8IHt9O1xyXG4gICAgY29uc3Qgc3RhY2sgPSBBcnJheTxhbnk+KDApO1xyXG4gICAgbGV0IGNoaWxkLCBwID0gbmV3IFZOb2RlKG5vZGVOYW1lLCB0eXBlb2Ygbm9kZU5hbWUgPT09ICdmdW5jdGlvbicgPyAnY29tcG9uZW50JyA6ICdlbGVtZW50JywgJycpO1xyXG5cclxuICAgIGNoaWxkcmVuLmZvckVhY2goYyA9PiBzdGFjay51bnNoaWZ0KGMpKTtcclxuICAgIGlmKGF0dHJpYnV0ZXMgJiYgYXR0cmlidXRlcy5jaGlsZHJlbiAhPSBudWxsKSB7XHJcbiAgICAgICAgaWYoIXN0YWNrLmxlbmd0aCkgc3RhY2sucHVzaChhdHRyaWJ1dGVzLmNoaWxkcmVuKTtcclxuICAgICAgICBkZWxldGUgYXR0cmlidXRlcy5jaGlsZHJlbjtcclxuICAgIH1cclxuXHJcbiAgICB3aGlsZShzdGFjay5sZW5ndGgpIHtcclxuICAgICAgICBjaGlsZCA9IHN0YWNrLnBvcCgpO1xyXG4gICAgICAgIGlmKEFycmF5LmlzQXJyYXkoY2hpbGQpKSBjaGlsZC5mb3JFYWNoKGMgPT4gc3RhY2sudW5zaGlmdChjKSk7XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGlmKGNoaWxkIGluc3RhbmNlb2YgVk5vZGUpIHAuY2hpbGROb2Rlcy5wdXNoKGNoaWxkKTtcclxuICAgICAgICAgICAgZWxzZSBwLmNoaWxkTm9kZXMucHVzaChuZXcgVk5vZGUoJyN0ZXh0JywgJ3RleHQnLCBjaGlsZCkpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIFxyXG4gICAgcC5hdHRyaWJ1dGVzID0gYXR0cmlidXRlcztcclxuICAgIHAua2V5ID0gYXR0cmlidXRlcy5rZXkgPyBhdHRyaWJ1dGVzLmtleSA6IHVuZGVmaW5lZDtcclxuXHJcbiAgICByZXR1cm4gcDtcclxufTsiLCIndXNlIHN0cmljdCc7XHJcblxyXG5leHBvcnQgY29uc3QgRE9NIDogYW55ID0ge1xyXG4gICAgZG9jdW1lbnQ6IG51bGxcclxufTtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVOb2RlKG5vZGVOYW1lOiBzdHJpbmcpIHtcclxuICAgIHJldHVybiBET00uZG9jdW1lbnQuY3JlYXRlRWxlbWVudChub2RlTmFtZSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiByZW1vdmVOb2RlKG5vZGUpIHtcclxuICAgIGNvbnN0IHBhcmVudE5vZGUgPSBub2RlLnBhcmVudE5vZGU7XHJcbiAgICBpZiAocGFyZW50Tm9kZSkgcGFyZW50Tm9kZS5yZW1vdmVDaGlsZChub2RlKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGlzU2FtZU5vZGVUeXBlKG5vZGU6IGFueSwgdm5vZGU6IGFueSwgaHlkcmF0aW5nOiBib29sZWFuKSB7XHJcbiAgICBpZighbm9kZSkgcmV0dXJuIGZhbHNlO1xyXG4gICAgaWYodm5vZGUubm9kZVR5cGUgPT09ICd0ZXh0JykgcmV0dXJuIG5vZGUuc3BsaXRUZXh0O1xyXG4gICAgaWYodHlwZW9mIHZub2RlLm5vZGVOYW1lID09PSAnc3RyaW5nJykgcmV0dXJuICFub2RlLl9jb21wb25lbnQgJiYgbm9kZS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpID09PSB2bm9kZS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpO1xyXG5cclxuICAgIHJldHVybiBoeWRyYXRpbmcgfHwgKG5vZGUuX2NvbXBvbmVudCAmJiBub2RlLl9jb21wb25lbnQuY29uc3RydWN0b3IgPT09IHZub2RlLm5vZGVOYW1lKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHNldEFjY2Vzc29yKG5vZGUsIG5hbWUsIG9sZCwgdmFsdWUpIHtcclxuICAgIGlmKG5hbWUgPT09ICdjbGFzc05hbWUnKSBuYW1lID0gJ2NsYXNzJztcclxuICAgIGlmKG5hbWUgPT09ICdfX2h0bWwnKSBuYW1lID0gJ2h0bWwnO1xyXG4gICAgaWYobmFtZSA9PT0gJ2tleScpIHtcclxuICAgICAgICAvL2RvIG5vdGhpbmdcclxuICAgIH1cclxuICAgIGVsc2UgaWYobmFtZSA9PT0gJ3JlZicpIHtcclxuICAgICAgICBpZihvbGQpIG9sZChudWxsKTtcclxuICAgICAgICBpZih2YWx1ZSkgdmFsdWUobm9kZSk7XHJcbiAgICB9XHJcbiAgICAvL3BsZWFzZSBmb3IgdGhlIGxvdmUgb2YgZ29kXHJcbiAgICAvL25ldmVyIHVzZSB0aGlzIHVubGVzcyB5b3UgcmVhbGx5IGhhdmUgdG9cclxuICAgIC8vZm9yIHNob3dpbmcgbWFyayBkb3duIG9yIHNvbWV0aGluZyBzaW1pbGFyXHJcbiAgICBlbHNlIGlmKG5hbWUgPT09ICdodG1sJykge1xyXG4gICAgICAgIGlmKG9sZCAhPT0gdmFsdWUpIHtcclxuICAgICAgICAgICAgbm9kZS5pbm5lckhUTUwgPSB2YWx1ZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmKG5hbWUgPT09ICdjbGFzcycpIHtcclxuICAgICAgICBpZighdmFsdWUgfHwgdHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJykge1xyXG4gICAgICAgICAgICBub2RlLmNsYXNzTmFtZSA9IHZhbHVlIHx8ICcnO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmKHZhbHVlICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcpIHtcclxuICAgICAgICAgICAgaWYodHlwZW9mIG9sZCA9PT0gJ29iamVjdCcpIHtcclxuICAgICAgICAgICAgICAgIGZvcihsZXQgaSBpbiBvbGQpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIShpIGluIHZhbHVlKSkgbm9kZS5jbGFzc0xpc3QucmVtb3ZlKGkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGZvcihsZXQgaSBpbiB2YWx1ZSkgIHtcclxuICAgICAgICAgICAgICAgIGlmKHZhbHVlW2ldKSBub2RlLmNsYXNzTGlzdC5hZGQoaSk7XHJcbiAgICAgICAgICAgICAgICBlbHNlIG5vZGUuY2xhc3NMaXN0LnJlbW92ZShpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGVsc2UgaWYobmFtZSA9PT0gJ3N0eWxlJykge1xyXG4gICAgICAgIGlmKHZhbHVlICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcpIHtcclxuICAgICAgICAgICAgaWYodHlwZW9mIG9sZCA9PT0gJ29iamVjdCcpIHtcclxuICAgICAgICAgICAgICAgIGZvcihsZXQgaSBpbiBvbGQpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIShpIGluIHZhbHVlKSkgbm9kZS5zdHlsZVtpXSA9ICcnO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Ugbm9kZS5zdHlsZS5jc3NUZXh0ID0gJyc7XHJcbiAgICAgICAgICAgIGZvcihsZXQgaSBpbiB2YWx1ZSkgbm9kZS5zdHlsZVtpXSA9IHZhbHVlW2ldIHx8ICcnO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmKCF2YWx1ZSB8fCB0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnIHx8IHR5cGVvZiBvbGQgPT09ICdzdHJpbmcnKSB7XHJcbiAgICAgICAgICAgIG5vZGUuc3R5bGUuY3NzVGV4dCA9IHZhbHVlIHx8ICcnO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGVsc2UgaWYobmFtZVswXSA9PT0gJ28nICYmIG5hbWVbMV0gPT09ICduJykge1xyXG4gICAgICAgIGxldCB1c2VDYXB0dXJlID0gbmFtZSAhPT0gKG5hbWUgPSBuYW1lLnJlcGxhY2UoL0NhcHR1cmUkLywgJycpKTtcclxuICAgICAgICBuYW1lID0gbmFtZS50b0xvd2VyQ2FzZSgpLnN1YnN0cmluZygyKTtcclxuICAgICAgICBpZih2YWx1ZSkge1xyXG4gICAgICAgICAgICBpZighb2xkKSBub2RlLmFkZEV2ZW50TGlzdGVuZXIobmFtZSwgdmFsdWUsIHVzZUNhcHR1cmUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmKG9sZCkgbm9kZS5yZW1vdmVFdmVudExpc3RlbmVyKG5hbWUsIG9sZCwgdXNlQ2FwdHVyZSk7XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmKG5hbWUgIT09ICdsaXN0JyAmJiBuYW1lICE9PSAndHlwZScgJiYgbmFtZSBpbiBub2RlKSB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgbm9kZVtuYW1lXSA9IHZhbHVlID09IG51bGwgPyAnJyA6IHZhbHVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICBpZigodmFsdWUgPT0gbnVsbCB8fCB2YWx1ZSA9PT0gZmFsc2UpICYmIG5hbWUgIT09ICdzcGVsbGNoZWNrJykgbm9kZS5yZW1vdmVBdHRyaWJ1dGUobmFtZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgaWYodmFsdWUgPT0gbnVsbCB8fCB2YWx1ZSA9PT0gZmFsc2UpIG5vZGUucmVtb3ZlQXR0cmlidXRlKG5hbWUpO1xyXG4gICAgICAgIGVsc2UgaWYodHlwZW9mIHZhbHVlICE9PSAnZnVuY3Rpb24nKSBub2RlLnNldEF0dHJpYnV0ZShuYW1lLCB2YWx1ZSk7XHJcbiAgICB9XHJcbn0iLCIndXNlIHN0cmljdCc7XHJcblxyXG5pbXBvcnQgQ29tcG9uZW50LCB7IGJ1aWxkQ29tcG9uZW50IH0gZnJvbSAnLi4vY29tcG9uZW50JztcclxuaW1wb3J0IFZOb2RlIGZyb20gJy4vdm5vZGUnO1xyXG5pbXBvcnQge0FUVFJfS0VZfSBmcm9tICcuLi9jb25zdGFudHMnO1xyXG5pbXBvcnQge2NyZWF0ZU5vZGUsIHNldEFjY2Vzc29yLCBpc1NhbWVOb2RlVHlwZSwgcmVtb3ZlTm9kZX0gZnJvbSAnLi4vcmVhZGFwdC1kb20vaW5kZXgnO1xyXG5pbXBvcnQge3VubW91bnRDb21wb25lbnR9IGZyb20gJy4uL2NvbXBvbmVudCc7XHJcbmltcG9ydCB7RE9NfSBmcm9tICcuLi9yZWFkYXB0LWRvbS9pbmRleCc7XHJcblxyXG5leHBvcnQgY29uc3QgaW5wdXRzIDogYW55ID0gW1xyXG4gICAgJ2lucHV0JyxcclxuICAgICd0ZXh0YXJlYScsXHJcbiAgICAnc2VsZWN0JyxcclxuICAgICdtZXRlcicsXHJcbiAgICAncHJvZ3Jlc3MnLFxyXG4gICAgJ2J1dHRvbidcclxuXTtcclxuXHJcbmV4cG9ydCBsZXQgaHlkcmF0aW5nID0gZmFsc2U7XHJcbmV4cG9ydCBsZXQgZGlmZkxldmVsID0gMDtcclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkaWZmKGRvbTogYW55LCBub2RlOiBWTm9kZSwgcGFyZW50OiBhbnksIHJvb3Q6IGJvb2xlYW4pIHtcclxuICAgIGxldCByZXQgOiBhbnkgPSBudWxsO1xyXG4gICAgaWYoIWRpZmZMZXZlbCsrKSBoeWRyYXRpbmcgPSBkb20gJiYgIWRvbVtBVFRSX0tFWV07XHJcblxyXG4gICAgcmV0ID0gYXdhaXQgaWRpZmYoZG9tLCBub2RlLCBwYXJlbnQsIHJvb3QpO1xyXG4gICAgaWYocGFyZW50ICYmIHJldC5wYXJlbnROb2RlICE9PSBwYXJlbnQpIHBhcmVudC5hcHBlbmRDaGlsZChyZXQpO1xyXG5cclxuICAgIGlmKCEtLWRpZmZMZXZlbCkge1xyXG4gICAgICAgIGh5ZHJhdGluZyA9IGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiByZXQ7XHJcbn1cclxuXHJcbmFzeW5jIGZ1bmN0aW9uIGlkaWZmKGRvbTogYW55LCBub2RlOiBWTm9kZSwgcGFyZW50OiBhbnksIHJvb3Q6IGJvb2xlYW4pIHtcclxuICAgIGxldCBvdXQgOiBhbnkgPSBkb207XHJcbiAgICBpZihub2RlLm5vZGVWYWx1ZSA9PSBudWxsIHx8IHR5cGVvZiBub2RlLm5vZGVWYWx1ZSA9PT0gJ2Jvb2xlYW4nKSBub2RlLm5vZGVWYWx1ZSA9ICcnO1xyXG4gICAgaWYobm9kZS5ub2RlVHlwZSA9PT0gJ3RleHQnKSB7XHJcbiAgICAgICAgaWYoZG9tICYmIGRvbS5zcGxpdFRleHQgJiYgZG9tLnBhcmVudE5vZGUgJiYgKCFkb20uX2NvbXBvbmVudCB8fCByb290KSkge1xyXG4gICAgICAgICAgICBpZihkb20ubm9kZVZhbHVlICE9IG5vZGUubm9kZVZhbHVlKSBkb20ubm9kZVZhbHVlID0gbm9kZS5ub2RlVmFsdWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBvdXQgPSBET00uZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUobm9kZS5ub2RlVmFsdWUpO1xyXG4gICAgICAgICAgICBpZihkb20pIHtcclxuICAgICAgICAgICAgICAgIGlmKGRvbS5wYXJlbnROb2RlKSBkb20ucGFyZW50Tm9kZS5yZXBsYWNlQ2hpbGQob3V0LCBkb20pO1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgcmVjb2xsZWN0Tm9kZVRyZWUoZG9tLCBmYWxzZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIG91dFtBVFRSX0tFWV0gPSB7fTtcclxuICAgICAgICByZXR1cm4gb3V0O1xyXG4gICAgfVxyXG5cclxuICAgIGxldCBub2RlTmFtZSA6IGFueSA9IG5vZGUubm9kZU5hbWUsIG5yb290O1xyXG4gICAgaWYodHlwZW9mIG5vZGVOYW1lID09PSAnZnVuY3Rpb24nKSByZXR1cm4gYXdhaXQgYnVpbGRDb21wb25lbnQoZG9tLCBub2RlLCBwYXJlbnQsIGh5ZHJhdGluZyk7XHJcbiAgICBpZighZG9tIHx8IGRvbS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpICE9PSBub2RlTmFtZS50b0xvd2VyQ2FzZSgpKSB7XHJcbiAgICAgICAgb3V0ID0gY3JlYXRlTm9kZShub2RlTmFtZSk7XHJcbiAgICAgICAgaWYoZG9tKSB7XHJcbiAgICAgICAgICAgIHdoaWxlKGRvbS5maXJzdENoaWxkKSBvdXQuYXBwZW5kQ2hpbGQoZG9tLmZpcnN0Q2hpbGQpO1xyXG4gICAgICAgICAgICBpZihkb20ucGFyZW50Tm9kZSkgZG9tLnBhcmVudE5vZGUucmVwbGFjZUNoaWxkKG91dCwgZG9tKTtcclxuXHJcbiAgICAgICAgICAgIC8vcmVjb2xsZWN0XHJcbiAgICAgICAgICAgIGF3YWl0IHJlY29sbGVjdE5vZGVUcmVlKGRvbSwgZmFsc2UpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGxldCBwcm9wcyA6IGFueSA9IG91dFtBVFRSX0tFWV07XHJcbiAgICBpZighcHJvcHMpIHtcclxuICAgICAgICBwcm9wcyA9IG91dFtBVFRSX0tFWV0gPSB7fTtcclxuICAgICAgICBvdXQuZ2V0QXR0cmlidXRlTmFtZXMoKS5mb3JFYWNoKG4gPT4gcHJvcHNbbl0gPSBvdXQuZ2V0QXR0cmlidXRlKG4pKTtcclxuICAgIH1cclxuXHJcbiAgICBsZXQgZmMgPSBvdXQuZmlyc3RDaGlsZCwgY2hpbGRyZW4gPSBub2RlLmNoaWxkTm9kZXM7XHJcbiAgICBpZigoY2hpbGRyZW4gJiYgY2hpbGRyZW4ubGVuZ3RoKSB8fCBmYykgYXdhaXQgaW5uZXJEaWZmTm9kZShvdXQsIGNoaWxkcmVuLCByb290KTtcclxuXHJcbiAgICBkaWZmQXR0cmlidXRlcyhvdXQsIG5vZGUuYXR0cmlidXRlcywgcHJvcHMpO1xyXG5cclxuICAgIHJldHVybiBvdXQ7XHJcbn1cclxuXHJcbmFzeW5jIGZ1bmN0aW9uIGlubmVyRGlmZk5vZGUoZG9tLCB2Y2hpbGRyZW46IEFycmF5PFZOb2RlPiwgcm9vdDogYm9vbGVhbikge1xyXG5cdGxldCBvcmlnaW5hbENoaWxkcmVuID0gZG9tLmNoaWxkTm9kZXMsXHJcblx0XHRjaGlsZHJlbiA9IEFycmF5PGFueT4oKSxcclxuXHRcdGtleWVkID0ge30sXHJcblx0XHRrZXllZExlbiA9IDAsXHJcblx0XHRtaW4gPSAwLFxyXG5cdFx0bGVuID0gb3JpZ2luYWxDaGlsZHJlbi5sZW5ndGgsXHJcblx0XHRjaGlsZHJlbkxlbiA9IDAsXHJcblx0XHR2bGVuID0gdmNoaWxkcmVuID8gdmNoaWxkcmVuLmxlbmd0aCA6IDAsXHJcblx0XHRqLCBjLCBmLCB2Y2hpbGQsIGNoaWxkO1xyXG5cclxuXHQvLyBCdWlsZCB1cCBhIG1hcCBvZiBrZXllZCBjaGlsZHJlbiBhbmQgYW4gQXJyYXkgb2YgdW5rZXllZCBjaGlsZHJlbjpcclxuXHRpZiAobGVuIT09MCkge1xyXG5cdFx0Zm9yIChsZXQgaT0wOyBpPGxlbjsgaSsrKSB7XHJcblx0XHRcdGxldCBjaGlsZCA9IG9yaWdpbmFsQ2hpbGRyZW5baV0sXHJcblx0XHRcdFx0cHJvcHMgPSBjaGlsZFtBVFRSX0tFWV0sXHJcblx0XHRcdFx0a2V5ID0gdmxlbiAmJiBwcm9wcyA/IGNoaWxkLl9jb21wb25lbnQgPyBjaGlsZC5fY29tcG9uZW50LmtleSA6IHByb3BzLmtleSA6IG51bGw7XHJcblx0XHRcdGlmIChrZXkhPW51bGwpIHtcclxuXHRcdFx0XHRrZXllZExlbisrO1xyXG5cdFx0XHRcdGtleWVkW2tleV0gPSBjaGlsZDtcclxuXHRcdFx0fVxyXG5cdFx0XHRlbHNlIGlmIChwcm9wcyB8fCAoY2hpbGQuc3BsaXRUZXh0IT09dW5kZWZpbmVkID8gKGh5ZHJhdGluZyA/IGNoaWxkLm5vZGVWYWx1ZS50cmltKCkgOiB0cnVlKSA6IGh5ZHJhdGluZykpIHtcclxuXHRcdFx0XHRjaGlsZHJlbltjaGlsZHJlbkxlbisrXSA9IGNoaWxkO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHRpZiAodmxlbiE9PTApIHtcclxuXHRcdGZvciAobGV0IGk9MDsgaTx2bGVuOyBpKyspIHtcclxuXHRcdFx0dmNoaWxkID0gdmNoaWxkcmVuW2ldO1xyXG5cdFx0XHRjaGlsZCA9IG51bGw7XHJcblxyXG5cdFx0XHQvLyBhdHRlbXB0IHRvIGZpbmQgYSBub2RlIGJhc2VkIG9uIGtleSBtYXRjaGluZ1xyXG5cdFx0XHRsZXQga2V5ID0gdmNoaWxkLmtleTtcclxuXHRcdFx0aWYgKGtleSE9bnVsbCkge1xyXG5cdFx0XHRcdGlmIChrZXllZExlbiAmJiBrZXllZFtrZXldIT09dW5kZWZpbmVkKSB7XHJcblx0XHRcdFx0XHRjaGlsZCA9IGtleWVkW2tleV07XHJcblx0XHRcdFx0XHRrZXllZFtrZXldID0gdW5kZWZpbmVkO1xyXG5cdFx0XHRcdFx0a2V5ZWRMZW4tLTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdFx0Ly8gYXR0ZW1wdCB0byBwbHVjayBhIG5vZGUgb2YgdGhlIHNhbWUgdHlwZSBmcm9tIHRoZSBleGlzdGluZyBjaGlsZHJlblxyXG5cdFx0XHRlbHNlIGlmIChtaW48Y2hpbGRyZW5MZW4pIHtcclxuXHRcdFx0XHRmb3IgKGo9bWluOyBqPGNoaWxkcmVuTGVuOyBqKyspIHtcclxuXHRcdFx0XHRcdGlmIChjaGlsZHJlbltqXSE9PXVuZGVmaW5lZCAmJiBpc1NhbWVOb2RlVHlwZShjID0gY2hpbGRyZW5bal0sIHZjaGlsZCwgaHlkcmF0aW5nKSkge1xyXG5cdFx0XHRcdFx0XHRjaGlsZCA9IGM7XHJcblx0XHRcdFx0XHRcdGNoaWxkcmVuW2pdID0gdW5kZWZpbmVkO1xyXG5cdFx0XHRcdFx0XHRpZiAoaj09PWNoaWxkcmVuTGVuLTEpIGNoaWxkcmVuTGVuLS07XHJcblx0XHRcdFx0XHRcdGlmIChqPT09bWluKSBtaW4rKztcclxuXHRcdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHQvLyBtb3JwaCB0aGUgbWF0Y2hlZC9mb3VuZC9jcmVhdGVkIERPTSBjaGlsZCB0byBtYXRjaCB2Y2hpbGQgKGRlZXApXHJcblx0XHRcdGNoaWxkID0gYXdhaXQgaWRpZmYoY2hpbGQsIHZjaGlsZCwgZG9tLCByb290KTtcclxuXHJcblx0XHRcdGYgPSBvcmlnaW5hbENoaWxkcmVuW2ldO1xyXG5cdFx0XHRpZiAoY2hpbGQgJiYgY2hpbGQhPT1kb20gJiYgY2hpbGQhPT1mKSB7XHJcblx0XHRcdFx0aWYgKGY9PW51bGwpIHtcclxuXHRcdFx0XHRcdGRvbS5hcHBlbmRDaGlsZChjaGlsZCk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGVsc2UgaWYgKGNoaWxkPT09Zi5uZXh0U2libGluZykge1xyXG5cdFx0XHRcdFx0cmVtb3ZlTm9kZShmKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0ZWxzZSB7XHJcblx0XHRcdFx0XHRkb20uaW5zZXJ0QmVmb3JlKGNoaWxkLCBmKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9XHJcblxyXG5cclxuXHQvLyByZW1vdmUgdW51c2VkIGtleWVkIGNoaWxkcmVuOlxyXG5cdGlmIChrZXllZExlbikge1xyXG5cdFx0Zm9yIChsZXQgaSBpbiBrZXllZCkgaWYgKGtleWVkW2ldIT09dW5kZWZpbmVkKSBhd2FpdCByZWNvbGxlY3ROb2RlVHJlZShrZXllZFtpXSwgZmFsc2UpO1xyXG5cdH1cclxuXHJcblx0Ly8gcmVtb3ZlIG9ycGhhbmVkIHVua2V5ZWQgY2hpbGRyZW46XHJcblx0d2hpbGUgKG1pbjw9Y2hpbGRyZW5MZW4pIHtcclxuXHRcdGlmICgoY2hpbGQgPSBjaGlsZHJlbltjaGlsZHJlbkxlbi0tXSkhPT11bmRlZmluZWQpIGF3YWl0IHJlY29sbGVjdE5vZGVUcmVlKGNoaWxkLCBmYWxzZSk7XHJcblx0fVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcmVjb2xsZWN0Tm9kZVRyZWUobm9kZTogYW55LCB1bm1vdW50T25seTogYm9vbGVhbikge1xyXG4gICAgaWYoIW5vZGUpIHJldHVybjtcclxuICAgIGxldCBjb21wb25lbnQgPSBub2RlLl9jb21wb25lbnQ7XHJcbiAgICBpZihjb21wb25lbnQpIGF3YWl0IHVubW91bnRDb21wb25lbnQoY29tcG9uZW50KTtcclxuICAgIGlmKG5vZGVbQVRUUl9LRVldICYmIG5vZGVbQVRUUl9LRVldLnJlZikgbm9kZVtBVFRSX0tFWV0ucmVmKG51bGwpO1xyXG4gICAgaWYodW5tb3VudE9ubHkgPT09IGZhbHNlIHx8IG5vZGVbQVRUUl9LRVldKSByZW1vdmVOb2RlKG5vZGUpO1xyXG4gICAgYXdhaXQgcmVtb3ZlQ2hpbGRyZW4obm9kZSk7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZW1vdmVDaGlsZHJlbihub2RlOiBhbnkpIHtcclxuICAgIG5vZGUgPSBub2RlLmxhc3RDaGlsZDtcclxuICAgIHdoaWxlKG5vZGUpIHtcclxuICAgICAgICBsZXQgbmV4dCA9IG5vZGUucHJldmlvdXNTaWJsaW5nO1xyXG4gICAgICAgIGF3YWl0IHJlY29sbGVjdE5vZGVUcmVlKG5vZGUsIHRydWUpO1xyXG4gICAgICAgIG5vZGUgPSBuZXh0O1xyXG4gICAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBkaWZmQXR0cmlidXRlcyhkb206IGFueSwgYXR0cnM6IGFueSwgb2xkOiBhbnkpIHtcclxuICAgIGxldCBuYW1lO1xyXG4gICAgZm9yKG5hbWUgaW4gb2xkKSB7XHJcbiAgICAgICAgaWYoIShhdHRycyAmJiBhdHRyc1tuYW1lXSAhPSBudWxsKSAmJiBvbGRbbmFtZV0gIT0gbnVsbCkgc2V0QWNjZXNzb3IoZG9tLCBuYW1lLCBvbGQsIG9sZFtuYW1lXSA9IHVuZGVmaW5lZCk7XHJcbiAgICB9XHJcbiAgICBmb3IobmFtZSBpbiBhdHRycykge1xyXG4gICAgICAgIGlmKG5hbWUgIT09ICdjaGlsZHJlbicgJiYgbmFtZSAhPT0gJ2lubmVySFRNTCcgXHJcbiAgICAgICAgICAgICYmIChhdHRyc1tuYW1lXSAhPT0gKChuYW1lID09PSAndmFsdWUnIHx8IG5hbWUgPT09ICdjaGVja2VkJykgPyBkb21bbmFtZV0gOiBvbGRbbmFtZV0pKSkgc2V0QWNjZXNzb3IoZG9tLCBuYW1lLCBvbGRbbmFtZV0sIG9sZFtuYW1lXSA9IGF0dHJzW25hbWVdKTsgXHJcbiAgICB9XHJcbn0iLCIndXNlIHN0cmljdCc7XHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFZOb2RlIHtcclxuICAgIGF0dHJpYnV0ZXM6IGFueTtcclxuICAgIG5vZGVOYW1lOiBhbnk7XHJcbiAgICBub2RlVHlwZTogc3RyaW5nO1xyXG4gICAgbm9kZVZhbHVlOiBhbnk7XHJcbiAgICBjaGlsZE5vZGVzOiBBcnJheTxhbnk+O1xyXG4gICAga2V5OiBhbnk7XHJcblxyXG4gICAgY29uc3RydWN0b3IobmFtZTogYW55LCB0eXBlOiBzdHJpbmcsIHY6IGFueSApIHtcclxuICAgICAgICB0aGlzLm5vZGVOYW1lID0gbmFtZTtcclxuICAgICAgICB0aGlzLm5vZGVUeXBlID0gdHlwZTtcclxuICAgICAgICB0aGlzLm5vZGVWYWx1ZSA9IHY7XHJcbiAgICAgICAgdGhpcy5jaGlsZE5vZGVzID0gQXJyYXk8YW55PigwKTtcclxuICAgIH1cclxufSIsIid1c2Ugc3RyaWN0JztcclxuXHJcbmltcG9ydCBDb21wb25lbnQsIHsgREVGRVJfUFJPTUlTRSwgcmVuZGVyQ29tcG9uZW50IH0gZnJvbSAnLi9jb21wb25lbnQnO1xyXG5pbXBvcnQgVk5vZGUgZnJvbSAnLi9yZWFkYXB0LXZkb20vdm5vZGUnO1xyXG5pbXBvcnQgeyBkaWZmIH0gZnJvbSAnLi9yZWFkYXB0LXZkb20vZGlmZic7XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZW5xdWV1ZShjb21wb25lbnQ6IENvbXBvbmVudCkge1xyXG4gICAgKGNvbXBvbmVudC5hc3luY01ldGhvZCB8fCBERUZFUl9QUk9NSVNFKShhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgYXdhaXQgcmVuZGVyQ29tcG9uZW50KGNvbXBvbmVudCwgY29tcG9uZW50LnBhcmVudE5vZGUsIGZhbHNlKTtcclxuICAgIH0pO1xyXG59XHJcbmV4cG9ydCBmdW5jdGlvbiBlbnF1ZXVlU3RhdGUoY29tcG9uZW50OiBDb21wb25lbnQsIHN0YXRlOiBQcm9taXNlPGFueT4pIHtcclxuICAgIChjb21wb25lbnQuYXN5bmNNZXRob2QgfHwgREVGRVJfUFJPTUlTRSkoYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgIGF3YWl0IHN0YXRlO1xyXG4gICAgfSk7XHJcbn1cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGh5ZHJhdGUobm9kZTogVk5vZGUsIHBhcmVudDogYW55KSB7XHJcbiAgICByZXR1cm4gYXdhaXQgcmVuZGVyKG5vZGUsIHBhcmVudCwgcGFyZW50LmZpcnN0RWxlbWVudENoaWxkKTtcclxufVxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcmVuZGVyKG5vZGU6IFZOb2RlLCBwYXJlbnQ6IGFueSwgbWVyZ2U6IGFueSkge1xyXG4gICAgcmV0dXJuIGF3YWl0IGRpZmYobWVyZ2UsIG5vZGUsIHBhcmVudCwgdHJ1ZSk7XHJcbn0iXSwic291cmNlUm9vdCI6IiJ9