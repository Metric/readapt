/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, { enumerable: true, get: getter });
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = function(exports) {
/******/ 		if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 			Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 		}
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// create a fake namespace object
/******/ 	// mode & 1: value is a module id, require it
/******/ 	// mode & 2: merge all properties of value into the ns
/******/ 	// mode & 4: return value when already ns object
/******/ 	// mode & 8|1: behave like require
/******/ 	__webpack_require__.t = function(value, mode) {
/******/ 		if(mode & 1) value = __webpack_require__(value);
/******/ 		if(mode & 8) return value;
/******/ 		if((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;
/******/ 		var ns = Object.create(null);
/******/ 		__webpack_require__.r(ns);
/******/ 		Object.defineProperty(ns, 'default', { enumerable: true, value: value });
/******/ 		if(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));
/******/ 		return ns;
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = "./src/client.js");
/******/ })
/************************************************************************/
/******/ ({

/***/ "./src/client.js":
/*!***********************!*\
  !*** ./src/client.js ***!
  \***********************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _h__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./h */ "./src/h.ts");
/* harmony import */ var _component__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./component */ "./src/component.ts");
/* harmony import */ var _readapt_dom_index__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./readapt-dom/index */ "./src/readapt-dom/index.ts");
/* harmony import */ var _render__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./render */ "./src/render.ts");





_readapt_dom_index__WEBPACK_IMPORTED_MODULE_2__["DOM"].document = document;
window.h = _h__WEBPACK_IMPORTED_MODULE_0__["h"];
window.Component = _component__WEBPACK_IMPORTED_MODULE_1__["default"];
window.Readapt = {
    render: _render__WEBPACK_IMPORTED_MODULE_3__["render"],
    hydrate: _render__WEBPACK_IMPORTED_MODULE_3__["hydrate"]
};
window.React = {
    createElement: _h__WEBPACK_IMPORTED_MODULE_0__["h"],
    render: _render__WEBPACK_IMPORTED_MODULE_3__["render"],
    hydrate: _render__WEBPACK_IMPORTED_MODULE_3__["hydrate"]
};


/***/ }),

/***/ "./src/component.ts":
/*!**************************!*\
  !*** ./src/component.ts ***!
  \**************************/
/*! exports provided: DEFER_PROMISE, DEFER_TIMEOUT, DEFER_ANIMATION, default, renderComponent, prepareRender, unmountComponent, buildComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DEFER_PROMISE", function() { return DEFER_PROMISE; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DEFER_TIMEOUT", function() { return DEFER_TIMEOUT; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DEFER_ANIMATION", function() { return DEFER_ANIMATION; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return Component; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "renderComponent", function() { return renderComponent; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "prepareRender", function() { return prepareRender; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "unmountComponent", function() { return unmountComponent; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "buildComponent", function() { return buildComponent; });
/* harmony import */ var _constants__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./constants */ "./src/constants.ts");
/* harmony import */ var _readapt_vdom_diff__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./readapt-vdom/diff */ "./src/readapt-vdom/diff.ts");
/* harmony import */ var _render__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./render */ "./src/render.ts");

var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};



const DEFER_PROMISE = Promise.resolve().then.bind(Promise.resolve());
const DEFER_TIMEOUT = setTimeout;
const DEFER_ANIMATION = typeof requestAnimationFrame !== 'undefined' ? requestAnimationFrame : DEFER_PROMISE;
class Component {
    constructor(props, parent, renderMode) {
        this.disabled = false;
        this.key = props.key;
        this.ref = props.ref;
        this.asyncMethod = DEFER_PROMISE;
        this.renderMode = renderMode || _constants__WEBPACK_IMPORTED_MODULE_0__["SYNC"];
        this.child = null;
        this.base = null;
        this.parent = parent;
        this.parentNode = null;
        this.children = [];
        this.state = {};
        this.__props = props;
        delete props.ref;
        delete props.key;
        this.observe(props);
    }
    componentChange(key, value, previous) {
        return __awaiter(this, void 0, void 0, function* () {
            if (this.shouldComponentUpdate(key, value, previous)) {
                if (this.renderMode === _constants__WEBPACK_IMPORTED_MODULE_0__["SYNC"])
                    yield renderComponent(this, this.parentNode, false);
                else if (this.renderMode === _constants__WEBPACK_IMPORTED_MODULE_0__["ASYNC"])
                    Object(_render__WEBPACK_IMPORTED_MODULE_2__["enqueue"])(this);
            }
        });
    }
    forceUpdate() {
        return __awaiter(this, void 0, void 0, function* () {
            yield renderComponent(this, this.parentNode, false);
        });
    }
    componentDidUpdate(previous) {
        return __awaiter(this, void 0, void 0, function* () {
        });
    }
    render() {
        return __awaiter(this, void 0, void 0, function* () {
        });
    }
    componentWillUnmount() {
        return __awaiter(this, void 0, void 0, function* () {
        });
    }
    componentDidMount() {
        return __awaiter(this, void 0, void 0, function* () {
        });
    }
    setState(sm) {
        return __awaiter(this, void 0, void 0, function* () {
            const update = new Promise((r, rj) => __awaiter(this, void 0, void 0, function* () {
                //immutable from original state
                const oldState = Object(_constants__WEBPACK_IMPORTED_MODULE_0__["extend"])({}, this.state);
                const finalState = Object(_constants__WEBPACK_IMPORTED_MODULE_0__["extend"])({}, this.state);
                let newState = {};
                if (typeof sm === 'function') {
                    //copy current props for immutable
                    const props = {};
                    if (this.__props) {
                        for (let k in this.__props)
                            props[k] = this[k];
                    }
                    //immutable from original state
                    newState = sm(Object(_constants__WEBPACK_IMPORTED_MODULE_0__["extend"])(newState, this.state), props) || newState;
                    Object(_constants__WEBPACK_IMPORTED_MODULE_0__["extend"])(finalState, newState);
                }
                else if (typeof sm === 'object')
                    Object(_constants__WEBPACK_IMPORTED_MODULE_0__["extend"])(finalState, sm);
                this.state = finalState;
                for (let k in finalState) {
                    if (oldState[k] !== finalState[k])
                        yield this.componentChange(k, newState[k], oldState[k]);
                }
                r();
            }));
            if (this.renderMode === _constants__WEBPACK_IMPORTED_MODULE_0__["SYNC"])
                yield update;
            else if (this.renderMode === _constants__WEBPACK_IMPORTED_MODULE_0__["ASYNC"])
                Object(_render__WEBPACK_IMPORTED_MODULE_2__["enqueueState"])(this, update);
        });
    }
    shouldComponentUpdate(key, value, previous) {
        return true;
    }
    observe(o) {
        for (let k in o) {
            let v = o[k];
            if (typeof v === 'function') {
                this[k] = v;
                continue;
            }
            Object.defineProperty(this, `\$${k}`, { value: v, writable: true, enumerable: false });
            Object.defineProperty(this, k, {
                enumerable: true,
                get() {
                    return this[`\$${k}`];
                },
                set(nv) {
                    const prev = this[`\$${k}`];
                    this[`\$${k}`] = nv;
                    if (!this.disabled && prev !== nv) {
                        this.componentChange(k, nv, prev);
                    }
                }
            });
        }
    }
}
function renderComponent(component, parentNode, hydrating) {
    return __awaiter(this, void 0, void 0, function* () {
        let isUpdate = component.base, p, props, rendered, toUnmount, cbase, inst, base, type;
        if (component.disabled)
            return;
        rendered = yield component.render();
        if (!rendered || Array.isArray(rendered)) {
            if (component.child) {
                yield unmountComponent(component.child);
                component.child = null;
            }
            if (component.base) {
                component.base._component = null;
                yield Object(_readapt_vdom_diff__WEBPACK_IMPORTED_MODULE_1__["recollectNodeTree"])(component.base, false);
                component.base = null;
            }
            return;
        }
        component.parentNode = parentNode;
        cbase = base = component.base;
        if (typeof rendered.nodeName === 'function') {
            props = rendered.attributes;
            inst = component.child;
            if (inst && inst.constructor === rendered.nodeName) {
                const update = prepareRender(inst, props, rendered.childNodes);
                if (update._different) {
                    yield renderComponent(inst, inst.parentNode, hydrating);
                    yield inst.componentDidUpdate(update);
                }
            }
            else {
                toUnmount = inst;
                type = rendered.nodeName;
                if (cbase && !toUnmount && !hydrating) {
                    cbase._component = null;
                    yield Object(_readapt_vdom_diff__WEBPACK_IMPORTED_MODULE_1__["recollectNodeTree"])(cbase, false);
                }
                component.child = inst = new type(props, component);
                if (hydrating)
                    inst.base = cbase;
                inst.children = rendered.childNodes;
                if (inst.ref)
                    inst.ref(inst);
                yield renderComponent(inst, component.parentNode, hydrating);
            }
            base = inst.base;
        }
        if (typeof rendered.nodeName !== 'function') {
            toUnmount = component.child;
            if (toUnmount)
                cbase = component.child = null;
            base = yield Object(_readapt_vdom_diff__WEBPACK_IMPORTED_MODULE_1__["diff"])(cbase, rendered, component.parentNode, true);
        }
        if (cbase && base !== cbase && inst !== component.child) {
            p = cbase.parentNode;
            if (p && base !== p) {
                p.replaceChild(base, cbase);
                if (!toUnmount) {
                    cbase._component = null;
                    yield Object(_readapt_vdom_diff__WEBPACK_IMPORTED_MODULE_1__["recollectNodeTree"])(cbase, false);
                }
            }
        }
        if (toUnmount)
            yield unmountComponent(toUnmount);
        component.base = base;
        if (base && !component.child) {
            let cmp = component, t = component;
            while ((t = t.parent)) {
                (cmp = t).base = base;
            }
            base._component = cmp;
        }
        if (!isUpdate) {
            yield component.componentDidMount();
        }
    });
}
function prepareRender(inst, props, children) {
    let diff = { _different: false };
    if (inst.ref)
        inst.ref(inst);
    inst.children = children;
    inst.disabled = true;
    for (let n in props) {
        if (inst[n] !== props[n]) {
            diff[n] = inst[n];
            diff._different = true;
        }
        inst[n] = props[n];
    }
    inst.disabled = false;
    return diff;
}
function unmountComponent(component) {
    return __awaiter(this, void 0, void 0, function* () {
        const base = component.base;
        component.disabled = true;
        yield component.componentWillUnmount();
        if (component.child)
            yield unmountComponent(component.child);
        component.base = null;
        component.parent = null;
        component.child = null;
        if (base) {
            base._component = null;
            if (base[_constants__WEBPACK_IMPORTED_MODULE_0__["ATTR_KEY"]] && base[_constants__WEBPACK_IMPORTED_MODULE_0__["ATTR_KEY"]].ref)
                base[_constants__WEBPACK_IMPORTED_MODULE_0__["ATTR_KEY"]].ref(null);
            yield Object(_readapt_vdom_diff__WEBPACK_IMPORTED_MODULE_1__["recollectNodeTree"])(base, false);
        }
        if (component.ref)
            component.ref(null);
    });
}
function buildComponent(dom, node, parentNode, hydrating) {
    return __awaiter(this, void 0, void 0, function* () {
        let c = dom && dom._component, isDirectOwner = c && c.constructor === node.nodeName, props = node.attributes, type = node.nodeName;
        if (isDirectOwner && c) {
            const update = prepareRender(c, props, node.childNodes);
            if (update._different) {
                yield renderComponent(c, parentNode, hydrating);
                yield c.componentDidUpdate(update);
            }
            dom = c.base;
        }
        else {
            if (!hydrating)
                yield Object(_readapt_vdom_diff__WEBPACK_IMPORTED_MODULE_1__["recollectNodeTree"])(dom, false);
            c = new type(props, null);
            c.children = node.childNodes;
            if (hydrating)
                c.base = dom;
            if (c.ref)
                c.ref(c);
            yield renderComponent(c, parentNode, hydrating);
            dom = c.base;
        }
        return dom;
    });
}


/***/ }),

/***/ "./src/constants.ts":
/*!**************************!*\
  !*** ./src/constants.ts ***!
  \**************************/
/*! exports provided: ATTR_KEY, ASYNC, SYNC, NONE, FORCE, extend */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ATTR_KEY", function() { return ATTR_KEY; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ASYNC", function() { return ASYNC; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SYNC", function() { return SYNC; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "NONE", function() { return NONE; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FORCE", function() { return FORCE; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "extend", function() { return extend; });

const ATTR_KEY = '__readapt__';
const ASYNC = 3;
const SYNC = 1;
const NONE = 0;
const FORCE = 2;
function extend(base, ref) {
    for (let k in ref)
        base[k] = ref[k];
    return base;
}
;


/***/ }),

/***/ "./src/h.ts":
/*!******************!*\
  !*** ./src/h.ts ***!
  \******************/
/*! exports provided: h */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "h", function() { return h; });
/* harmony import */ var _readapt_vdom_vnode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./readapt-vdom/vnode */ "./src/readapt-vdom/vnode.ts");


function h(nodeName, attributes, ...children) {
    attributes = attributes || {};
    const stack = Array(0);
    let child, p = new _readapt_vdom_vnode__WEBPACK_IMPORTED_MODULE_0__["default"](nodeName, typeof nodeName === 'function' ? 'component' : 'element', '');
    children.forEach(c => stack.unshift(c));
    if (attributes && attributes.children != null) {
        if (!stack.length)
            stack.push(attributes.children);
        delete attributes.children;
    }
    while (stack.length) {
        child = stack.pop();
        if (Array.isArray(child))
            child.forEach(c => stack.unshift(c));
        else {
            if (child instanceof _readapt_vdom_vnode__WEBPACK_IMPORTED_MODULE_0__["default"])
                p.childNodes.push(child);
            else
                p.childNodes.push(new _readapt_vdom_vnode__WEBPACK_IMPORTED_MODULE_0__["default"]('#text', 'text', child));
        }
    }
    p.attributes = attributes;
    p.key = attributes.key ? attributes.key : undefined;
    return p;
}
;


/***/ }),

/***/ "./src/readapt-dom/index.ts":
/*!**********************************!*\
  !*** ./src/readapt-dom/index.ts ***!
  \**********************************/
/*! exports provided: DOM, createNode, removeNode, isSameNodeType, setAccessor */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DOM", function() { return DOM; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "createNode", function() { return createNode; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "removeNode", function() { return removeNode; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "isSameNodeType", function() { return isSameNodeType; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "setAccessor", function() { return setAccessor; });

const DOM = {
    document: null
};
function createNode(nodeName) {
    return DOM.document.createElement(nodeName);
}
function removeNode(node) {
    const parentNode = node.parentNode;
    if (parentNode)
        parentNode.removeChild(node);
}
function isSameNodeType(node, vnode, hydrating) {
    if (!node)
        return false;
    if (vnode.nodeType === 'text')
        return node.splitText;
    if (typeof vnode.nodeName === 'string')
        return !node._component && node.nodeName.toLowerCase() === vnode.nodeName.toLowerCase();
    return hydrating || (node._component && node._component.constructor === vnode.nodeName);
}
function setAccessor(node, name, old, value) {
    if (name === 'className')
        name = 'class';
    if (name === '__html')
        name = 'html';
    if (name === 'key') {
        //do nothing
    }
    else if (name === 'ref') {
        if (old)
            old(null);
        if (value)
            value(node);
    }
    //please for the love of god
    //never use this unless you really have to
    //for showing mark down or something similar
    else if (name === 'html') {
        if (old !== value) {
            node.innerHTML = value;
        }
    }
    else if (name === 'class') {
        if (!value || typeof value === 'string') {
            node.className = value || '';
        }
        else if (value && typeof value === 'object') {
            if (typeof old === 'object') {
                for (let i in old) {
                    if (!(i in value))
                        node.classList.remove(i);
                }
            }
            for (let i in value) {
                if (value[i])
                    node.classList.add(i);
                else
                    node.classList.remove(i);
            }
        }
    }
    else if (name === 'style') {
        if (value && typeof value === 'object') {
            if (typeof old === 'object') {
                for (let i in old) {
                    if (!(i in value))
                        node.style[i] = '';
                }
            }
            else
                node.style.cssText = '';
            for (let i in value)
                node.style[i] = value[i] || '';
        }
        else if (!value || typeof value === 'string' || typeof old === 'string') {
            node.style.cssText = value || '';
        }
    }
    else if (name[0] === 'o' && name[1] === 'n') {
        let useCapture = name !== (name = name.replace(/Capture$/, ''));
        name = name.toLowerCase().substring(2);
        if (value) {
            if (!old)
                node.addEventListener(name, value, useCapture);
        }
        else if (old)
            node.removeEventListener(name, old, useCapture);
    }
    else if (name !== 'list' && name !== 'type' && name in node) {
        try {
            node[name] = value == null ? '' : value;
        }
        catch (e) {
            if ((value == null || value === false) && name !== 'spellcheck')
                node.removeAttribute(name);
        }
    }
    else {
        if (value == null || value === false)
            node.removeAttribute(name);
        else if (typeof value !== 'function')
            node.setAttribute(name, value);
    }
}


/***/ }),

/***/ "./src/readapt-vdom/diff.ts":
/*!**********************************!*\
  !*** ./src/readapt-vdom/diff.ts ***!
  \**********************************/
/*! exports provided: inputs, hydrating, diffLevel, diff, recollectNodeTree, removeChildren */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "inputs", function() { return inputs; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "hydrating", function() { return hydrating; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "diffLevel", function() { return diffLevel; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "diff", function() { return diff; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "recollectNodeTree", function() { return recollectNodeTree; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "removeChildren", function() { return removeChildren; });
/* harmony import */ var _component__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../component */ "./src/component.ts");
/* harmony import */ var _constants__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../constants */ "./src/constants.ts");
/* harmony import */ var _readapt_dom_index__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../readapt-dom/index */ "./src/readapt-dom/index.ts");

var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};





const inputs = [
    'input',
    'textarea',
    'select',
    'meter',
    'progress',
    'button'
];
let hydrating = false;
let diffLevel = 0;
function diff(dom, node, parent, root) {
    return __awaiter(this, void 0, void 0, function* () {
        let ret = null;
        if (!diffLevel++)
            hydrating = dom && !dom[_constants__WEBPACK_IMPORTED_MODULE_1__["ATTR_KEY"]];
        ret = yield idiff(dom, node, parent, root);
        if (parent && ret.parentNode !== parent)
            parent.appendChild(ret);
        if (!--diffLevel) {
            hydrating = false;
        }
        return ret;
    });
}
function idiff(dom, node, parent, root) {
    return __awaiter(this, void 0, void 0, function* () {
        let out = dom;
        if (node.nodeValue == null || typeof node.nodeValue === 'boolean')
            node.nodeValue = '';
        if (node.nodeType === 'text') {
            if (dom && dom.splitText && dom.parentNode && (!dom._component || root)) {
                if (dom.nodeValue != node.nodeValue)
                    dom.nodeValue = node.nodeValue;
            }
            else {
                out = _readapt_dom_index__WEBPACK_IMPORTED_MODULE_2__["DOM"].document.createTextNode(node.nodeValue);
                if (dom) {
                    if (dom.parentNode)
                        dom.parentNode.replaceChild(out, dom);
                    yield recollectNodeTree(dom, false);
                }
            }
            out[_constants__WEBPACK_IMPORTED_MODULE_1__["ATTR_KEY"]] = {};
            return out;
        }
        let nodeName = node.nodeName, nroot;
        if (typeof nodeName === 'function')
            return yield Object(_component__WEBPACK_IMPORTED_MODULE_0__["buildComponent"])(dom, node, parent, hydrating);
        if (!dom || dom.nodeName.toLowerCase() !== nodeName.toLowerCase()) {
            out = Object(_readapt_dom_index__WEBPACK_IMPORTED_MODULE_2__["createNode"])(nodeName);
            if (dom) {
                while (dom.firstChild)
                    out.appendChild(dom.firstChild);
                if (dom.parentNode)
                    dom.parentNode.replaceChild(out, dom);
                //recollect
                yield recollectNodeTree(dom, false);
            }
        }
        let props = out[_constants__WEBPACK_IMPORTED_MODULE_1__["ATTR_KEY"]];
        if (!props) {
            props = out[_constants__WEBPACK_IMPORTED_MODULE_1__["ATTR_KEY"]] = {};
            out.getAttributeNames().forEach(n => props[n] = out.getAttribute(n));
        }
        let fc = out.firstChild, children = node.childNodes;
        if ((children && children.length) || fc)
            yield innerDiffNode(out, children, root);
        diffAttributes(out, node.attributes, props);
        return out;
    });
}
function innerDiffNode(dom, vchildren, root) {
    return __awaiter(this, void 0, void 0, function* () {
        let originalChildren = dom.childNodes, children = Array(), keyed = {}, keyedLen = 0, min = 0, len = originalChildren.length, childrenLen = 0, vlen = vchildren ? vchildren.length : 0, j, c, f, vchild, child;
        // Build up a map of keyed children and an Array of unkeyed children:
        if (len !== 0) {
            for (let i = 0; i < len; i++) {
                let child = originalChildren[i], props = child[_constants__WEBPACK_IMPORTED_MODULE_1__["ATTR_KEY"]], key = vlen && props ? child._component ? child._component.key : props.key : null;
                if (key != null) {
                    keyedLen++;
                    keyed[key] = child;
                }
                else if (props || (child.splitText !== undefined ? (hydrating ? child.nodeValue.trim() : true) : hydrating)) {
                    children[childrenLen++] = child;
                }
            }
        }
        if (vlen !== 0) {
            for (let i = 0; i < vlen; i++) {
                vchild = vchildren[i];
                child = null;
                // attempt to find a node based on key matching
                let key = vchild.key;
                if (key != null) {
                    if (keyedLen && keyed[key] !== undefined) {
                        child = keyed[key];
                        keyed[key] = undefined;
                        keyedLen--;
                    }
                }
                // attempt to pluck a node of the same type from the existing children
                else if (min < childrenLen) {
                    for (j = min; j < childrenLen; j++) {
                        if (children[j] !== undefined && Object(_readapt_dom_index__WEBPACK_IMPORTED_MODULE_2__["isSameNodeType"])(c = children[j], vchild, hydrating)) {
                            child = c;
                            children[j] = undefined;
                            if (j === childrenLen - 1)
                                childrenLen--;
                            if (j === min)
                                min++;
                            break;
                        }
                    }
                }
                // morph the matched/found/created DOM child to match vchild (deep)
                child = yield idiff(child, vchild, dom, root);
                f = originalChildren[i];
                if (child && child !== dom && child !== f) {
                    if (f == null) {
                        dom.appendChild(child);
                    }
                    else {
                        dom.insertBefore(child, f);
                        Object(_readapt_dom_index__WEBPACK_IMPORTED_MODULE_2__["removeNode"])(f);
                    }
                }
            }
        }
        // remove unused keyed children:
        if (keyedLen) {
            for (let i in keyed)
                if (keyed[i] !== undefined)
                    yield recollectNodeTree(keyed[i], false);
        }
        // remove orphaned unkeyed children:
        while (min <= childrenLen) {
            if ((child = children[childrenLen--]) !== undefined)
                yield recollectNodeTree(child, false);
        }
    });
}
function recollectNodeTree(node, unmountOnly) {
    return __awaiter(this, void 0, void 0, function* () {
        if (!node)
            return;
        let component = node._component;
        if (component)
            yield Object(_component__WEBPACK_IMPORTED_MODULE_0__["unmountComponent"])(component);
        if (node[_constants__WEBPACK_IMPORTED_MODULE_1__["ATTR_KEY"]] && node[_constants__WEBPACK_IMPORTED_MODULE_1__["ATTR_KEY"]].ref)
            node[_constants__WEBPACK_IMPORTED_MODULE_1__["ATTR_KEY"]].ref(null);
        if (unmountOnly === false || node[_constants__WEBPACK_IMPORTED_MODULE_1__["ATTR_KEY"]])
            Object(_readapt_dom_index__WEBPACK_IMPORTED_MODULE_2__["removeNode"])(node);
        yield removeChildren(node);
    });
}
function removeChildren(node) {
    return __awaiter(this, void 0, void 0, function* () {
        node = node.lastChild;
        while (node) {
            let next = node.previousSibling;
            yield recollectNodeTree(node, true);
            node = next;
        }
    });
}
function diffAttributes(dom, attrs, old) {
    let name;
    for (name in old) {
        if (!(attrs && attrs[name] != null) && old[name] != null)
            Object(_readapt_dom_index__WEBPACK_IMPORTED_MODULE_2__["setAccessor"])(dom, name, old, old[name] = undefined);
    }
    for (name in attrs) {
        if (name !== 'children' && name !== 'innerHTML'
            && (attrs[name] !== ((name === 'value' || name === 'checked') ? dom[name] : old[name])))
            Object(_readapt_dom_index__WEBPACK_IMPORTED_MODULE_2__["setAccessor"])(dom, name, old[name], old[name] = attrs[name]);
    }
}


/***/ }),

/***/ "./src/readapt-vdom/vnode.ts":
/*!***********************************!*\
  !*** ./src/readapt-vdom/vnode.ts ***!
  \***********************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return VNode; });

class VNode {
    constructor(name, type, v) {
        this.nodeName = name;
        this.nodeType = type;
        this.nodeValue = v;
        this.childNodes = Array(0);
    }
}


/***/ }),

/***/ "./src/render.ts":
/*!***********************!*\
  !*** ./src/render.ts ***!
  \***********************/
/*! exports provided: enqueue, enqueueState, hydrate, render */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "enqueue", function() { return enqueue; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "enqueueState", function() { return enqueueState; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "hydrate", function() { return hydrate; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "render", function() { return render; });
/* harmony import */ var _component__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./component */ "./src/component.ts");
/* harmony import */ var _readapt_vdom_diff__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./readapt-vdom/diff */ "./src/readapt-vdom/diff.ts");

var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};


function enqueue(component) {
    (component.asyncMethod || _component__WEBPACK_IMPORTED_MODULE_0__["DEFER_PROMISE"])(() => __awaiter(this, void 0, void 0, function* () {
        yield Object(_component__WEBPACK_IMPORTED_MODULE_0__["renderComponent"])(component, component.parentNode, false);
    }));
}
function enqueueState(component, state) {
    (component.asyncMethod || _component__WEBPACK_IMPORTED_MODULE_0__["DEFER_PROMISE"])(() => __awaiter(this, void 0, void 0, function* () {
        yield state;
    }));
}
function hydrate(node, parent) {
    return __awaiter(this, void 0, void 0, function* () {
        return yield render(node, parent, parent.firstElementChild);
    });
}
function render(node, parent, merge) {
    return __awaiter(this, void 0, void 0, function* () {
        return yield Object(_readapt_vdom_diff__WEBPACK_IMPORTED_MODULE_1__["diff"])(merge, node, parent, true);
    });
}


/***/ })

/******/ });
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NsaWVudC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50LnRzIiwid2VicGFjazovLy8uL3NyYy9jb25zdGFudHMudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2gudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3JlYWRhcHQtZG9tL2luZGV4LnRzIiwid2VicGFjazovLy8uL3NyYy9yZWFkYXB0LXZkb20vZGlmZi50cyIsIndlYnBhY2s6Ly8vLi9zcmMvcmVhZGFwdC12ZG9tL3Zub2RlLnRzIiwid2VicGFjazovLy8uL3NyYy9yZW5kZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtRQUFBO1FBQ0E7O1FBRUE7UUFDQTs7UUFFQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTs7UUFFQTtRQUNBOztRQUVBO1FBQ0E7O1FBRUE7UUFDQTtRQUNBOzs7UUFHQTtRQUNBOztRQUVBO1FBQ0E7O1FBRUE7UUFDQTtRQUNBO1FBQ0EsMENBQTBDLGdDQUFnQztRQUMxRTtRQUNBOztRQUVBO1FBQ0E7UUFDQTtRQUNBLHdEQUF3RCxrQkFBa0I7UUFDMUU7UUFDQSxpREFBaUQsY0FBYztRQUMvRDs7UUFFQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0EseUNBQXlDLGlDQUFpQztRQUMxRSxnSEFBZ0gsbUJBQW1CLEVBQUU7UUFDckk7UUFDQTs7UUFFQTtRQUNBO1FBQ0E7UUFDQSwyQkFBMkIsMEJBQTBCLEVBQUU7UUFDdkQsaUNBQWlDLGVBQWU7UUFDaEQ7UUFDQTtRQUNBOztRQUVBO1FBQ0Esc0RBQXNELCtEQUErRDs7UUFFckg7UUFDQTs7O1FBR0E7UUFDQTs7Ozs7Ozs7Ozs7OztBQ2xGQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQWE7QUFDNkI7QUFDTjtBQUNJO0FBQ0M7QUFFekMsc0RBQUcs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YXB0LmRldi5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuIFx0XHR9XG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRpOiBtb2R1bGVJZCxcbiBcdFx0XHRsOiBmYWxzZSxcbiBcdFx0XHRleHBvcnRzOiB7fVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikge1xuIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBnZXR0ZXIgfSk7XG4gXHRcdH1cbiBcdH07XG5cbiBcdC8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uciA9IGZ1bmN0aW9uKGV4cG9ydHMpIHtcbiBcdFx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG4gXHRcdH1cbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbiBcdH07XG5cbiBcdC8vIGNyZWF0ZSBhIGZha2UgbmFtZXNwYWNlIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDE6IHZhbHVlIGlzIGEgbW9kdWxlIGlkLCByZXF1aXJlIGl0XG4gXHQvLyBtb2RlICYgMjogbWVyZ2UgYWxsIHByb3BlcnRpZXMgb2YgdmFsdWUgaW50byB0aGUgbnNcbiBcdC8vIG1vZGUgJiA0OiByZXR1cm4gdmFsdWUgd2hlbiBhbHJlYWR5IG5zIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDh8MTogYmVoYXZlIGxpa2UgcmVxdWlyZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy50ID0gZnVuY3Rpb24odmFsdWUsIG1vZGUpIHtcbiBcdFx0aWYobW9kZSAmIDEpIHZhbHVlID0gX193ZWJwYWNrX3JlcXVpcmVfXyh2YWx1ZSk7XG4gXHRcdGlmKG1vZGUgJiA4KSByZXR1cm4gdmFsdWU7XG4gXHRcdGlmKChtb2RlICYgNCkgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiB2YWx1ZSAmJiB2YWx1ZS5fX2VzTW9kdWxlKSByZXR1cm4gdmFsdWU7XG4gXHRcdHZhciBucyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18ucihucyk7XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShucywgJ2RlZmF1bHQnLCB7IGVudW1lcmFibGU6IHRydWUsIHZhbHVlOiB2YWx1ZSB9KTtcbiBcdFx0aWYobW9kZSAmIDIgJiYgdHlwZW9mIHZhbHVlICE9ICdzdHJpbmcnKSBmb3IodmFyIGtleSBpbiB2YWx1ZSkgX193ZWJwYWNrX3JlcXVpcmVfXy5kKG5zLCBrZXksIGZ1bmN0aW9uKGtleSkgeyByZXR1cm4gdmFsdWVba2V5XTsgfS5iaW5kKG51bGwsIGtleSkpO1xuIFx0XHRyZXR1cm4gbnM7XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gXCIuL3NyYy9jbGllbnQuanNcIik7XG4iLCIndXNlIHN0cmljdCc7XHJcbmltcG9ydCB7aCwgaCBhcyBjcmVhdGVFbGVtZW50fSBmcm9tICcuL2gnO1xyXG5pbXBvcnQgQ29tcG9uZW50IGZyb20gJy4vY29tcG9uZW50JztcclxuaW1wb3J0IHtET019IGZyb20gJy4vcmVhZGFwdC1kb20vaW5kZXgnO1xyXG5pbXBvcnQge3JlbmRlciwgaHlkcmF0ZX0gZnJvbSAnLi9yZW5kZXInO1xyXG5cclxuRE9NLmRvY3VtZW50ID0gZG9jdW1lbnQ7XHJcbndpbmRvdy5oID0gaDtcclxud2luZG93LkNvbXBvbmVudCA9IENvbXBvbmVudDtcclxud2luZG93LlJlYWRhcHQgPSB7XHJcbiAgICByZW5kZXI6IHJlbmRlcixcclxuICAgIGh5ZHJhdGU6IGh5ZHJhdGVcclxufTtcclxud2luZG93LlJlYWN0ID0ge1xyXG4gICAgY3JlYXRlRWxlbWVudDogY3JlYXRlRWxlbWVudCxcclxuICAgIHJlbmRlcjogcmVuZGVyLFxyXG4gICAgaHlkcmF0ZTogaHlkcmF0ZVxyXG59OyIsIid1c2Ugc3RyaWN0JztcclxuaW1wb3J0IHtyZW1vdmVOb2RlfSBmcm9tICcuL3JlYWRhcHQtZG9tL2luZGV4JztcclxuaW1wb3J0IFZOb2RlIGZyb20gJy4vcmVhZGFwdC12ZG9tL3Zub2RlJztcclxuaW1wb3J0IHsgQVRUUl9LRVksIEFTWU5DLCBTWU5DLCBleHRlbmQgfSBmcm9tICcuL2NvbnN0YW50cyc7XHJcbmltcG9ydCB7IGRpZmYsIHJlY29sbGVjdE5vZGVUcmVlIH0gZnJvbSAnLi9yZWFkYXB0LXZkb20vZGlmZic7XHJcbmltcG9ydCB7IGRpZmZMZXZlbH0gZnJvbSAnLi9yZWFkYXB0LXZkb20vZGlmZic7XHJcbmltcG9ydCB7IGVucXVldWUsIGVucXVldWVTdGF0ZSB9IGZyb20gJy4vcmVuZGVyJztcclxuXHJcbmV4cG9ydCBjb25zdCBERUZFUl9QUk9NSVNFID0gUHJvbWlzZS5yZXNvbHZlKCkudGhlbi5iaW5kKFByb21pc2UucmVzb2x2ZSgpKTtcclxuZXhwb3J0IGNvbnN0IERFRkVSX1RJTUVPVVQgPSBzZXRUaW1lb3V0O1xyXG5leHBvcnQgY29uc3QgREVGRVJfQU5JTUFUSU9OID0gdHlwZW9mIHJlcXVlc3RBbmltYXRpb25GcmFtZSAhPT0gJ3VuZGVmaW5lZCcgPyByZXF1ZXN0QW5pbWF0aW9uRnJhbWUgOiBERUZFUl9QUk9NSVNFO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ29tcG9uZW50IHtcclxuICAgIGtleTogYW55O1xyXG4gICAgcmVmOiBhbnk7XHJcbiAgICBkaXNhYmxlZDogYm9vbGVhbjtcclxuICAgIHBhcmVudCA6IGFueTtcclxuICAgIGJhc2U6IGFueTtcclxuICAgIHJlbmRlck1vZGU6IE51bWJlcjtcclxuICAgIGNoaWxkOiBhbnk7XHJcbiAgICBhc3luY01ldGhvZDogYW55O1xyXG4gICAgcGFyZW50Tm9kZTogYW55O1xyXG4gICAgY2hpbGRyZW46IEFycmF5PGFueT47XHJcbiAgICBzdGF0ZTogT2JqZWN0O1xyXG4gICAgLy9jb250YWluZXIgdG8gaG9sZCBvcmlnaW5hbCBwYXNzZWQgcHJvcHNcclxuICAgIF9fcHJvcHM6IGFueTtcclxuXHJcbiAgICBjb25zdHJ1Y3Rvcihwcm9wczogYW55LCBwYXJlbnQ6IENvbXBvbmVudCwgcmVuZGVyTW9kZTogYW55KSB7XHJcbiAgICAgICAgdGhpcy5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMua2V5ID0gcHJvcHMua2V5O1xyXG4gICAgICAgIHRoaXMucmVmID0gcHJvcHMucmVmO1xyXG4gICAgICAgIHRoaXMuYXN5bmNNZXRob2QgPSBERUZFUl9QUk9NSVNFO1xyXG4gICAgICAgIHRoaXMucmVuZGVyTW9kZSA9IHJlbmRlck1vZGUgfHwgU1lOQztcclxuICAgICAgICB0aGlzLmNoaWxkID0gbnVsbDtcclxuICAgICAgICB0aGlzLmJhc2UgPSBudWxsO1xyXG4gICAgICAgIHRoaXMucGFyZW50ID0gcGFyZW50O1xyXG4gICAgICAgIHRoaXMucGFyZW50Tm9kZSA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5jaGlsZHJlbiA9IFtdO1xyXG4gICAgICAgIHRoaXMuc3RhdGUgPSB7fTtcclxuICAgICAgICB0aGlzLl9fcHJvcHMgPSBwcm9wcztcclxuICAgICAgICBcclxuICAgICAgICBkZWxldGUgcHJvcHMucmVmO1xyXG4gICAgICAgIGRlbGV0ZSBwcm9wcy5rZXk7XHJcbiAgIFxyXG4gICAgICAgIHRoaXMub2JzZXJ2ZShwcm9wcyk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJvdGVjdGVkIGFzeW5jIGNvbXBvbmVudENoYW5nZShrZXk6IHN0cmluZywgdmFsdWU6IGFueSwgcHJldmlvdXM6IGFueSkgOiBQcm9taXNlPGFueT4ge1xyXG4gICAgICAgIGlmKHRoaXMuc2hvdWxkQ29tcG9uZW50VXBkYXRlKGtleSx2YWx1ZSxwcmV2aW91cykpIHtcclxuICAgICAgICAgICAgaWYodGhpcy5yZW5kZXJNb2RlID09PSBTWU5DKSBhd2FpdCByZW5kZXJDb21wb25lbnQodGhpcywgdGhpcy5wYXJlbnROb2RlLCBmYWxzZSk7XHJcbiAgICAgICAgICAgIGVsc2UgaWYodGhpcy5yZW5kZXJNb2RlID09PSBBU1lOQykgZW5xdWV1ZSh0aGlzKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgYXN5bmMgZm9yY2VVcGRhdGUoKSA6IFByb21pc2U8YW55PiB7XHJcbiAgICAgICAgYXdhaXQgcmVuZGVyQ29tcG9uZW50KHRoaXMsIHRoaXMucGFyZW50Tm9kZSwgZmFsc2UpO1xyXG4gICAgfVxyXG5cclxuICAgIGFzeW5jIGNvbXBvbmVudERpZFVwZGF0ZShwcmV2aW91cykgOiBQcm9taXNlPGFueT4ge1xyXG4gICAgICAgIFxyXG4gICAgfVxyXG5cclxuICAgIGFzeW5jIHJlbmRlcigpIDogUHJvbWlzZTxhbnk+IHtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgYXN5bmMgY29tcG9uZW50V2lsbFVubW91bnQoKSA6IFByb21pc2U8YW55PiB7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIGFzeW5jIGNvbXBvbmVudERpZE1vdW50KCkgOiBQcm9taXNlPGFueT4ge1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBwcm90ZWN0ZWQgYXN5bmMgc2V0U3RhdGUoc206IGFueSkgOiBQcm9taXNlPGFueT4ge1xyXG4gICAgICAgIGNvbnN0IHVwZGF0ZSA9IG5ldyBQcm9taXNlKGFzeW5jIChyLHJqKSA9PiB7XHJcbiAgICAgICAgICAgIC8vaW1tdXRhYmxlIGZyb20gb3JpZ2luYWwgc3RhdGVcclxuICAgICAgICAgICAgY29uc3Qgb2xkU3RhdGUgPSBleHRlbmQoe30sIHRoaXMuc3RhdGUpO1xyXG4gICAgICAgICAgICBjb25zdCBmaW5hbFN0YXRlID0gZXh0ZW5kKHt9LCB0aGlzLnN0YXRlKTtcclxuICAgICAgICAgICAgbGV0IG5ld1N0YXRlIDogT2JqZWN0ID0ge307XHJcbiAgICAgICAgICAgIGlmICh0eXBlb2Ygc20gPT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgICAgICAgICAgIC8vY29weSBjdXJyZW50IHByb3BzIGZvciBpbW11dGFibGVcclxuICAgICAgICAgICAgICAgIGNvbnN0IHByb3BzID0ge307XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fX3Byb3BzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yKGxldCBrIGluIHRoaXMuX19wcm9wcykgcHJvcHNba10gPSB0aGlzW2tdO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgLy9pbW11dGFibGUgZnJvbSBvcmlnaW5hbCBzdGF0ZVxyXG4gICAgICAgICAgICAgICAgbmV3U3RhdGUgPSBzbShleHRlbmQobmV3U3RhdGUsIHRoaXMuc3RhdGUpLCBwcm9wcykgfHwgbmV3U3RhdGU7XHJcbiAgICAgICAgICAgICAgICBleHRlbmQoZmluYWxTdGF0ZSwgbmV3U3RhdGUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYodHlwZW9mIHNtID09PSAnb2JqZWN0JykgZXh0ZW5kKGZpbmFsU3RhdGUsIHNtKTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuc3RhdGUgPSBmaW5hbFN0YXRlO1xyXG5cclxuICAgICAgICAgICAgZm9yKGxldCBrIGluIGZpbmFsU3RhdGUpIHtcclxuICAgICAgICAgICAgICAgIGlmKG9sZFN0YXRlW2tdICE9PSBmaW5hbFN0YXRlW2tdKSBhd2FpdCB0aGlzLmNvbXBvbmVudENoYW5nZShrLCBuZXdTdGF0ZVtrXSwgb2xkU3RhdGVba10pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHIoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBpZiAodGhpcy5yZW5kZXJNb2RlID09PSBTWU5DKSBhd2FpdCB1cGRhdGU7XHJcbiAgICAgICAgZWxzZSBpZih0aGlzLnJlbmRlck1vZGUgPT09IEFTWU5DKSBlbnF1ZXVlU3RhdGUodGhpcywgdXBkYXRlKTtcclxuICAgIH0gXHJcblxyXG4gICAgcHJvdGVjdGVkIHNob3VsZENvbXBvbmVudFVwZGF0ZShrZXk6IHN0cmluZywgdmFsdWU6IGFueSwgcHJldmlvdXM6IGFueSkgOiBib29sZWFuIHtcclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH1cclxuXHJcbiAgICBwcm90ZWN0ZWQgb2JzZXJ2ZShvOiBPYmplY3QpIHtcclxuICAgICAgICBmb3IobGV0IGsgaW4gbykge1xyXG4gICAgICAgICAgICBsZXQgdiA6IGFueSA9IG9ba107XHJcblxyXG4gICAgICAgICAgICBpZih0eXBlb2YgdiA9PT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICAgICAgICAgICAgdGhpc1trXSA9IHY7XHJcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIGBcXCQke2t9YCwge3ZhbHVlOiB2LCB3cml0YWJsZTogdHJ1ZSwgZW51bWVyYWJsZTogZmFsc2UgfSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgaywge1xyXG4gICAgICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIGdldCgpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpc1tgXFwkJHtrfWBdO1xyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIHNldChudjogYW55KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcHJldiA9IHRoaXNbYFxcJCR7a31gXTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzW2BcXCQke2t9YF0gPSBudjtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYoIXRoaXMuZGlzYWJsZWQgJiYgcHJldiAhPT0gbnYpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jb21wb25lbnRDaGFuZ2UoayxudixwcmV2KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJlbmRlckNvbXBvbmVudChjb21wb25lbnQ6IENvbXBvbmVudCwgcGFyZW50Tm9kZTogYW55LCBoeWRyYXRpbmc6IGJvb2xlYW4pIHtcclxuICAgIGxldCBpc1VwZGF0ZSA9IGNvbXBvbmVudC5iYXNlLCBwLCBwcm9wcywgcmVuZGVyZWQsIHRvVW5tb3VudCwgY2Jhc2UsIGluc3QsIGJhc2UsIHR5cGU7XHJcbiAgICBpZihjb21wb25lbnQuZGlzYWJsZWQpIHJldHVybjtcclxuXHJcbiAgICByZW5kZXJlZCA9IGF3YWl0IGNvbXBvbmVudC5yZW5kZXIoKTtcclxuXHJcbiAgICBpZighcmVuZGVyZWQgfHwgQXJyYXkuaXNBcnJheShyZW5kZXJlZCkpIHtcclxuICAgICAgICBpZihjb21wb25lbnQuY2hpbGQpIHtcclxuICAgICAgICAgICAgYXdhaXQgdW5tb3VudENvbXBvbmVudChjb21wb25lbnQuY2hpbGQpO1xyXG4gICAgICAgICAgICBjb21wb25lbnQuY2hpbGQgPSBudWxsO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZihjb21wb25lbnQuYmFzZSkge1xyXG4gICAgICAgICAgICBjb21wb25lbnQuYmFzZS5fY29tcG9uZW50ID0gbnVsbDtcclxuICAgICAgICAgICAgYXdhaXQgcmVjb2xsZWN0Tm9kZVRyZWUoY29tcG9uZW50LmJhc2UsIGZhbHNlKTtcclxuICAgICAgICAgICAgY29tcG9uZW50LmJhc2UgPSBudWxsO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgY29tcG9uZW50LnBhcmVudE5vZGUgPSBwYXJlbnROb2RlO1xyXG4gICAgY2Jhc2UgPSBiYXNlID0gY29tcG9uZW50LmJhc2U7XHJcblxyXG4gICAgaWYodHlwZW9mIHJlbmRlcmVkLm5vZGVOYW1lID09PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgcHJvcHMgPSByZW5kZXJlZC5hdHRyaWJ1dGVzO1xyXG4gICAgICAgIGluc3QgPSBjb21wb25lbnQuY2hpbGQ7XHJcbiAgICAgICAgaWYoaW5zdCAmJiBpbnN0LmNvbnN0cnVjdG9yID09PSByZW5kZXJlZC5ub2RlTmFtZSkge1xyXG4gICAgICAgICAgICBjb25zdCB1cGRhdGUgPSBwcmVwYXJlUmVuZGVyKGluc3QsIHByb3BzLCByZW5kZXJlZC5jaGlsZE5vZGVzKTtcclxuICAgICAgICAgICAgaWYodXBkYXRlLl9kaWZmZXJlbnQpIHtcclxuICAgICAgICAgICAgICAgIGF3YWl0IHJlbmRlckNvbXBvbmVudChpbnN0LCBpbnN0LnBhcmVudE5vZGUsIGh5ZHJhdGluZyk7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCBpbnN0LmNvbXBvbmVudERpZFVwZGF0ZSh1cGRhdGUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0b1VubW91bnQgPSBpbnN0OyB0eXBlID0gcmVuZGVyZWQubm9kZU5hbWU7XHJcblxyXG4gICAgICAgICAgICBpZihjYmFzZSAmJiAhdG9Vbm1vdW50ICYmICFoeWRyYXRpbmcpIHtcclxuICAgICAgICAgICAgICAgIGNiYXNlLl9jb21wb25lbnQgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgcmVjb2xsZWN0Tm9kZVRyZWUoY2Jhc2UsIGZhbHNlKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgY29tcG9uZW50LmNoaWxkID0gaW5zdCA9IG5ldyB0eXBlKHByb3BzLCBjb21wb25lbnQpO1xyXG4gICAgICAgICAgICBpZiAoaHlkcmF0aW5nKSBpbnN0LmJhc2UgPSBjYmFzZTtcclxuICAgICAgICAgICAgaW5zdC5jaGlsZHJlbiA9IHJlbmRlcmVkLmNoaWxkTm9kZXM7XHJcbiAgICAgICAgICAgIGlmKGluc3QucmVmKSBpbnN0LnJlZihpbnN0KTtcclxuICAgICAgICAgICAgYXdhaXQgcmVuZGVyQ29tcG9uZW50KGluc3QsIGNvbXBvbmVudC5wYXJlbnROb2RlLCBoeWRyYXRpbmcpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgYmFzZSA9IGluc3QuYmFzZTtcclxuICAgIH1cclxuICAgIGlmKHR5cGVvZiByZW5kZXJlZC5ub2RlTmFtZSAhPT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICAgIHRvVW5tb3VudCA9IGNvbXBvbmVudC5jaGlsZDtcclxuICAgICAgICBpZih0b1VubW91bnQpIGNiYXNlID0gY29tcG9uZW50LmNoaWxkID0gbnVsbDtcclxuICAgICAgICBiYXNlID0gYXdhaXQgZGlmZihjYmFzZSwgcmVuZGVyZWQsIGNvbXBvbmVudC5wYXJlbnROb2RlLCB0cnVlKTtcclxuICAgIH1cclxuXHJcbiAgICBpZihjYmFzZSAmJiBiYXNlICE9PSBjYmFzZSAmJiBpbnN0ICE9PSBjb21wb25lbnQuY2hpbGQpIHtcclxuICAgICAgICBwID0gY2Jhc2UucGFyZW50Tm9kZTtcclxuICAgICAgICBpZihwICYmIGJhc2UgIT09IHApIHtcclxuICAgICAgICAgICAgcC5yZXBsYWNlQ2hpbGQoYmFzZSwgY2Jhc2UpO1xyXG5cclxuICAgICAgICAgICAgaWYoIXRvVW5tb3VudCkge1xyXG4gICAgICAgICAgICAgICAgY2Jhc2UuX2NvbXBvbmVudCA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCByZWNvbGxlY3ROb2RlVHJlZShjYmFzZSwgZmFsc2UpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGlmKHRvVW5tb3VudCkgYXdhaXQgdW5tb3VudENvbXBvbmVudCh0b1VubW91bnQpO1xyXG5cclxuICAgIGNvbXBvbmVudC5iYXNlID0gYmFzZTtcclxuICAgIGlmKGJhc2UgJiYgIWNvbXBvbmVudC5jaGlsZCkge1xyXG4gICAgICAgIGxldCBjbXAgPSBjb21wb25lbnQsIHQgPSBjb21wb25lbnQ7XHJcblxyXG4gICAgICAgIHdoaWxlKCh0ID0gdC5wYXJlbnQpKSB7XHJcbiAgICAgICAgICAgIChjbXAgPSB0KS5iYXNlID0gYmFzZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGJhc2UuX2NvbXBvbmVudCA9IGNtcDtcclxuICAgIH0gXHJcbiAgICBpZighaXNVcGRhdGUpIHtcclxuICAgICAgICBhd2FpdCBjb21wb25lbnQuY29tcG9uZW50RGlkTW91bnQoKTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHByZXBhcmVSZW5kZXIoaW5zdDogQ29tcG9uZW50LCBwcm9wczogYW55LCBjaGlsZHJlbjogQXJyYXk8YW55PikgOiBhbnkge1xyXG4gICAgbGV0IGRpZmYgPSB7X2RpZmZlcmVudDogZmFsc2V9O1xyXG4gICAgaWYoaW5zdC5yZWYpIGluc3QucmVmKGluc3QpO1xyXG4gICAgaW5zdC5jaGlsZHJlbiA9IGNoaWxkcmVuO1xyXG5cclxuICAgIGluc3QuZGlzYWJsZWQgPSB0cnVlO1xyXG4gICAgZm9yKGxldCBuIGluIHByb3BzKSB7XHJcblx0XHRpZihpbnN0W25dICE9PSBwcm9wc1tuXSkge1xyXG5cdFx0XHRkaWZmW25dID0gaW5zdFtuXTtcclxuXHRcdFx0ZGlmZi5fZGlmZmVyZW50ID0gdHJ1ZTtcclxuXHRcdH1cclxuXHRcdGluc3Rbbl0gPSBwcm9wc1tuXTtcclxuICAgIH1cclxuICAgIGluc3QuZGlzYWJsZWQgPSBmYWxzZTtcclxuXHJcbiAgICByZXR1cm4gZGlmZjtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVubW91bnRDb21wb25lbnQoY29tcG9uZW50OiBDb21wb25lbnQpIHtcclxuICAgIGNvbnN0IGJhc2UgPSBjb21wb25lbnQuYmFzZTtcclxuICAgIGNvbXBvbmVudC5kaXNhYmxlZCA9IHRydWU7XHJcbiAgICBhd2FpdCBjb21wb25lbnQuY29tcG9uZW50V2lsbFVubW91bnQoKTtcclxuICAgIGlmKGNvbXBvbmVudC5jaGlsZCkgYXdhaXQgdW5tb3VudENvbXBvbmVudChjb21wb25lbnQuY2hpbGQpO1xyXG4gICAgY29tcG9uZW50LmJhc2UgPSBudWxsO1xyXG4gICAgY29tcG9uZW50LnBhcmVudCA9IG51bGw7XHJcbiAgICBjb21wb25lbnQuY2hpbGQgPSBudWxsO1xyXG4gICAgaWYoYmFzZSkge1xyXG4gICAgICAgIGJhc2UuX2NvbXBvbmVudCA9IG51bGw7XHJcbiAgICAgICAgaWYoYmFzZVtBVFRSX0tFWV0gJiYgYmFzZVtBVFRSX0tFWV0ucmVmKSBiYXNlW0FUVFJfS0VZXS5yZWYobnVsbCk7XHJcblxyXG4gICAgICAgIGF3YWl0IHJlY29sbGVjdE5vZGVUcmVlKGJhc2UsIGZhbHNlKTtcclxuICAgIH1cclxuICAgIGlmKGNvbXBvbmVudC5yZWYpIGNvbXBvbmVudC5yZWYobnVsbCk7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBidWlsZENvbXBvbmVudChkb206IGFueSwgbm9kZTogVk5vZGUsIHBhcmVudE5vZGU6IGFueSwgaHlkcmF0aW5nOiBib29sZWFuKSB7XHJcbiAgICBsZXQgYyA9IGRvbSAmJiBkb20uX2NvbXBvbmVudCxcclxuICAgICAgICBpc0RpcmVjdE93bmVyID0gYyAmJiBjLmNvbnN0cnVjdG9yID09PSBub2RlLm5vZGVOYW1lLFxyXG4gICAgICAgIHByb3BzID0gbm9kZS5hdHRyaWJ1dGVzLFxyXG4gICAgICAgIHR5cGUgPSBub2RlLm5vZGVOYW1lO1xyXG5cclxuICAgIGlmKGlzRGlyZWN0T3duZXIgJiYgYykge1xyXG4gICAgICAgIGNvbnN0IHVwZGF0ZSA9IHByZXBhcmVSZW5kZXIoYywgcHJvcHMsIG5vZGUuY2hpbGROb2Rlcyk7XHJcbiAgICAgICAgaWYodXBkYXRlLl9kaWZmZXJlbnQpIHtcclxuICAgICAgICAgICAgYXdhaXQgcmVuZGVyQ29tcG9uZW50KGMsIHBhcmVudE5vZGUsIGh5ZHJhdGluZyk7XHJcbiAgICAgICAgICAgIGF3YWl0IGMuY29tcG9uZW50RGlkVXBkYXRlKHVwZGF0ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGRvbSA9IGMuYmFzZTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIGlmKCFoeWRyYXRpbmcpIGF3YWl0IHJlY29sbGVjdE5vZGVUcmVlKGRvbSwgZmFsc2UpO1xyXG4gICAgICAgIGMgPSBuZXcgdHlwZShwcm9wcywgbnVsbCk7XHJcbiAgICAgICAgYy5jaGlsZHJlbiA9IG5vZGUuY2hpbGROb2RlcztcclxuICAgICAgICBpZiAoaHlkcmF0aW5nKSBjLmJhc2UgPSBkb207XHJcbiAgICAgICAgaWYoYy5yZWYpIGMucmVmKGMpO1xyXG4gICAgICAgIGF3YWl0IHJlbmRlckNvbXBvbmVudChjLCBwYXJlbnROb2RlLCBoeWRyYXRpbmcpO1xyXG4gICAgICAgIGRvbSA9IGMuYmFzZTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgcmV0dXJuIGRvbTtcclxufSIsIid1c2Ugc3RyaWN0JztcclxuXHJcbmV4cG9ydCBjb25zdCBBVFRSX0tFWSA9ICdfX3JlYWRhcHRfXyc7XHJcbmV4cG9ydCBjb25zdCBBU1lOQyA9IDM7XHJcbmV4cG9ydCBjb25zdCBTWU5DID0gMTtcclxuZXhwb3J0IGNvbnN0IE5PTkUgPSAwO1xyXG5leHBvcnQgY29uc3QgRk9SQ0UgPSAyO1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGV4dGVuZChiYXNlOiBPYmplY3QsIHJlZjogT2JqZWN0KSB7XHJcbiAgICBmb3IobGV0IGsgaW4gcmVmKSBiYXNlW2tdID0gcmVmW2tdO1xyXG4gICAgcmV0dXJuIGJhc2U7XHJcbn07IiwiJ3VzZSBzdHJpY3QnO1xyXG5cclxuaW1wb3J0IFZOb2RlIGZyb20gJy4vcmVhZGFwdC12ZG9tL3Zub2RlJztcclxuaW1wb3J0IENvbXBvbmVudCBmcm9tICcuL2NvbXBvbmVudCc7XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gaChub2RlTmFtZTogc3RyaW5nIHwgQ29tcG9uZW50LCBhdHRyaWJ1dGVzOiBhbnksIC4uLmNoaWxkcmVuKSB7XHJcbiAgICBhdHRyaWJ1dGVzID0gYXR0cmlidXRlcyB8fCB7fTtcclxuICAgIGNvbnN0IHN0YWNrID0gQXJyYXk8YW55PigwKTtcclxuICAgIGxldCBjaGlsZCwgcCA9IG5ldyBWTm9kZShub2RlTmFtZSwgdHlwZW9mIG5vZGVOYW1lID09PSAnZnVuY3Rpb24nID8gJ2NvbXBvbmVudCcgOiAnZWxlbWVudCcsICcnKTtcclxuXHJcbiAgICBjaGlsZHJlbi5mb3JFYWNoKGMgPT4gc3RhY2sudW5zaGlmdChjKSk7XHJcbiAgICBpZihhdHRyaWJ1dGVzICYmIGF0dHJpYnV0ZXMuY2hpbGRyZW4gIT0gbnVsbCkge1xyXG4gICAgICAgIGlmKCFzdGFjay5sZW5ndGgpIHN0YWNrLnB1c2goYXR0cmlidXRlcy5jaGlsZHJlbik7XHJcbiAgICAgICAgZGVsZXRlIGF0dHJpYnV0ZXMuY2hpbGRyZW47XHJcbiAgICB9XHJcblxyXG4gICAgd2hpbGUoc3RhY2subGVuZ3RoKSB7XHJcbiAgICAgICAgY2hpbGQgPSBzdGFjay5wb3AoKTtcclxuICAgICAgICBpZihBcnJheS5pc0FycmF5KGNoaWxkKSkgY2hpbGQuZm9yRWFjaChjID0+IHN0YWNrLnVuc2hpZnQoYykpO1xyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBpZihjaGlsZCBpbnN0YW5jZW9mIFZOb2RlKSBwLmNoaWxkTm9kZXMucHVzaChjaGlsZCk7XHJcbiAgICAgICAgICAgIGVsc2UgcC5jaGlsZE5vZGVzLnB1c2gobmV3IFZOb2RlKCcjdGV4dCcsICd0ZXh0JywgY2hpbGQpKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIHAuYXR0cmlidXRlcyA9IGF0dHJpYnV0ZXM7XHJcbiAgICBwLmtleSA9IGF0dHJpYnV0ZXMua2V5ID8gYXR0cmlidXRlcy5rZXkgOiB1bmRlZmluZWQ7XHJcblxyXG4gICAgcmV0dXJuIHA7XHJcbn07IiwiJ3VzZSBzdHJpY3QnO1xyXG5cclxuZXhwb3J0IGNvbnN0IERPTSA6IGFueSA9IHtcclxuICAgIGRvY3VtZW50OiBudWxsXHJcbn07XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlTm9kZShub2RlTmFtZTogc3RyaW5nKSB7XHJcbiAgICByZXR1cm4gRE9NLmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQobm9kZU5hbWUpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gcmVtb3ZlTm9kZShub2RlKSB7XHJcbiAgICBjb25zdCBwYXJlbnROb2RlID0gbm9kZS5wYXJlbnROb2RlO1xyXG4gICAgaWYgKHBhcmVudE5vZGUpIHBhcmVudE5vZGUucmVtb3ZlQ2hpbGQobm9kZSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBpc1NhbWVOb2RlVHlwZShub2RlOiBhbnksIHZub2RlOiBhbnksIGh5ZHJhdGluZzogYm9vbGVhbikge1xyXG4gICAgaWYoIW5vZGUpIHJldHVybiBmYWxzZTtcclxuICAgIGlmKHZub2RlLm5vZGVUeXBlID09PSAndGV4dCcpIHJldHVybiBub2RlLnNwbGl0VGV4dDtcclxuICAgIGlmKHR5cGVvZiB2bm9kZS5ub2RlTmFtZSA9PT0gJ3N0cmluZycpIHJldHVybiAhbm9kZS5fY29tcG9uZW50ICYmIG5vZGUubm9kZU5hbWUudG9Mb3dlckNhc2UoKSA9PT0gdm5vZGUubm9kZU5hbWUudG9Mb3dlckNhc2UoKTtcclxuXHJcbiAgICByZXR1cm4gaHlkcmF0aW5nIHx8IChub2RlLl9jb21wb25lbnQgJiYgbm9kZS5fY29tcG9uZW50LmNvbnN0cnVjdG9yID09PSB2bm9kZS5ub2RlTmFtZSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBzZXRBY2Nlc3Nvcihub2RlLCBuYW1lLCBvbGQsIHZhbHVlKSB7XHJcbiAgICBpZihuYW1lID09PSAnY2xhc3NOYW1lJykgbmFtZSA9ICdjbGFzcyc7XHJcbiAgICBpZihuYW1lID09PSAnX19odG1sJykgbmFtZSA9ICdodG1sJztcclxuICAgIGlmKG5hbWUgPT09ICdrZXknKSB7XHJcbiAgICAgICAgLy9kbyBub3RoaW5nXHJcbiAgICB9XHJcbiAgICBlbHNlIGlmKG5hbWUgPT09ICdyZWYnKSB7XHJcbiAgICAgICAgaWYob2xkKSBvbGQobnVsbCk7XHJcbiAgICAgICAgaWYodmFsdWUpIHZhbHVlKG5vZGUpO1xyXG4gICAgfVxyXG4gICAgLy9wbGVhc2UgZm9yIHRoZSBsb3ZlIG9mIGdvZFxyXG4gICAgLy9uZXZlciB1c2UgdGhpcyB1bmxlc3MgeW91IHJlYWxseSBoYXZlIHRvXHJcbiAgICAvL2ZvciBzaG93aW5nIG1hcmsgZG93biBvciBzb21ldGhpbmcgc2ltaWxhclxyXG4gICAgZWxzZSBpZihuYW1lID09PSAnaHRtbCcpIHtcclxuICAgICAgICBpZihvbGQgIT09IHZhbHVlKSB7XHJcbiAgICAgICAgICAgIG5vZGUuaW5uZXJIVE1MID0gdmFsdWU7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZWxzZSBpZihuYW1lID09PSAnY2xhc3MnKSB7XHJcbiAgICAgICAgaWYoIXZhbHVlIHx8IHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycpIHtcclxuICAgICAgICAgICAgbm9kZS5jbGFzc05hbWUgPSB2YWx1ZSB8fCAnJztcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZih2YWx1ZSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnKSB7XHJcbiAgICAgICAgICAgIGlmKHR5cGVvZiBvbGQgPT09ICdvYmplY3QnKSB7XHJcbiAgICAgICAgICAgICAgICBmb3IobGV0IGkgaW4gb2xkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEoaSBpbiB2YWx1ZSkpIG5vZGUuY2xhc3NMaXN0LnJlbW92ZShpKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBmb3IobGV0IGkgaW4gdmFsdWUpICB7XHJcbiAgICAgICAgICAgICAgICBpZih2YWx1ZVtpXSkgbm9kZS5jbGFzc0xpc3QuYWRkKGkpO1xyXG4gICAgICAgICAgICAgICAgZWxzZSBub2RlLmNsYXNzTGlzdC5yZW1vdmUoaSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmKG5hbWUgPT09ICdzdHlsZScpIHtcclxuICAgICAgICBpZih2YWx1ZSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnKSB7XHJcbiAgICAgICAgICAgIGlmKHR5cGVvZiBvbGQgPT09ICdvYmplY3QnKSB7XHJcbiAgICAgICAgICAgICAgICBmb3IobGV0IGkgaW4gb2xkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEoaSBpbiB2YWx1ZSkpIG5vZGUuc3R5bGVbaV0gPSAnJztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIG5vZGUuc3R5bGUuY3NzVGV4dCA9ICcnO1xyXG4gICAgICAgICAgICBmb3IobGV0IGkgaW4gdmFsdWUpIG5vZGUuc3R5bGVbaV0gPSB2YWx1ZVtpXSB8fCAnJztcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZighdmFsdWUgfHwgdHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJyB8fCB0eXBlb2Ygb2xkID09PSAnc3RyaW5nJykge1xyXG4gICAgICAgICAgICBub2RlLnN0eWxlLmNzc1RleHQgPSB2YWx1ZSB8fCAnJztcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmKG5hbWVbMF0gPT09ICdvJyAmJiBuYW1lWzFdID09PSAnbicpIHtcclxuICAgICAgICBsZXQgdXNlQ2FwdHVyZSA9IG5hbWUgIT09IChuYW1lID0gbmFtZS5yZXBsYWNlKC9DYXB0dXJlJC8sICcnKSk7XHJcbiAgICAgICAgbmFtZSA9IG5hbWUudG9Mb3dlckNhc2UoKS5zdWJzdHJpbmcoMik7XHJcbiAgICAgICAgaWYodmFsdWUpIHtcclxuICAgICAgICAgICAgaWYoIW9sZCkgbm9kZS5hZGRFdmVudExpc3RlbmVyKG5hbWUsIHZhbHVlLCB1c2VDYXB0dXJlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZihvbGQpIG5vZGUucmVtb3ZlRXZlbnRMaXN0ZW5lcihuYW1lLCBvbGQsIHVzZUNhcHR1cmUpO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZihuYW1lICE9PSAnbGlzdCcgJiYgbmFtZSAhPT0gJ3R5cGUnICYmIG5hbWUgaW4gbm9kZSkge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIG5vZGVbbmFtZV0gPSB2YWx1ZSA9PSBudWxsID8gJycgOiB2YWx1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgaWYoKHZhbHVlID09IG51bGwgfHwgdmFsdWUgPT09IGZhbHNlKSAmJiBuYW1lICE9PSAnc3BlbGxjaGVjaycpIG5vZGUucmVtb3ZlQXR0cmlidXRlKG5hbWUpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIGlmKHZhbHVlID09IG51bGwgfHwgdmFsdWUgPT09IGZhbHNlKSBub2RlLnJlbW92ZUF0dHJpYnV0ZShuYW1lKTtcclxuICAgICAgICBlbHNlIGlmKHR5cGVvZiB2YWx1ZSAhPT0gJ2Z1bmN0aW9uJykgbm9kZS5zZXRBdHRyaWJ1dGUobmFtZSwgdmFsdWUpO1xyXG4gICAgfVxyXG59IiwiJ3VzZSBzdHJpY3QnO1xyXG5cclxuaW1wb3J0IENvbXBvbmVudCwgeyBidWlsZENvbXBvbmVudCB9IGZyb20gJy4uL2NvbXBvbmVudCc7XHJcbmltcG9ydCBWTm9kZSBmcm9tICcuL3Zub2RlJztcclxuaW1wb3J0IHtBVFRSX0tFWX0gZnJvbSAnLi4vY29uc3RhbnRzJztcclxuaW1wb3J0IHtjcmVhdGVOb2RlLCBzZXRBY2Nlc3NvciwgaXNTYW1lTm9kZVR5cGUsIHJlbW92ZU5vZGV9IGZyb20gJy4uL3JlYWRhcHQtZG9tL2luZGV4JztcclxuaW1wb3J0IHt1bm1vdW50Q29tcG9uZW50fSBmcm9tICcuLi9jb21wb25lbnQnO1xyXG5pbXBvcnQge0RPTX0gZnJvbSAnLi4vcmVhZGFwdC1kb20vaW5kZXgnO1xyXG5cclxuZXhwb3J0IGNvbnN0IGlucHV0cyA6IGFueSA9IFtcclxuICAgICdpbnB1dCcsXHJcbiAgICAndGV4dGFyZWEnLFxyXG4gICAgJ3NlbGVjdCcsXHJcbiAgICAnbWV0ZXInLFxyXG4gICAgJ3Byb2dyZXNzJyxcclxuICAgICdidXR0b24nXHJcbl07XHJcblxyXG5leHBvcnQgbGV0IGh5ZHJhdGluZyA9IGZhbHNlO1xyXG5leHBvcnQgbGV0IGRpZmZMZXZlbCA9IDA7XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZGlmZihkb206IGFueSwgbm9kZTogVk5vZGUsIHBhcmVudDogYW55LCByb290OiBib29sZWFuKSB7XHJcbiAgICBsZXQgcmV0IDogYW55ID0gbnVsbDtcclxuICAgIGlmKCFkaWZmTGV2ZWwrKykgaHlkcmF0aW5nID0gZG9tICYmICFkb21bQVRUUl9LRVldO1xyXG5cclxuICAgIHJldCA9IGF3YWl0IGlkaWZmKGRvbSwgbm9kZSwgcGFyZW50LCByb290KTtcclxuICAgIGlmKHBhcmVudCAmJiByZXQucGFyZW50Tm9kZSAhPT0gcGFyZW50KSBwYXJlbnQuYXBwZW5kQ2hpbGQocmV0KTtcclxuXHJcbiAgICBpZighLS1kaWZmTGV2ZWwpIHtcclxuICAgICAgICBoeWRyYXRpbmcgPSBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gcmV0O1xyXG59XHJcblxyXG5hc3luYyBmdW5jdGlvbiBpZGlmZihkb206IGFueSwgbm9kZTogVk5vZGUsIHBhcmVudDogYW55LCByb290OiBib29sZWFuKSB7XHJcbiAgICBsZXQgb3V0IDogYW55ID0gZG9tO1xyXG4gICAgaWYobm9kZS5ub2RlVmFsdWUgPT0gbnVsbCB8fCB0eXBlb2Ygbm9kZS5ub2RlVmFsdWUgPT09ICdib29sZWFuJykgbm9kZS5ub2RlVmFsdWUgPSAnJztcclxuICAgIGlmKG5vZGUubm9kZVR5cGUgPT09ICd0ZXh0Jykge1xyXG4gICAgICAgIGlmKGRvbSAmJiBkb20uc3BsaXRUZXh0ICYmIGRvbS5wYXJlbnROb2RlICYmICghZG9tLl9jb21wb25lbnQgfHwgcm9vdCkpIHtcclxuICAgICAgICAgICAgaWYoZG9tLm5vZGVWYWx1ZSAhPSBub2RlLm5vZGVWYWx1ZSkgZG9tLm5vZGVWYWx1ZSA9IG5vZGUubm9kZVZhbHVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgb3V0ID0gRE9NLmRvY3VtZW50LmNyZWF0ZVRleHROb2RlKG5vZGUubm9kZVZhbHVlKTtcclxuICAgICAgICAgICAgaWYoZG9tKSB7XHJcbiAgICAgICAgICAgICAgICBpZihkb20ucGFyZW50Tm9kZSkgZG9tLnBhcmVudE5vZGUucmVwbGFjZUNoaWxkKG91dCwgZG9tKTtcclxuICAgICAgICAgICAgICAgIGF3YWl0IHJlY29sbGVjdE5vZGVUcmVlKGRvbSwgZmFsc2UpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBvdXRbQVRUUl9LRVldID0ge307XHJcbiAgICAgICAgcmV0dXJuIG91dDtcclxuICAgIH1cclxuXHJcbiAgICBsZXQgbm9kZU5hbWUgOiBhbnkgPSBub2RlLm5vZGVOYW1lLCBucm9vdDtcclxuICAgIGlmKHR5cGVvZiBub2RlTmFtZSA9PT0gJ2Z1bmN0aW9uJykgcmV0dXJuIGF3YWl0IGJ1aWxkQ29tcG9uZW50KGRvbSwgbm9kZSwgcGFyZW50LCBoeWRyYXRpbmcpO1xyXG4gICAgaWYoIWRvbSB8fCBkb20ubm9kZU5hbWUudG9Mb3dlckNhc2UoKSAhPT0gbm9kZU5hbWUudG9Mb3dlckNhc2UoKSkge1xyXG4gICAgICAgIG91dCA9IGNyZWF0ZU5vZGUobm9kZU5hbWUpO1xyXG4gICAgICAgIGlmKGRvbSkge1xyXG4gICAgICAgICAgICB3aGlsZShkb20uZmlyc3RDaGlsZCkgb3V0LmFwcGVuZENoaWxkKGRvbS5maXJzdENoaWxkKTtcclxuICAgICAgICAgICAgaWYoZG9tLnBhcmVudE5vZGUpIGRvbS5wYXJlbnROb2RlLnJlcGxhY2VDaGlsZChvdXQsIGRvbSk7XHJcblxyXG4gICAgICAgICAgICAvL3JlY29sbGVjdFxyXG4gICAgICAgICAgICBhd2FpdCByZWNvbGxlY3ROb2RlVHJlZShkb20sIGZhbHNlKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBsZXQgcHJvcHMgOiBhbnkgPSBvdXRbQVRUUl9LRVldO1xyXG4gICAgaWYoIXByb3BzKSB7XHJcbiAgICAgICAgcHJvcHMgPSBvdXRbQVRUUl9LRVldID0ge307XHJcbiAgICAgICAgb3V0LmdldEF0dHJpYnV0ZU5hbWVzKCkuZm9yRWFjaChuID0+IHByb3BzW25dID0gb3V0LmdldEF0dHJpYnV0ZShuKSk7XHJcbiAgICB9XHJcblxyXG4gICAgbGV0IGZjID0gb3V0LmZpcnN0Q2hpbGQsIGNoaWxkcmVuID0gbm9kZS5jaGlsZE5vZGVzO1xyXG4gICAgaWYoKGNoaWxkcmVuICYmIGNoaWxkcmVuLmxlbmd0aCkgfHwgZmMpIGF3YWl0IGlubmVyRGlmZk5vZGUob3V0LCBjaGlsZHJlbiwgcm9vdCk7XHJcblxyXG4gICAgZGlmZkF0dHJpYnV0ZXMob3V0LCBub2RlLmF0dHJpYnV0ZXMsIHByb3BzKTtcclxuXHJcbiAgICByZXR1cm4gb3V0O1xyXG59XHJcblxyXG5hc3luYyBmdW5jdGlvbiBpbm5lckRpZmZOb2RlKGRvbSwgdmNoaWxkcmVuOiBBcnJheTxWTm9kZT4sIHJvb3Q6IGJvb2xlYW4pIHtcclxuXHRsZXQgb3JpZ2luYWxDaGlsZHJlbiA9IGRvbS5jaGlsZE5vZGVzLFxyXG5cdFx0Y2hpbGRyZW4gPSBBcnJheTxhbnk+KCksXHJcblx0XHRrZXllZCA9IHt9LFxyXG5cdFx0a2V5ZWRMZW4gPSAwLFxyXG5cdFx0bWluID0gMCxcclxuXHRcdGxlbiA9IG9yaWdpbmFsQ2hpbGRyZW4ubGVuZ3RoLFxyXG5cdFx0Y2hpbGRyZW5MZW4gPSAwLFxyXG5cdFx0dmxlbiA9IHZjaGlsZHJlbiA/IHZjaGlsZHJlbi5sZW5ndGggOiAwLFxyXG5cdFx0aiwgYywgZiwgdmNoaWxkLCBjaGlsZDtcclxuXHJcblx0Ly8gQnVpbGQgdXAgYSBtYXAgb2Yga2V5ZWQgY2hpbGRyZW4gYW5kIGFuIEFycmF5IG9mIHVua2V5ZWQgY2hpbGRyZW46XHJcblx0aWYgKGxlbiE9PTApIHtcclxuXHRcdGZvciAobGV0IGk9MDsgaTxsZW47IGkrKykge1xyXG5cdFx0XHRsZXQgY2hpbGQgPSBvcmlnaW5hbENoaWxkcmVuW2ldLFxyXG5cdFx0XHRcdHByb3BzID0gY2hpbGRbQVRUUl9LRVldLFxyXG5cdFx0XHRcdGtleSA9IHZsZW4gJiYgcHJvcHMgPyBjaGlsZC5fY29tcG9uZW50ID8gY2hpbGQuX2NvbXBvbmVudC5rZXkgOiBwcm9wcy5rZXkgOiBudWxsO1xyXG5cdFx0XHRpZiAoa2V5IT1udWxsKSB7XHJcblx0XHRcdFx0a2V5ZWRMZW4rKztcclxuXHRcdFx0XHRrZXllZFtrZXldID0gY2hpbGQ7XHJcblx0XHRcdH1cclxuXHRcdFx0ZWxzZSBpZiAocHJvcHMgfHwgKGNoaWxkLnNwbGl0VGV4dCE9PXVuZGVmaW5lZCA/IChoeWRyYXRpbmcgPyBjaGlsZC5ub2RlVmFsdWUudHJpbSgpIDogdHJ1ZSkgOiBoeWRyYXRpbmcpKSB7XHJcblx0XHRcdFx0Y2hpbGRyZW5bY2hpbGRyZW5MZW4rK10gPSBjaGlsZDtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0aWYgKHZsZW4hPT0wKSB7XHJcblx0XHRmb3IgKGxldCBpPTA7IGk8dmxlbjsgaSsrKSB7XHJcblx0XHRcdHZjaGlsZCA9IHZjaGlsZHJlbltpXTtcclxuXHRcdFx0Y2hpbGQgPSBudWxsO1xyXG5cclxuXHRcdFx0Ly8gYXR0ZW1wdCB0byBmaW5kIGEgbm9kZSBiYXNlZCBvbiBrZXkgbWF0Y2hpbmdcclxuXHRcdFx0bGV0IGtleSA9IHZjaGlsZC5rZXk7XHJcblx0XHRcdGlmIChrZXkhPW51bGwpIHtcclxuXHRcdFx0XHRpZiAoa2V5ZWRMZW4gJiYga2V5ZWRba2V5XSE9PXVuZGVmaW5lZCkge1xyXG5cdFx0XHRcdFx0Y2hpbGQgPSBrZXllZFtrZXldO1xyXG5cdFx0XHRcdFx0a2V5ZWRba2V5XSA9IHVuZGVmaW5lZDtcclxuXHRcdFx0XHRcdGtleWVkTGVuLS07XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHRcdC8vIGF0dGVtcHQgdG8gcGx1Y2sgYSBub2RlIG9mIHRoZSBzYW1lIHR5cGUgZnJvbSB0aGUgZXhpc3RpbmcgY2hpbGRyZW5cclxuXHRcdFx0ZWxzZSBpZiAobWluPGNoaWxkcmVuTGVuKSB7XHJcblx0XHRcdFx0Zm9yIChqPW1pbjsgajxjaGlsZHJlbkxlbjsgaisrKSB7XHJcblx0XHRcdFx0XHRpZiAoY2hpbGRyZW5bal0hPT11bmRlZmluZWQgJiYgaXNTYW1lTm9kZVR5cGUoYyA9IGNoaWxkcmVuW2pdLCB2Y2hpbGQsIGh5ZHJhdGluZykpIHtcclxuXHRcdFx0XHRcdFx0Y2hpbGQgPSBjO1xyXG5cdFx0XHRcdFx0XHRjaGlsZHJlbltqXSA9IHVuZGVmaW5lZDtcclxuXHRcdFx0XHRcdFx0aWYgKGo9PT1jaGlsZHJlbkxlbi0xKSBjaGlsZHJlbkxlbi0tO1xyXG5cdFx0XHRcdFx0XHRpZiAoaj09PW1pbikgbWluKys7XHJcblx0XHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0Ly8gbW9ycGggdGhlIG1hdGNoZWQvZm91bmQvY3JlYXRlZCBET00gY2hpbGQgdG8gbWF0Y2ggdmNoaWxkIChkZWVwKVxyXG5cdFx0XHRjaGlsZCA9IGF3YWl0IGlkaWZmKGNoaWxkLCB2Y2hpbGQsIGRvbSwgcm9vdCk7XHJcblxyXG5cdFx0XHRmID0gb3JpZ2luYWxDaGlsZHJlbltpXTtcclxuXHRcdFx0aWYgKGNoaWxkICYmIGNoaWxkIT09ZG9tICYmIGNoaWxkIT09Zikge1xyXG5cdFx0XHRcdGlmIChmPT1udWxsKSB7XHJcblx0XHRcdFx0XHRkb20uYXBwZW5kQ2hpbGQoY2hpbGQpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRlbHNlIHtcclxuXHRcdFx0XHRcdGRvbS5pbnNlcnRCZWZvcmUoY2hpbGQsIGYpO1xyXG5cdFx0XHRcdFx0cmVtb3ZlTm9kZShmKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9XHJcblxyXG5cclxuXHQvLyByZW1vdmUgdW51c2VkIGtleWVkIGNoaWxkcmVuOlxyXG5cdGlmIChrZXllZExlbikge1xyXG5cdFx0Zm9yIChsZXQgaSBpbiBrZXllZCkgaWYgKGtleWVkW2ldIT09dW5kZWZpbmVkKSBhd2FpdCByZWNvbGxlY3ROb2RlVHJlZShrZXllZFtpXSwgZmFsc2UpO1xyXG5cdH1cclxuXHJcblx0Ly8gcmVtb3ZlIG9ycGhhbmVkIHVua2V5ZWQgY2hpbGRyZW46XHJcblx0d2hpbGUgKG1pbjw9Y2hpbGRyZW5MZW4pIHtcclxuXHRcdGlmICgoY2hpbGQgPSBjaGlsZHJlbltjaGlsZHJlbkxlbi0tXSkhPT11bmRlZmluZWQpIGF3YWl0IHJlY29sbGVjdE5vZGVUcmVlKGNoaWxkLCBmYWxzZSk7XHJcblx0fVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcmVjb2xsZWN0Tm9kZVRyZWUobm9kZTogYW55LCB1bm1vdW50T25seTogYm9vbGVhbikge1xyXG4gICAgaWYoIW5vZGUpIHJldHVybjtcclxuICAgIGxldCBjb21wb25lbnQgPSBub2RlLl9jb21wb25lbnQ7XHJcbiAgICBpZihjb21wb25lbnQpIGF3YWl0IHVubW91bnRDb21wb25lbnQoY29tcG9uZW50KTtcclxuICAgIGlmKG5vZGVbQVRUUl9LRVldICYmIG5vZGVbQVRUUl9LRVldLnJlZikgbm9kZVtBVFRSX0tFWV0ucmVmKG51bGwpO1xyXG4gICAgaWYodW5tb3VudE9ubHkgPT09IGZhbHNlIHx8IG5vZGVbQVRUUl9LRVldKSByZW1vdmVOb2RlKG5vZGUpO1xyXG4gICAgYXdhaXQgcmVtb3ZlQ2hpbGRyZW4obm9kZSk7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZW1vdmVDaGlsZHJlbihub2RlOiBhbnkpIHtcclxuICAgIG5vZGUgPSBub2RlLmxhc3RDaGlsZDtcclxuICAgIHdoaWxlKG5vZGUpIHtcclxuICAgICAgICBsZXQgbmV4dCA9IG5vZGUucHJldmlvdXNTaWJsaW5nO1xyXG4gICAgICAgIGF3YWl0IHJlY29sbGVjdE5vZGVUcmVlKG5vZGUsIHRydWUpO1xyXG4gICAgICAgIG5vZGUgPSBuZXh0O1xyXG4gICAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBkaWZmQXR0cmlidXRlcyhkb206IGFueSwgYXR0cnM6IGFueSwgb2xkOiBhbnkpIHtcclxuICAgIGxldCBuYW1lO1xyXG4gICAgZm9yKG5hbWUgaW4gb2xkKSB7XHJcbiAgICAgICAgaWYoIShhdHRycyAmJiBhdHRyc1tuYW1lXSAhPSBudWxsKSAmJiBvbGRbbmFtZV0gIT0gbnVsbCkgc2V0QWNjZXNzb3IoZG9tLCBuYW1lLCBvbGQsIG9sZFtuYW1lXSA9IHVuZGVmaW5lZCk7XHJcbiAgICB9XHJcbiAgICBmb3IobmFtZSBpbiBhdHRycykge1xyXG4gICAgICAgIGlmKG5hbWUgIT09ICdjaGlsZHJlbicgJiYgbmFtZSAhPT0gJ2lubmVySFRNTCcgXHJcbiAgICAgICAgICAgICYmIChhdHRyc1tuYW1lXSAhPT0gKChuYW1lID09PSAndmFsdWUnIHx8IG5hbWUgPT09ICdjaGVja2VkJykgPyBkb21bbmFtZV0gOiBvbGRbbmFtZV0pKSkgc2V0QWNjZXNzb3IoZG9tLCBuYW1lLCBvbGRbbmFtZV0sIG9sZFtuYW1lXSA9IGF0dHJzW25hbWVdKTsgXHJcbiAgICB9XHJcbn0iLCIndXNlIHN0cmljdCc7XHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFZOb2RlIHtcclxuICAgIGF0dHJpYnV0ZXM6IGFueTtcclxuICAgIG5vZGVOYW1lOiBhbnk7XHJcbiAgICBub2RlVHlwZTogc3RyaW5nO1xyXG4gICAgbm9kZVZhbHVlOiBhbnk7XHJcbiAgICBjaGlsZE5vZGVzOiBBcnJheTxhbnk+O1xyXG4gICAga2V5OiBhbnk7XHJcblxyXG4gICAgY29uc3RydWN0b3IobmFtZTogYW55LCB0eXBlOiBzdHJpbmcsIHY6IGFueSApIHtcclxuICAgICAgICB0aGlzLm5vZGVOYW1lID0gbmFtZTtcclxuICAgICAgICB0aGlzLm5vZGVUeXBlID0gdHlwZTtcclxuICAgICAgICB0aGlzLm5vZGVWYWx1ZSA9IHY7XHJcbiAgICAgICAgdGhpcy5jaGlsZE5vZGVzID0gQXJyYXk8YW55PigwKTtcclxuICAgIH1cclxufSIsIid1c2Ugc3RyaWN0JztcclxuXHJcbmltcG9ydCBDb21wb25lbnQsIHsgREVGRVJfUFJPTUlTRSwgcmVuZGVyQ29tcG9uZW50IH0gZnJvbSAnLi9jb21wb25lbnQnO1xyXG5pbXBvcnQgVk5vZGUgZnJvbSAnLi9yZWFkYXB0LXZkb20vdm5vZGUnO1xyXG5pbXBvcnQgeyBkaWZmIH0gZnJvbSAnLi9yZWFkYXB0LXZkb20vZGlmZic7XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZW5xdWV1ZShjb21wb25lbnQ6IENvbXBvbmVudCkge1xyXG4gICAgKGNvbXBvbmVudC5hc3luY01ldGhvZCB8fCBERUZFUl9QUk9NSVNFKShhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgYXdhaXQgcmVuZGVyQ29tcG9uZW50KGNvbXBvbmVudCwgY29tcG9uZW50LnBhcmVudE5vZGUsIGZhbHNlKTtcclxuICAgIH0pO1xyXG59XHJcbmV4cG9ydCBmdW5jdGlvbiBlbnF1ZXVlU3RhdGUoY29tcG9uZW50OiBDb21wb25lbnQsIHN0YXRlOiBQcm9taXNlPGFueT4pIHtcclxuICAgIChjb21wb25lbnQuYXN5bmNNZXRob2QgfHwgREVGRVJfUFJPTUlTRSkoYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgIGF3YWl0IHN0YXRlO1xyXG4gICAgfSk7XHJcbn1cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGh5ZHJhdGUobm9kZTogVk5vZGUsIHBhcmVudDogYW55KSB7XHJcbiAgICByZXR1cm4gYXdhaXQgcmVuZGVyKG5vZGUsIHBhcmVudCwgcGFyZW50LmZpcnN0RWxlbWVudENoaWxkKTtcclxufVxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcmVuZGVyKG5vZGU6IFZOb2RlLCBwYXJlbnQ6IGFueSwgbWVyZ2U6IGFueSkge1xyXG4gICAgcmV0dXJuIGF3YWl0IGRpZmYobWVyZ2UsIG5vZGUsIHBhcmVudCwgdHJ1ZSk7XHJcbn0iXSwic291cmNlUm9vdCI6IiJ9